# arc_twitter v4.1
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://andy-carter.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjM6
IjQuMSI7czo2OiJhdXRob3IiO3M6MTE6IkFuZHkgQ2FydGVyIjtzOjEwOiJhdXRob3JfdXJp
IjtzOjIzOiJodHRwOi8vYW5keS1jYXJ0ZXIuY29tLyI7czoxMToiZGVzY3JpcHRpb24iO3M6
NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0ZXI8L2E+IGZvciBU
ZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUiO3M6MToiNSI7czo1
OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTc5NjA6Igk8aDEgY2xhc3M9InRpdGxl
Ij48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJjX3R3aXR0ZXIgZm9y
IFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJf
YXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2lu
c3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248L2E+PC9saT4KCQk8
bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwvYT48
L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+VGhlIGFyY190
d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVy
X3R3ZWV0X2J1dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl90d2VldF9idXR0b24gdGFnPC9h
PjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uX3RhZyI+
VGhlIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl90d2VldF91cmwiPlRoZSBhcmNfdHdpdHRlcl90d2VldF91cmwg
dGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90aW55dXJsIj5UaGUg
YXJjX3R3aXR0ZXJfdGlueXVybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJj
X3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNsZXM8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8L2E+PC9saT4KCTwv
b2w+CgoJPHA+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgcHJvdmlkZXMg
YWNjZXNzIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50IHRocm91Z2ggYm90aCB0aGUgYWRtaW4g
aW50ZXJmYWNlIGFuZCB0aGUgcHVibGljIHNpZGUgb2YgeW91ciBzaXRlLiBVcGRhdGUgVHdp
dHRlciB3aGVuIHlvdSBwb3N0IGEgbmV3IGFydGljbGUgKHdpdGggYXJ0aWNsZS1ieS1hcnRp
Y2xlIG9wdCBvdXQgb3B0aW9uKSwgdXBkYXRlIGFuZCB2aWV3IHlvdXIgVHdpdHRlciBmZWVk
IHRocm91Z2ggdGhlIGFkbWluIFR3aXR0ZXIgdGFiLCBhbmQgZGlzcGxheSBUd2l0dGVyIGZl
ZWRzIG9uIHlvdXIgc2l0ZS48L3A+CgoJPHA+UmVxdWlyZW1lbnRzOi08L3A+CgoJPHVsPgoJ
CTxsaT5UZXh0cGF0dGVybiA0LjUrPC9saT4KCQk8bGk+PHNwYW4gY2xhc3M9ImNhcHMiPlBI
UDwvc3Bhbj4gNSBhbmQgY1VSTDwvbGk+Cgk8L3VsPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIg
aWQ9ImFyY190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9oMj4KCgk8cD48YSBocmVmPSJodHRw
Oi8vYW5keS1jYXJ0ZXIuY29tIj5BbmR5IENhcnRlcjwvYT4uIEZvciBvdGhlciBUZXh0cGF0
dGVybiBwbHVnaW5zIGJ5IG1lIHZpc2l0IG15IDxhIGhyZWY9Imh0dHA6Ly9hbmR5LWNhcnRl
ci5jb20vdHhwIj5QbHVnaW5zIHBhZ2U8L2E+LjwvcD4KCgk8cD5Db250cmlidXRvcnM6IEFu
ZHkgQ2FydGVyLCBQaGlsIFdhcmVoYW0gYW5kIFRvbW15IFNjaG11Y2tlci48L3A+CgoJPHA+
VGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly9tYW5mcmUubmV0LyI+TWljaGFlbCBNYW5mcmU8
L2E+IGZvciBpbnNwaXJhdGlvbiBmb3IgdGhlIGFydGljbGUgdHdlZXQgcGFydCBvZiB0aGlz
IHBsdWdpbiBiYXNlZCBvbiBoaXMgPHNwYW4gY2xhc3M9InRhZyI+bWVtX3R3aXR0ZXI8L3Nw
YW4+IHBsdWdpbi4gIEFkZGl0aW9uYWwgdGhhbmtzIHRvIHRoZSBncmVhdCBUZXh0cGF0dGVy
biBjb21tdW5pdHkgZm9yIGhlbHBpbmcgdG8gdGVzdCB0aGlzIHBsdWdpbiBhbmQgZm9yIHN1
Z2dlc3RpbmcgbmV3IGZlYXR1cmVzLiBUaGUgT0F1dGggcGFydCBvZiB0aGUgcGx1Z2luIGlz
IHRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vdHdpdHRlci5jb20vYWJyYWhhbSI+QWJyYWhh
bSBXaWxsaWFtczwvYT4uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248L2gyPgoK
CTxwPlRvIGluc3RhbGwgZ28gdG8gdGhlICYjODIxNjtwbHVnaW5zJiM4MjE3OyB0YWIgdW5k
ZXIgJiM4MjE2O2FkbWluJiM4MjE3OyBhbmQgcGFzdGUgdGhlIHBsdWdpbiBjb2RlIGludG8g
dGhlICYjODIxNjtJbnN0YWxsIHBsdWdpbiYjODIxNzsgYm94LCAmIzgyMTY7dXBsb2FkJiM4
MjE3OyBhbmQgdGhlbiAmIzgyMTY7aW5zdGFsbCYjODIxNzsuIFRoZSBwbHVnaW4gd2lsbCBi
ZSBhdXRvbWF0aWNhbGx5IGFjdGl2YXRlZC48L3A+CgoJPHA+QmVmb3JlIHlvdSBzdGFydCB1
c2luZyA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4geW91IHdpbGwgbmVl
ZCB0byBtYWtlIHN1cmUgdGhhdCB0aGUgY2FjaGUgZGlyZWN0b3J5IGlzIHdyaXRhYmxlLiBT
ZWUgdGhlICYjODIxNjtDYWNoaW5nJiM4MjE3OyBzdWJzZWN0aW9uIGJlbG93IGZvciBmdXJ0
aGVyIGluZm9ybWF0aW9uLjwvcD4KCgk8cD48c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRl
cjwvc3Bhbj4gc2hvdWxkIG5vdyBiZSByZWFkeSBmb3IgdXNlIG9uIHRoZSBwdWJsaWMtc2lk
ZSBvZiB5b3VyIHNpdGUuPC9wPgoKCTxwPlRvIHVubG9jayB0aGUgYWRtaW4gZmVhdHVyZXMg
b2YgdGhpcyBwbHVnaW4geW91IHdpbGwgbmVlZCB0byBhc3NvY2lhdGUgeW91ciBzaXRlIHdp
dGggYSBUd2l0dGVyIGFjY291bnQgYnkgY29ubmVjdGluZyB0byBUd2l0dGVyIGZyb20gdGhl
IHBsdWdpbiYjODIxNztzIG9wdGlvbnMgc2NyZWVuLiBDbGljayBvbiB0aGUgbGluayB0byBj
b25uZWN0IHRvIFR3aXR0ZXIsIHlvdSB3aWxsIGJlIGFza2VkIHRvIGxvZ2luIHRvIFR3aXR0
ZXIsIGNsaWNraW5nIHRoaXMgbGluayB3aWxsIHRlbXBvcmFyaWx5IHRha2UgeW91IHRvIHRo
ZSBUd2l0dGVyIHNpdGUgd2hlcmUgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gYW5kIGFw
cHJvdmUgYWNjZXNzIGZvciA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB0
byByZWFkIGFuZCB3cml0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gSWYgYWxsIGlzIHN1
Y2Nlc3NmdWwgeW91IHdpbGwgYmUgcmV0dXJuZWQgdG8gdGhlIG9wdGlvbnMgc2NyZWVuIGFu
ZCB5b3VyIHVzZXIgbmFtZSB3aWxsIGFwcGVhci48L3A+CgoJPHA+QXQgYW55IHRpbWUgeW91
IGNhbiBkaXNhc3NvY2lhdGUgeW91ciBUd2l0dGVyIGFjY291bnQgd2l0aCA8c3BhbiBjbGFz
cz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB2aWEgeW91ciBUd2l0dGVyIGFjY291bnQgcHJl
ZmVyZW5jZXMgb24gdGhlIDxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXIgd2Vic2l0ZTwvYT4uPC9wPgoKCTxwPlRvIHVuaW5zdGFsbCA8c3BhbiBjbGFzcz0idGFn
Ij5hcmNfdHdpdHRlcjwvc3Bhbj4gc2ltcGx5IGRlbGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhl
ICYjODIxNjtQbHVnaW5zJiM4MjE3OyB0YWIuICBUaGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVn
aW4gY29kZSwgZGVsZXRlIHJlbGF0ZWQgcHJlZmVyZW5jZXMgYW5kIGRyb3AgdGhlIDxzcGFu
IGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB0YWJsZSBmcm9tIHlvdXIgVGV4dHBh
dHRlcm4gZGF0YWJhc2UuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsg
LyZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0
cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3Ro
PgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4K
CQkJPHRkPlR3aXR0ZXIgdXNlciBuYW1lPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIg
dXNlcm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVv
dDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+cmV0d2VldHM8L3RkPgoJCQk8dGQ+MSB0
byBpbmNsdWRlIHJldHdlZXRzLCAwIHRvIGV4Y2x1ZGUgdGhlbSBmcm9tIHRoZSBmZWVkPC90
ZD4KCQkJPHRkPjA8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+cmVwbGllczwvdGQ+CgkJ
CTx0ZD4xIHRvIGluY2x1ZGUgcmVwbGllcywgMCB0byBleGNsdWRlIHRoZW0gZnJvbSB0aGUg
ZmVlZDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90
ZD4KCQkJPHRkPk1heGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIw
MCk8L3RkPgoJCQk8dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+ZmV0Y2g8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1i
ZXIgb2YgdHdlZXRzIHRvIHJldHJpZXZlIGZyb20gVHdpdHRlciAobWF4LiAyMDApPHN1cCBj
bGFzcz0iZm9vdG5vdGUiPjxhIGhyZWY9IiNmbjY1ODA3ODA3NTUyOTY3M2JlMDYyNjYiPjE8
L2E+PC9zdXA+PC90ZD4KCQkJPHRkPjA8L3RkPgoJCQk8dGQ+ZmV0Y2g9JnF1b3Q7NTAmcXVv
dDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5G
b3JtYXQgdGhhdCB1cGRhdGUgZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxl
bT5BcmNoaXZlIGRhdGUgZm9ybWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVv
dDslYiAlT2UsICVJOiVNICVwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxh
YmVsPC90ZD4KCQkJPHRkPkxhYmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJ
PHRkPiA8ZW0+bm8gbGFiZWw8L2VtPjwvdGQ+CgkJCTx0ZD5sYWJlbD0mcXVvdDtNeSBUd2l0
dGVyIHRpbWVsaW5lJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFn
PC90ZD4KCQkJPHRkPkluZGVwZW5kZW50IHdyYXB0YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRk
PiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5sYWJlbHRhZz0mcXVvdDtoMyZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5icmVhazwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFz
cz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgKHdp
dGhvdXQgYnJhY2tldHMpLCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0
ZXM8L3RkPgoJCQk8dGQ+bGk8L3RkPgoJCQk8dGQ+YnJlYWs9JnF1b3Q7YnImcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3JhcHRhZzwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFz
cz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgdG8g
YmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0czwvdGQ+CgkJCTx0ZD4g
PGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+d3JhcHRhZz0mcXVvdDt1bCZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0i
Y2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJp
YnV0ZSBmb3Igd3JhcHRhZzwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlcjwvdGQ+CgkJCTx0ZD5j
bGFzcz0mcXVvdDt0d2l0dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNs
YXNzX3Bvc3RlZDwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9
ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNw
YW4gdGFnIGFyb3VuZCBwb3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0
ZWQ8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxwIGlkPSJmbjY1ODA3ODA3NTUyOTY3M2Jl
MDYyNjYiIGNsYXNzPSJmb290bm90ZSI+PHN1cD4xPC9zdXA+IFR3aXR0ZXImIzgyMTc7cyA8
c3BhbiBjbGFzcz0iY2FwcyI+QVBJPC9zcGFuPiBjb3VudHMgdGhlIG51bWJlciBvZiB0d2Vl
dHMgdG8gcmV0dXJuIGJlZm9yZSBhcHBseWluZyBzb21lIG9mIHRoZSBmaWx0ZXJzLCBzbyB0
aGUgcmVzcG9uc2UgY2FuIGJlIGZld2VyIHR3ZWV0cyB0aGFuIGV4cGVjdGVkLiBUbyBoZWxw
IGF2b2lkIHRoaXMgeW91IGNhbiBzZXQgYSA8ZW0+ZmV0Y2g8L2VtPiBsaW1pdCB0aGF0IGlz
IGhpZ2hlciB0aGFuIHRoZSBkaXNwbGF5IDxlbT5saW1pdDwvZW0+IHRoYXQgeW91IHdhbnQg
dG8gb3V0cHV0LiBJZiA8ZW0+ZmV0Y2g8L2VtPiBpcyBsZXNzIHRoYW4gPGVtPmxpbWl0PC9l
bT4gdGhlIGxhdHRlciB3aWxsIGJlIHVzZWQgaW5zdGVhZC48L3A+CgoJPGgzPkV4YW1wbGUg
dXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXIgdXNlcj0mcXVvdDtkcm1vbmtl
eW5pbmphJnF1b3Q7IGxpbWl0PSZxdW90OzUmcXVvdDsgd3JhcHRhZz0mcXVvdDt1bCZxdW90
OyBicmVhaz0mcXVvdDtsaSZxdW90OyBkYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0g
JXAmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBidWxsZXQgcG9pbnQgbGlzdCBv
ZiB0aGUgbGFzdCA1IFR3aXR0ZXIgdXBkYXRlcyBmcm9tIGRybW9ua2V5bmluamEmIzgyMTc7
cyBUd2l0dGVyIGZlZWQgd2l0aCBhIGRlZmluZWQgZGF0ZSBmb3JtYXQgdG8gb3ZlcnJpZGUg
dGhlIGRlZmF1bHQgYXJjaGl2ZSBkYXRlIGZvcm1hdC48L3A+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+VGhlIGFyY190d2l0dGVyX3NlYXJj
aCB0YWc8L2gyPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJf
c2VhcmNoIGhhc2h0YWdzPSZxdW90O3R4cCZxdW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8
L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVz
Y3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnNlYXJjaDwvdGQ+CgkJCTx0ZD5Db21tYSBzZXBhcmF0
ZWQgbGlzdCBvZiBzZWFyY2ggd29yZHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPnNlYXJjaD0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+aGFzaHRhZ3M8L3RkPgoJCQk8dGQ+Q29tbWEgc2VwYXJhdGVk
IGxpc3Qgb2YgaGFzaHRhZ3MgdG8gc2VhcmNoIGZvciAobm90IGluY2x1ZGluZyB0aGUgaGFz
aCk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPmhhc2h0YWdzPSZx
dW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5y
ZXBseTwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB0d2VldHMgaW4gcmVwbHkgdG88L3RkPgoJ
CQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnJlcGx5PSZxdW90O3R3aXR0ZXIm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bWVudGlvbjwvdGQ+CgkJCTx0ZD5V
c2VybmFtZSBvZiB1c2VyIG1lbnRpb25lZCBpbiB0d2VldHMgKDxpPmkuZS48L2k+IHR3ZWV0
cyBjb250YWluaW5nIEB1c2VybmFtZSk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPm1lbnRpb249JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51bWJlciBvZiB0d2VldHMg
dG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJPHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0
PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8
L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90
ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZvcm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRh
dGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5MYWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUg
bGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVsPC9lbT48L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQgd3JhcHRhZyBmb3Ig
bGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFz
cz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyksIG9y
IHN0cmluZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNs
YXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0
byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRk
PiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwvdGQ+CgkJCTx0ZD5hcmNf
dHdpdHRlcl9zZWFyY2g8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfdXNlcjwv
dGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwv
c3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3Vu
ZCB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItdXNlcjwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNh
cHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1
dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9zdGVkIGRhdGU8L3RkPgoJCQk8dGQ+
YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8aDM+RXhhbXBs
ZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggc2VhcmNoPSZx
dW90O3BsdWdpbiZxdW90OyBoYXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDsg
bGltaXQ9JnF1b3Q7MjUmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBsaXN0IG9m
IHR3ZWV0cyBjb250YWluaW5nIHRoZSB3b3JkICYjODIxNjtwbHVnaW4mIzgyMTc7IGFuZCB0
aGUgaGFzaHRhZ3MgJiM4MjE2OyN0eHAmIzgyMTc7IGFuZCAmIzgyMTY7I3RleHRwYXR0ZXJu
JiM4MjE3Oy4gVGhlIHRhZyB3aWxsIHJldHVybiBhIG1heGltdW0gb2YgMjUgdHdlZXRzLjwv
cD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9yZXR3ZWV0X3RhZyI+
VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiB0YWc8L2gyPgoKCTxwPk91dHB1dHMgdGhl
IFR3aXR0ZXIgdHdlZXQgYnV0dG9uIChmb3JtZXJseSAmbHQ7dHhwOmFyY190d2l0dGVyX3Jl
dHdlZXQgLyZndDspLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3R3ZWV0X2J1dHRvbiAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJs
ZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3Ro
PgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWUgdG8gcXVvdGU8
L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRk
PnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD51cmw8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJj
YXBzIj5VUkw8L3NwYW4+PC9zcGFuPiB0byB0d2VldDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD50ZXh0PC90ZD4KCQkJPHRkPlR3ZWV0IHRleHQ8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Zm9sbG93MTwvdGQ+CgkJCTx0ZD5TdWdnZXN0ZWQgVHdpdHRlciBhY2NvdW50IHRv
IGZvbGxvdywgZm9yIGV4YW1wbGUgeW91ciBvd248L3RkPgoJCQk8dGQ+QSBUd2l0dGVyIHVz
ZXIgdG8gcmVjb21tZW5kPC90ZD4KCQkJPHRkPmZvbGxvdzE9JnF1b3Q7VGV4dHBhdHRlcm4m
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93MjwvdGQ+CgkJCTx0ZD5B
cyBmb2xsb3cxPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxhbmd1YWdlPC90ZD4KCQkJPHRkPmVuPC90
ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+Q291bnQgYm94IHBvc2l0aW9uLCBvcHRpb25zOiBub25l
LCBob3Jpem9udGFsIG9yIHZlcnRpY2FsPC90ZD4KCQkJPHRkPmhvcml6b250YWw8L3RkPgoJ
CQk8dGQ+Y291bnQ9JnF1b3Q7bm9uZSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5pbmNsdWRlX2pzPC90ZD4KCQkJPHRkPldoZXRoZXIgb3Igbm90IHRvIGluY2x1ZGUgdGhl
IHdpZGdldCBKYXZhU2NyaXB0PC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9q
cz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPm9wdGltaXNlX2pz
PC90ZD4KCQkJPHRkPk9wdGltaXNlIHRoZSBKYXZhU2NyaXB0IGJ5IHVzaW5nIGEgbG9jYWwg
c2NyaXB0IHJhdGhlciB0aGFuIHRoYXQgaG9zdGVkIG9uIHRoZSBUd2l0dGVyIHNpdGU8L3Rk
PgoJCQk8dGQ+MDwvdGQ+CgkJCTx0ZD5vcHRpbWlzZV9qcz0mcXVvdDsxJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJj
YXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmli
dXRlIGFwcGxpZWQgdG8gdGhlIHR3ZWV0IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVyLXNo
YXJlLWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9u
IiBpZD0iYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl9m
b2xsb3dfYnV0dG9uIHRhZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUgVHdpdHRlciBmb2xsb3cg
YnV0dG9uIChhbiBhbHRlcm5hdGl2ZSB2ZXJzaW9uIGlzIGluY2x1ZGVkIGluIGFyY190d2l0
dGVyX2ludGVudHMpLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX2ZvbGxvd19idXR0b24gLyZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFi
bGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90
aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNlciBuYW1lIHRvIGZvbGxv
dzwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHVzZXJuYW1lPC9lbT48L3RkPgoJCQk8
dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3VhZ2U8L3RkPgoJCQk8dGQ+ZW48L3RkPgoJ
CQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5j
b3VudDwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0aGUgZm9sbG93ZXIgY291bnQgaXMg
c2hvd248L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDswJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hldGhl
ciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3JpcHQ8L3RkPgoJCQk8dGQ+
MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0aW1pc2UgdGhlIEphdmFT
Y3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRoYW4gdGhhdCBob3N0ZWQg
b24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQkJPHRkPm9wdGltaXNl
X2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3Rk
PgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3Nw
YW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgZm9sbG93IGJ1dHRv
bjwvdGQ+CgkJCTx0ZD50d2l0dGVyLWZvbGxvdy1idXR0b248L3RkPgoJCTwvdHI+Cgk8L3Rh
YmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3R3ZWV0X3VybCI+
YXJjX3R3aXR0ZXJfdHdlZXRfdXJsPC9oMj4KCgk8cD5SZXR1cm5zIHRoZSA8c3BhbiBjbGFz
cz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgVHdpdHRlciBzdGF0dXMgZm9yIGFuIGFydGlj
bGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdl
ZXRfdXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdlZXRfdXJsJmd0
O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCZndDs8L3A+CgoJPGgz
PlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJ
PHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBs
ZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+CgkJCTx0ZD5UZXh0cGF0dGVy
biBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVudCBhcnRpY2xlPC9lbT48L3Rk
PgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD50
aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2YgdGhlIGxpbms8L3RkPgoJCQk8
dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90
ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9z
cGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIGxpbms8L3RkPgoJ
CQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xh
c3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90aW55dXJsIj5hcmNfdHdpdHRlcl90aW55
dXJsPC9oMj4KCgk8cD5SZXR1cm5zIHRoZSBzaG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMi
PlVSTDwvc3Bhbj4gb2YgdGhlIGFydGljbGUgdXNlZCBmb3IgdGhlIFR3aXR0ZXIgdXBkYXRl
LjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3Rpbnl1
cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0O0xpbmsg
dGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3Rpbnl1cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNs
ZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRk
PmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3Rk
PgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3Nw
YW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8
ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvaDI+CgoJPHA+SW4gb3Jk
ZXIgdG8gcHJldmVudCBleGNlc3NpdmUgcmVwZWF0aXRpdmUgY2FsbHMgdG8gdGhlIFR3aXR0
ZXIgd2Vic2l0ZSBpdCBpcyByZWNvbW1lbmRlZCB0byBjYWNoZSByZXN1bHRzLiBUd2l0dGVy
IGxpbWl0cyB0aGUgbnVtYmVyIG9mIGNhbGxzIHRocm91Z2ggdGhlIDxzcGFuIGNsYXNzPSJj
YXBzIj5BUEk8L3NwYW4+LCBhbmQgY29udGludW91cyBjYWxscyB3aWxsIHJlc3VsdCBpbiBU
d2l0dGVyIGNsb3NpbmcgdG8gZnVydGhlciByZXF1ZXN0cy4gQnkgZGVmYXVsdCwgYXJjX3R3
aXR0ZXIgY2FjaGVzIGZvciAzMCBtaW51dGUgaW50ZXJ2YWxzLjwvcD4KCgk8dGFibGU+CgkJ
PHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJ
PHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5jYWNoaW5nPC90ZD4KCQkJPHRkPiYjODIxNjsxJiM4MjE3OyB0byBjYWNoZSBmZWVk
LCAmIzgyMTY7MCYjODIxNzsgdG8gdHVybiBjYWNoaW5nIG9mZiAobm90IHJlY29tbWVuZGVk
KTwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmNhY2hpbmc9JnF1b3Q7MSZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV9kaXI8L3RkPgoJCQk8dGQ+QWJzb2x1dGUg
cGF0aCB0byB0aGUgY2FjaGUgZGlyZWN0b3J5IChtdXN0IGJlIHdyaXRhYmxlKTwvdGQ+CgkJ
CTx0ZD4gPGVtPmFyY190d2l0dGVyIHByZWZlcmVuY2VzPC9lbT48L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+Y2FjaGVfdGltZTwvdGQ+CgkJCTx0ZD5UaW1lIGluIG1pbnV0ZXMgdGhh
dCB0aGUgY2FjaGUgZmlsZXMgYXJlIHN0b3JlZCBiZWZvcmUgYmVpbmcgcmVmcmVzaGVkPC90
ZD4KCQkJPHRkPjU8L3RkPgoJCQk8dGQ+Y2FjaGVfdGltZT0mcXVvdDszMCZxdW90OzwvdGQ+
CgkJPC90cj4KCTwvdGFibGU+CgoJPHA+VGhlIGFkbWluIHNpZGUgb2YgdGhpcyBwbHVnaW4g
ZW5mb3JjZXMgY2FjaGluZywgYXBhcnQgZnJvbSB3aGVuIGl0IGlzIHBvc3RpbmcgdG8gVHdp
dHRlciAoPGk+ZS5nLjwvaT4gd2hlbiBwb3N0aW5nIG9yIGRlbGV0aW5nIGFuIHVwZGF0ZSku
PC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3ByZWZzIj5QcmVm
ZXJlbmNlczwvaDI+CgoJPHA+WW91IGNhbiBhY2Nlc3MgdGhlIHBsdWdpbnMgY29yZSBwcmVm
ZXJlbmNlcyBmcm9tIGVpdGhlciB0aGUgUHJlZmVyZW5jZXMgb3IgUGx1Z2lucyB0YWJzIGlu
IGFkbWluLiBTZXR1cCB5b3VyIFR3aXR0ZXIgYWNjb3VudCAoeW91IHdpbGwgYmUgYXNrZWQg
dG8gY29ubmVjdCB2aWEgVHdpdHRlciBhbmQgdGhpcyBuZWVkcyBkb2luZyBiZWZvcmUgeW91
IGNhbiB1c2UgdGhlIHBsdWdpbikgYW5kIGNoYW5nZSB0aGUgY2FjaGUgZGlyZWN0b3J5IHVz
aW5nIGFyY190d2l0dGVyJiM4MjE3O3MgcHJlZmVyZW5jZXMuIFdpdGhvdXQgcHJvdmlkaW5n
IHlvdXIgYWNjb3VudCBsb2dpbiBkZXRhaWxzIHRoZSBhZG1pbiBhcmVhIGZlYXR1cmVzIG9m
IHRoaXMgcGx1Z2luIHdpbGwgYmUgaW5hY3RpdmUuPC9wPgoKCTxwPllvdSBjYW4gc2VsZWN0
IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBzaG9ydGVuZXIgbWV0aG9kIHlv
dSB3YW50IHRvIHVzZSB0byBsaW5rIGJhY2sgdG8geW91ciBhcnRpY2xlIG9uIFR3aXR0ZXIu
IFBsZWFzZSBub3RlIHRoYXQgaWYgeW91IHNlbGVjdCBzbWRfc2hvcnRfdXJsIHlvdSB3aWxs
IG5lZWQgdG8gaGF2ZSBpbnN0YWxsZWQgYW5kIGFjdGl2YXRlZCB0aGUgPGEgaHJlZj0iaHR0
cDovL3RleHRwYXR0ZXJuLm9yZy9wbHVnaW5zLzEwOTkvc21kX3Nob3J0X3VybCI+PHNwYW4g
Y2xhc3M9InRhZyI+c21kX3Nob3J0X3VybDwvc3Bhbj4gcGx1Z2luPC9hPiBkZXZlbG9wZWQg
YnkgU3RlZiBEYXdzb24uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9oMj4KCgk8cD5CeSBkZWZhdWx0IGFy
Y190d2l0dGVyIHdpbGwgcG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRlciBpbmNsdWRpbmcgYSBz
aG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gdG8geW91ciBhcnRpY2xl
LiBPbmx5IGxpdmUgYW5kIGFjdGl2ZSBhcnRpY2xlcyB3aWxsIGJlIHNlbnQgdG8gVHdpdHRl
ciwgPGk+aS5lLjwvaT4gYXJ0aWNsZXMgcG9zdGVkIGluIHRoZSBmdXR1cmUgb3IgYXMgc3Rp
Y2t5IGFydGljbGVzIHdpbGwgbm90IGJlIHNlbnQuIElmIHlvdXIgYXJ0aWNsZSBpcyBzdWNj
ZXNzZnVsbHkgc3VibWl0dGVkIHRvIFR3aXR0ZXIgdGhlIHVwZGF0ZSB3aWxsIGFwcGVhciBp
biBwbGFjZSBvZiB0aGUgVHdpdHRlciBvcHRpb24gb24gdGhlIHJpZ2h0LWhhbmQtc2lkZSBv
ZiB0aGUgYXJ0aWNsZSBlZGl0IHNjcmVlbi48L3A+CgoJPHA+VHdlZXRzIGFyZSBzZW50IGlu
IHRoZSBmb2xsb3dpbmcgZm9ybWF0OiA8ZW0+VHdlZXQgcHJlZml4PC9lbT4gPGVtPkFydGlj
bGUgdGl0bGU8L2VtPiA8ZW0+U2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3Nw
YW4+PC9lbT4gPGVtPlR3ZWV0IHN1ZmZpeDwvZW0+LiBZb3UgY2FuIGNoYW5nZSB0aGUgcHJl
Zml4IGFuZCBzdWZmaXggb24gYW4gYXJ0aWNsZS1ieS1hcnRpY2xlIGJhc2lzIGJ5IGNoYW5n
aW5nIHRoZSB0d2VldCBvcHRpb25zIHVuZGVyICYjODIxNjtVcGRhdGUgVHdpdHRlciYjODIx
Nzsgb24gdGhlIGFydGljbGUgZWRpdG9yIHNjcmVlbi4gVGhlIGRlZmF1bHQgPGVtPlR3ZWV0
IHByZWZpeDwvZW0+IGNhbiBiZSBzZXQgdW5kZXIgdGhlIDxzcGFuIGNsYXNzPSJ0YWciPmFy
Y190d2l0dGVyPC9zcGFuPiBwcmVmZXJlbmNlcyBzY3JlZW4gKHRoZSBkZWZhdWx0IG9uIGlu
c3RhbGxhdGlvbiBpcyAmIzgyMjA7SnVzdCBwb3N0ZWQ6JiM4MjIxOykuPC9wPgoKCTxwPlBs
ZWFzZSBub3RlIHRoYXQgb25jZSBhbiBhcnRpY2xlIGhhcyBiZWVuIHR3ZWV0ZWQgdGhlIHR3
ZWV0IGNhbm5vdCBiZSBlZGl0ZWQuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFy
Y190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8L2gyPgoKCTxwPlVuZGVyIHRoZSBF
eHRlbnNpb25zIHRhYiAodGhpcyBjYW4gYmUgY2hhbmdlZCBmcm9tIHRoZSBwbHVnaW4mIzgy
MTc7cyBwcmVmZXJlbmNlIHBhZ2UpIGEgbmV3IFR3aXR0ZXIgdGFiIHNob3VsZCBhcHBlYXIg
b25jZSB5b3UgaGF2ZSBjb25uZWN0ZWQgeW91ciBzaXRlIHRvIHlvdXIgVHdpdHRlciBhY2Nv
dW50LiBGcm9tIGhlcmUgeW91IHdpbGwgYmUgYWJsZSB0byBzdWJtaXQgbmV3IFR3aXR0ZXIg
dXBkYXRlcywgdmlldyBiYXNpYyBhY2NvdW50IHN0YXRpc3RpY3MsIGFuZCBjaGVjayBvdXQg
eW91ciByZWNlbnQgdXBkYXRlcyAoaW5jbHVkaW5nIHRoZSBvcHRpb24gdG8gZGVsZXRlIHlv
dXIgdHdlZXRzKS48L3A+IjtzOjQ6ImNvZGUiO3M6NzY5ODg6Imdsb2JhbCAkcHJlZnMsJHR4
cGNmZywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0OwoKJGFyY190d2l0dGVyID0gYXJyYXkoKTsKCiRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSA9ICduS2NYc2x3elpoQmQwa2ZLTWV0blBBJzsKJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0ID0gJ0M2blNQQ0wzZWVIR1RCaEtDZ3dkOW9jbGN1RDBzckI4V1ZrZlhRWUM1NCc7Cgph
ZGRfcHJpdnMoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicsJzEsMicpOwpyZWdpc3Rlcl9j
YWxsYmFjaygnYXJjX3R3aXR0ZXJfaW5zdGFsbCcsJ3BsdWdpbl9saWZlY3ljbGUuYXJjX3R3
aXR0ZXInLCAnaW5zdGFsbGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl91
bmluc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywgJ2RlbGV0ZWQnKTsK
cmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3ByZWZzJywncGx1Z2luX3ByZWZzLmFy
Y190d2l0dGVyJyk7CgovKgogKiBTZXR1cCBpbml0aWFsIHByZWZlcmVuY2VzIGlmIG5vdCBp
biB0aGUgdHhwX3ByZWZzIHRhYmxlLgogKi8KaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0
dGVyX3VzZXInXSkpCiAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXNlcicsICcnLCAnYXJj
X3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3
aXR0ZXJfcHJlZml4J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9wcmVmaXgnLCdKdXN0
IHBvc3RlZDonLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0
KCRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl9zdWZmaXgnLCcnLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1dCcpOwppZiAoIWlz
c2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10pKQogIHNldF9wcmVmKCdhcmNf
dHdpdHRlcl9jYWNoZV9kaXInLCR0eHBjZmdbJ3R4cGF0aCddLiRwcmVmc1sndGVtcGRpcidd
LCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0KCRwcmVmc1sn
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
dHdlZXRfZGVmYXVsdCcsIDEsICdhcmNfdHdpdHRlcicsIDIsICd5ZXNub1JhZGlvJyk7Cmlm
ICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ10pKQogIHNldF9wcmVm
KCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywgJ3Rpbnl1cmwnLCAnYXJjX3R3aXR0ZXInLCAy
LAogICAgJ2FyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0Jyk7CmlmICghaXNzZXQoJHBy
ZWZzWydhcmNfc2hvcnRfdXJsJ10pKQogIHNldF9wcmVmKCdhcmNfc2hvcnRfdXJsJywgMCwg
J2FyY190d2l0dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2Fy
Y19zaG9ydF9zaXRlX3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0X3NpdGVfdXJsJywg
JHByZWZzWydzaXRldXJsJ10sICdhcmNfdHdpdHRlcicsIDIsICd0ZXh0X2lucHV0Jyk7Ci8v
IE1ha2Ugc3VyZSB0aGF0IHRoZSBUd2l0dGVyIHRhYiBoYXMgYmVlbiBkZWZpbmVkCmlmICgh
aXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSkpIHsKICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfdGFiJywgJ2V4dGVuc2lvbnMnLCAnYXJjX3R3aXR0ZXInLCAyLAogICAgJ2FyY190
d2l0dGVyX3RhYl9zZWxlY3QnKTsKICAgICRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10gPSAn
ZXh0ZW5zaW9ucyc7Cn0KCi8vIENoZWNrIGlmIGFyY19zaG9ydF91cmwgaXMgZW5hYmxlZApp
ZiAoKGlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3VybCddKSYmJHByZWZzWydhcmNfc2hvcnRf
dXJsJ10pCnx8IChpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmxfbWV0aG9kJ10pJiYkcHJl
ZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXT09J2FyY190d2l0dGVyJykpIHsKICByZWdp
c3Rlcl9jYWxsYmFjaygnYXJjX3Nob3J0X3VybF9yZWRpcmVjdCcsICd0eHBfZGllJywgNDA0
KTsKfQoKaWYgKEB0eHBpbnRlcmZhY2UgPT0gJ2FkbWluJykgewogICAgcmVnaXN0ZXJfY2Fs
bGJhY2soJ19hcmNfdHdpdHRlcl9hdXRvX2VuYWJsZScsICdwbHVnaW5fbGlmZWN5Y2xlLmFy
Y190d2l0dGVyJywgJ2luc3RhbGxlZCcpOwogICAgaWYgKCFlbXB0eSgkcHJlZnNbJ2FyY190
d2l0dGVyX3VzZXInXSkKICAgICAgICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbiddKQogICAgICAgICYmICFlbXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX2Fj
Y2Vzc1Rva2VuU2VjcmV0J10pICkgewoKICAgICAgICBpZiAoJHByZWZzWydhcmNfdHdpdHRl
cl90YWInXSkgewogICAgICAgICAgICBhZGRfcHJpdnMoJ2FyY19hZG1pbl90d2l0dGVyJywg
JzEsMiwzLDQnKTsKICAgICAgICAgICAgcmVnaXN0ZXJfdGFiKCRwcmVmc1snYXJjX3R3aXR0
ZXJfdGFiJ10sICdhcmNfYWRtaW5fdHdpdHRlcicsICdUd2l0dGVyJyk7CiAgICAgICAgICAg
IHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYWRtaW5fdHdpdHRlcicsICdhcmNfYWRtaW5fdHdp
dHRlcicpOwogICAgICAgIH0KCiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRp
Y2xlX3R3ZWV0JywgJ3BpbmcnKTsKICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2Fy
dGljbGVfdHdlZXQnLCAnYXJ0aWNsZV9zYXZlZCcpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxi
YWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlX3Bvc3RlZCcpOwogICAgICAgIHJl
Z2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5kX3R3aXR0ZXInLCAnYXJ0aWNsZV91aScsICdz
dGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1YmxpYy1zaWRlIGZ1bmN0aW9ucwogICAgPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3aXR0ZXIoJGF0dHMpCnsKICBnbG9iYWwgJHBy
ZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgJ3VzZXInICAgICAgPT4gJHByZWZz
WydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAncGFzc3dvcmQnICA9PiAnJywKICAgICd0aW1l
bGluZScgID0+ICd1c2VyJywKICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAgICAnZmV0Y2gn
ICAgICA9PiAwLAogICAgJ3JldHdlZXRzJyAgPT4gZmFsc2UsCiAgICAncmVwbGllcycgICA9
PiB0cnVlLAogICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQn
XSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAgICdjYWNoZV9kaXInID0+ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAgICAn
bGFiZWwnICAgICA9PiAnJywKICAgICdsYWJlbHRhZycgID0+ICcnLAogICAgJ2JyZWFrJyAg
ICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgJ2NsYXNzJyAgICAgPT4g
X19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLictcG9z
dGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3
aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJT
ZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAs
ICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CgogIGlmICgkY2Fj
aGluZykgeyAgLy8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAg
ICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgJHR3aXQtPmNhY2hlRGlyKCRjYWNoZV9k
aXIpOwogICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgfSBlbHNlIHsgIC8v
IHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0aGFuIGZvciB0ZXN0
aW5nCiAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgfQoKICBzd2l0Y2ggKCR0aW1l
bGluZSkgewogICAgY2FzZSAnaG9tZSc6IGNhc2UgJ2ZyaWVuZHMnOgogICAgICAkdGltZWxp
bmUgPSAnaG9tZV90aW1lbGluZSc7IGJyZWFrOwogICAgY2FzZSAnbWVudGlvbnMnOgogICAg
ICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvbWVudGlvbnNfdGltZWxpbmUnOyBicmVhazsKICAg
IGNhc2UgJ3VzZXInOiBkZWZhdWx0OiAkdGltZWxpbmUgPSAnc3RhdHVzZXMvdXNlcl90aW1l
bGluZSc7CiAgfQoKICAvLyBDaGVjayB0aGF0IHRoZSBmZXRjaCAoVHdpdHRlcidzIGNvdW50
IGF0dHJpYnV0ZSkgaXMgc2V0IGNvcnJlY3RseQogICRmZXRjaCA9ICghJGZldGNoIHx8ICRm
ZXRjaDwkbGltaXQpID8gJGxpbWl0IDogJGZldGNoOwoKICAkb3V0ID0gYXJyYXkoKTsKICAk
dHdlZXRzID0gJHR3aXQtPmdldCgkdGltZWxpbmUsIGFycmF5KAogICAgICAnc2NyZWVuX25h
bWUnPT4kdXNlciwKICAgICAgJ2NvdW50Jz0+JGZldGNoLAogICAgICAnaW5jbHVkZV9ydHMn
PT4kcmV0d2VldHMsCiAgICAgICdleGNsdWRlX3JlcGxpZXMnPT4hJHJlcGxpZXMKICAgICkp
OwoKICBpZiAoJHR3ZWV0cykgewogICAgLy8gQXBwbHkgdGhlIGRpc3BsYXkgbGltaXQgdG8g
dGhlIHJldHVybmVkIHR3ZWV0cwogICAgJHR3ZWV0cyA9IGFycmF5X3NsaWNlKCR0d2VldHMs
IDAsICRsaW1pdCk7CiAgICBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2VldCkgewogICAgICAk
dGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVhdGVkX2F0KSk7CiAg
ICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICRv
dXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0d2VldC0+dGV4
dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAuJyAnLnRhZyhodG1sZW50aXRpZXMo
JGRhdGUpLCdzcGFuJywnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyInKTsKICAgIH0KICB9
CgogICAgcmV0dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpLmRvV3JhcCgkb3V0LCAk
d3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOwoKfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfc2Vh
cmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgIGV4dHJhY3QobEF0dHMoYXJy
YXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10s
CiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycsCiAgICAgICAgJ2hhc2h0YWdzJyAgPT4gJycs
CiAgICAgICAgJ3VzZXInICAgICAgPT4gJycsCiAgICAgICAgJ3JlcGx5JyAgICAgPT4gJycs
CiAgICAgICAgJ21lbnRpb24nICAgPT4gJycsCiAgICAgICAgJ2xpbWl0JyAgICAgPT4gJzEw
JywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAnZGF0ZWZvcm1hdCc9PiAk
cHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgICAgICdjYWNoaW5nJyAgID0+ICcx
JywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2Rp
ciddLAogICAgICAgICdjYWNoZV90aW1lJz0+ICc1JywKICAgICAgICAnbGFiZWwnICAgICA9
PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9PiAnJywKICAgICAgICAnYnJlYWsnICAgICA9
PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgICAgICdjbGFzcycgICAg
ID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAnY2xhc3NfcG9zdGVkJyA9PiBfX0ZVTkNUSU9O
X18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFzc191c2VyJyAgID0+IF9fRlVOQ1RJT05fXy4n
LXVzZXInCiAgICApLCRhdHRzKSk7CgogICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVy
KCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29u
c3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAg
ICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwoKICAgICAg
ICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQgKGRl
ZmF1bHQpCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgICAgICAg
ICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAgICAgICAgICR0d2l0LT5jYWNo
ZVRpbWUoJGNhY2hlX3RpbWUpOwogICAgICAgIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNo
aW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgICAgICAg
ICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBjb25z
dHJ1Y3Qgc2VhcmNoIHF1ZXJ5CiAgICAgICAgaWYgKCFlbXB0eSgkc2VhcmNoKSkgewogICAg
ICAgICAgICAkdGVybXMgPSBleHBsb2RlKCcsJywkc2VhcmNoKTsgJHRlcm1zID0gYXJyYXlf
bWFwKCd0cmltJywkdGVybXMpOwogICAgICAgICAgICAkc2VhcmNoID0gaW1wbG9kZSgnICcs
JHRlcm1zKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRoYXNodGFncykgewogICAgICAgICAg
ICAkaGFzaGVzID0gZXhwbG9kZSgnLCcsJGhhc2h0YWdzKTsgJGhhc2hlcyA9IGFycmF5X21h
cCgndHJpbScsJGhhc2hlcyk7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycg
JzonJykuJyMnLmltcGxvZGUoJyAjJywkaGFzaGVzKTsKICAgICAgICB9CiAgICAgICAgaWYg
KCRyZXBseSkgewogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLid0
bzonLnRyaW0oJHJlcGx5KTsKICAgICAgICB9CiAgICAgICAgaWYgKCR1c2VyKSB7CiAgICAg
ICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ2Zyb206Jy50cmltKCR1c2Vy
KTsKICAgICAgICB9CiAgICAgICAgaWYgKCRtZW50aW9uKSB7CiAgICAgICAgICAgICRzZWFy
Y2guPSAoKCRzZWFyY2gpPycgJzonJykuJ0AnLnRyaW0oJG1lbnRpb24pOwogICAgICAgIH0K
CiAgICAgICAgaWYgKGVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgIHJldHVybiAnJzsK
ICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc2VhcmNoID0gdXJsZW5jb2RlKCRzZWFy
Y2gpOwogICAgICAgIH0KCiAgICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgICAgJHJlc3Vs
dHMgPSAkdHdpdC0+Z2V0KCdzZWFyY2gvdHdlZXRzJwogICAgICAgICAgICAsIGFycmF5KCdx
Jz0+JHNlYXJjaCwnY291bnQnPT4kbGltaXQsJ2xhbmcnPT4kbGFuZykpOwoKICAgICAgICAk
dHdlZXRzID0gJHJlc3VsdHMtPnN0YXR1c2VzOwogICAgICAgIGlmICgkdHdlZXRzKSB7IGZv
cmVhY2ggKCR0d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgICAgIC8vIHByZWdfbWF0Y2go
Ii8oLiopIFwoKC4qKVwpLyIsJHR3ZWV0LT51c2VyLT5zY3JlZW5fbmFtZSwkbWF0Y2hlcyk7
CiAgICAgICAgICAgIC8vIGxpc3QoJGF1dGhvciwkdW5hbWUsJG5hbWUpID0gJG1hdGNoZXM7
CiAgICAgICAgICAgICR1bmFtZSA9ICR0d2VldC0+dXNlci0+c2NyZWVuX25hbWU7CiAgICAg
ICAgICAgICRuYW1lID0gJHR3ZWV0LT51c2VyLT5uYW1lOwogICAgICAgICAgICAkdGltZSA9
IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVhdGVkX2F0KSk7CiAgICAgICAg
ICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAg
ICAgICR0ZXh0ID0gJHR3ZWV0LT50ZXh0OwogICAgICAgICAgICAkb3V0W10gPSB0YWcoaHJl
ZihodG1sZW50aXRpZXMoJHVuYW1lKSwnaHR0cDovL3R3aXR0ZXIuY29tLycgLiAkdHdlZXQt
PnVzZXItPnNjcmVlbl9uYW1lLAogICAgICAgICAgICAgICAgJyB0aXRsZT0iJy5odG1sZW50
aXRpZXMoJG5hbWUpLiciJykuJzogJywnc3BhbicKICAgICAgICAgICAgICAgICAgICAsJyBj
bGFzcz0iJy4kY2xhc3NfdXNlci4nIicpCiAgICAgICAgICAgICAgICAuYXJjX1R3aXR0ZXI6
Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHRleHQsIEVOVF9RVU9URVMsJ1VURi04JykpCiAg
ICAgICAgICAgICAgICAuJyAnLnRhZyhodG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJwogICAg
ICAgICAgICAgICAgICAgICwnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyInKTsKICAgICAg
ICB9IHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxhYmVsdGFnKQogICAgICAgICAgICAuZG9X
cmFwKCRvdXQsICR3cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7IH0KCn0KCmZ1bmN0aW9uIGFy
Y190d2l0dGVyX3R3ZWV0KCRhdHRzKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAg
IGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICAgID0+ICR0aGlzYXJ0aWNs
ZVsndGhpc2lkJ10sCiAgICAgICdpbmNsdWRlX3VybCcgICA9PiB0cnVlCiAgICApLCRhdHRz
KSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0
byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9ICgkaW5jbHVkZV91cmwpID8gc2Fm
ZV9yb3coInR3ZWV0IiwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKQogICAg
ICAgIDogc2FmZV9yb3coIlJFUExBQ0UodHdlZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwnJykg
QVMgdHdlZXQiCiAgICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9
Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdlZXQnXSkgewogICAgICByZXR1cm4gYXJj
X1R3aXR0ZXI6Om1ha2VMaW5rcygKICAgICAgICBodG1sZW50aXRpZXMoJHR3ZWV0Wyd0d2Vl
dCddLCBFTlRfUVVPVEVTLCdVVEYtOCcpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0
ZXJfdHdlZXRfdXJsKCRhdHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0
aWNsZSwkcHJlZnM7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAg
ID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAnJywKICAg
ICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAg
ICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAg
ICR0d2VldCA9IHNhZmVfcm93KCJ0d2VldF9pZCIKICAgICAgICAsICdhcmNfdHdpdHRlcics
ICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdlZXRfaWQn
XSkgewogICAgICAkdXJsID0gImh0dHA6Ly90d2l0dGVyLmNvbS8iLiRwcmVmc1snYXJjX3R3
aXR0ZXJfdXNlciddLiIvc3RhdHVzLyIuJHR3ZWV0Wyd0d2VldF9pZCddOwogICAgICBpZiAo
JHRoaW5nPT09bnVsbCkgewogICAgICAgIHJldHVybiAkdXJsOwogICAgICB9CiAgICAgIHJl
dHVybiBocmVmKHBhcnNlKCR0aGluZyksICR1cmwsCiAgICAgICAgKCR0aXRsZSA/ICcgdGl0
bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAgIC4oJGNsYXNzID8gJyBjbGFzcz0iJy4k
Y2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGlueXVy
bCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAg
ZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsn
dGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcn
CiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdp
dHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93
KCJ0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0i
KTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0aW55dXJsJ10pIHsKICAgICAgaWYgKCR0aGlu
Zz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHR3ZWV0Wyd0aW55dXJsJ107CiAgICAgIH0K
CiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGluZyksICR0d2VldFsndGlueXVybCddLAog
ICAgICAgICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAu
KCRjbGFzcyA/ICcgY2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCi8qCiAq
IFB1YmxpYyB0YWcgZm9yIG91dHB1dHRpbmcgd2lkZ2V0IEpTCiAqLwpmdW5jdGlvbiBhcmNf
dHdpdHRlcl93aWRnZXRfanMoJGF0dHMpCnsKICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAg
ICAgICdvcHRpbWlzZScgPT4gZmFsc2UKICAgICksJGF0dHMpKTsKCiAgcmV0dXJuIF9hcmNf
dHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlKTsKfQoKZnVuY3Rpb24gX2FyY190d2l0dGVy
X3dpZGdldF9qcygkb3B0aW1pc2U9dHJ1ZSkKewogIGdsb2JhbCAkYXJjX3R3aXR0ZXI7Cgog
IC8vIENoZWNrIGlmIHdpZGdldCBKUyBoYXMgYWxyZWFkeSBiZWVuIG91dHB1dAogIGlmICgk
YXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddKSByZXR1cm47CgogIGlmICgkb3B0aW1pc2U9PWZh
bHNlKSB7CiAgICByZXR1cm4gJzxzY3JpcHQgc3JjPSJodHRwOi8vcGxhdGZvcm0udHdpdHRl
ci5jb20vd2lkZ2V0cy5qcyIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij48L3NjcmlwdD4nOwog
IH0KCiAgJGpzID0gPDw8SlMKPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgooZnVu
Y3Rpb24oKSB7CiAgaWYgKHdpbmRvdy5fX3R3aXR0ZXJJbnRlbnRIYW5kbGVyKSByZXR1cm47
CiAgdmFyIGludGVudFJlZ2V4ID0gL3R3aXR0ZXJcLmNvbShcOlxkezIsNH0pP1wvaW50ZW50
XC8oXHcrKS8sCiAgICAgIHdpbmRvd09wdGlvbnMgPSAnc2Nyb2xsYmFycz15ZXMscmVzaXph
YmxlPXllcyx0b29sYmFyPW5vLGxvY2F0aW9uPXllcycsCiAgICAgIHdpZHRoID0gNTUwLAog
ICAgICBoZWlnaHQgPSA0MjAsCiAgICAgIHdpbkhlaWdodCA9IHNjcmVlbi5oZWlnaHQsCiAg
ICAgIHdpbldpZHRoID0gc2NyZWVuLndpZHRoOwoKICBmdW5jdGlvbiBoYW5kbGVJbnRlbnQo
ZSkgewogICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgdmFyIHRhcmdldCA9IGUudGFy
Z2V0IHx8IGUuc3JjRWxlbWVudCwKICAgICAgICBtLCBsZWZ0LCB0b3A7CgogICAgd2hpbGUg
KHRhcmdldCAmJiB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2EnKSB7CiAg
ICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlOwogICAgfQoKICAgIGlmICh0YXJnZXQg
JiYgdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJyAmJiB0YXJnZXQuaHJl
ZikgewogICAgICBtID0gdGFyZ2V0LmhyZWYubWF0Y2goaW50ZW50UmVnZXgpOwogICAgICBp
ZiAobSkgewogICAgICAgIGxlZnQgPSBNYXRoLnJvdW5kKCh3aW5XaWR0aCAvIDIpIC0gKHdp
ZHRoIC8gMikpOwogICAgICAgIHRvcCA9IDA7CgogICAgICAgIGlmICh3aW5IZWlnaHQgPiBo
ZWlnaHQpIHsKICAgICAgICAgIHRvcCA9IE1hdGgucm91bmQoKHdpbkhlaWdodCAvIDIpIC0g
KGhlaWdodCAvIDIpKTsKICAgICAgICB9CgogICAgICAgIHdpbmRvdy5vcGVuKHRhcmdldC5o
cmVmLCAnaW50ZW50Jywgd2luZG93T3B0aW9ucyArICcsd2lkdGg9JyArIHdpZHRoICsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcsaGVpZ2h0PScgKyBo
ZWlnaHQgKyAnLGxlZnQ9JyArIGxlZnQgKyAnLHRvcD0nICsgdG9wKTsKICAgICAgICBlLnJl
dHVyblZhbHVlID0gZmFsc2U7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCAmJiBlLnByZXZl
bnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0KICB9CgogIGlmIChkb2N1bWVudC5hZGRFdmVu
dExpc3RlbmVyKSB7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhh
bmRsZUludGVudCwgZmFsc2UpOwogIH0gZWxzZSBpZiAoZG9jdW1lbnQuYXR0YWNoRXZlbnQp
IHsKICAgIGRvY3VtZW50LmF0dGFjaEV2ZW50KCdvbmNsaWNrJywgaGFuZGxlSW50ZW50KTsK
ICB9CiAgd2luZG93Ll9fdHdpdHRlckludGVudEhhbmRsZXIgPSB0cnVlOwp9KCkpOwo8L3Nj
cmlwdD4KSlM7CiAgJGFyY190d2l0dGVyWyd3aWRnZXRfanMnXSA9IHRydWU7CiAgcmV0dXJu
ICRqczsKfQoKLy8gRGVwcmVjYXRlZCBhcmNfdHdpdHRlcl9yZXR3ZWV0IHRhZywgdXNlIGFy
Y190d2l0dGVyX3R3ZWV0X2J1dHRvbiBpbnN0ZWFkCmZ1bmN0aW9uIGFyY190d2l0dGVyX3Jl
dHdlZXQoJGF0dHMsICR0aGluZz1udWxsKQp7CiAgcmV0dXJuIGFyY190d2l0dGVyX3R3ZWV0
X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwpOwp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3
ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwpCnsKICAgIGdsb2JhbCAkcHJlZnMsJGFy
Y190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CiAg
ICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAg
ICAgJ3VzZXInICAgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwgLy8gdmlh
IHVzZXIgYWNjb3VudAogICAgICAgICd1cmwnICAgICAgICAgPT4gJycsCiAgICAgICAgJ3Rl
eHQnICAgICAgICA9PiAnJywKICAgICAgICAnZm9sbG93MScgICAgID0+ICcnLAogICAgICAg
ICdmb2xsb3cyJyAgICAgPT4gJycsCiAgICAgICAgJ2xhbmcnICAgICAgICA9PiAnJywKICAg
ICAgICAnY291bnQnICAgICAgID0+ICdob3Jpem9udGFsJywKICAgICAgICAnaW5jbHVkZV9q
cycgID0+IHRydWUsCiAgICAgICAgJ29wdGltaXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAn
d3JhcHRhZycgICAgID0+ICcnLAogICAgICAgICdjbGFzcycgICAgICAgPT4gJ3R3aXR0ZXIt
c2hhcmUtYnV0dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0
cmluZwoKICAgIGlmICgkaWQ9JHRoaXNhcnRpY2xlWyd0aGlzaWQnXSkgewogICAgICAvLyBG
ZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICRyb3cg
PSBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0
d2VldCx0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRp
ZH0iKTsKCiAgICAgIGlmICgkdXJsPT0nJykgewogICAgICAgICR1cmwgPSAoJHVybCkgPyAk
dXJsIDogcGVybWxpbmt1cmwoJHRoaXNhcnRpY2xlKTsKICAgICAgICAkcSA9ICd1cmw9Jy51
cmxlbmNvZGUoJHVybCk7CiAgICAgIH0KICAgICAgaWYgKCR0ZXh0PT0nJykgewogICAgICAg
ICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0J10pID8gJHJvd1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNs
ZVsndGl0bGUnXTsKICAgICAgfQogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid0
ZXh0PScudXJsZW5jb2RlKCR0ZXh0KTsKICAgIH0KICAgIGlmICgkdXNlcikgewogICAgICAk
cSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid2aWE9Jy51cmxlbmNvZGUoJHVzZXIpOwogICAg
fQogICAgaWYgKCRmb2xsb3cxJiYkZm9sbG93MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFt
cDsnIDogJycpLidyZWxhdGVkPScudXJsZW5jb2RlKCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7
CiAgICB9IGVsc2VpZiAoJGZvbGxvdzF8fCRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/
ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIp
OwogICAgfQoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsg
Y2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsK
ICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkcSAuPSAo
JHEgPyAnJmFtcDsnIDogJycpLidsYW5nPScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0
Y2ggKCRjb3VudCkgewogICAgICBjYXNlICdub25lJzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2Fs
JzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgJGNvdW50ID0gJ2hvcml6b250YWwn
OwogICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNv
ZGUoJGNvdW50KTsKCiAgICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnVHdlZXQnIDog
cGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRl
ci5jb20vc2hhcmU/Jy4kcQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJyk7CgogICAg
JGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNl
X2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICog
VHdpdHRlciBGb2xsb3cgYnV0dG9uCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRlcl9mb2xsb3df
YnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3
aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKICAgIGds
b2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAn
dXNlcicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNl
ciBhY2NvdW50CiAgICAgICAgJ2xhbmcnICAgICAgICA9PiAnJywKICAgICAgICAnY291bnQn
ICAgICAgID0+IHRydWUsCiAgICAgICAgJ2luY2x1ZGVfanMnICA9PiB0cnVlLAogICAgICAg
ICdvcHRpbWlzZV9qcycgPT4gZmFsc2UsCiAgICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdp
dHRlci1mb2xsb3ctYnV0dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRhdHRzID0gJyc7IC8v
IGRhdGEgYXR0cmlidXRlcwoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnIn
OiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAn
OiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAg
ICAkYXR0cyAuPSAnIGRhdGEtbGFuZz0iJy51cmxlbmNvZGUoJGxhbmcpLiciJzsKCiAgICAk
YXR0cyAuPSAnIGRhdGEtc2hvdy1jb3VudD0iJy4oJGNvdW50Pyd0cnVlJzonZmFsc2UnKS4n
Iic7CgogICAgJHRoaW5nID0gKCR0aGluZz09PW51bGwpID8gJ0ZvbGxvdyBAJy4kdXNlciA6
IHBhcnNlKCR0aGluZyk7CgogICAgJGh0bWwgPSBocmVmKCR0aGluZywnaHR0cDovL3R3aXR0
ZXIuY29tLycudXJsZW5jb2RlKCR1c2VyKQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLici
Jy4kYXR0cyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdpdHRlcl93aWRn
ZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAgcmV0dXJuICRqcy4k
aHRtbDsKfQoKLyoKICAgIEFkbWluLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ciov
CgovLyBJbnN0YWxsYXRpb24gZnVuY3Rpb24gLSBidWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rp
b24gYXJjX3R3aXR0ZXJfaW5zdGFsbCgpCnsKCiAgICAvLyBGb3IgZmlyc3QgaW5zdGFsbCwg
Y3JlYXRlIHRhYmxlIGZvciB0d2VldHMKICAgICRzcWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5P
VCBFWElTVFMgIi5QRlguImFyY190d2l0dGVyICI7CiAgICAkc3FsLj0gIihhcmNfdHdpdHRl
cmlkIElOVEVHRVIgQVVUT19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICAgICAgYXJ0aWNs
ZV9pZCBJTlRFR0VSKDExKSwKICAgICAgICB0d2VldF9pZCBWQVJDSEFSKDEwMCksCiAgICAg
ICAgdHdlZXQgVkFSQ0hBUigxNDApLAogICAgICAgIHRpbnl1cmwgVkFSQ0hBUigzMCkpOyI7
CgogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAt
IHVuYWJsZSB0byBjcmVhdGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKfQoKLy8gVW5p
bnN0YWxsIGZ1bmN0aW9uIC0gZGVsZXRlcyBNeVNRTCB0YWJsZSBhbmQgcmVsYXRlZCBwcmVm
ZXJlbmNlcwpmdW5jdGlvbiBhcmNfdHdpdHRlcl91bmluc3RhbGwoKQp7CgogICAgJHNxbCA9
ICJEUk9QIFRBQkxFIElGIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXI7IjsKICAgIGlmICgh
c2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8g
ZGVsZXRlIGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCiAgICAkc3FsID0gIkRFTEVURSBG
Uk9NICAiLlBGWC4idHhwX3ByZWZzIFdIRVJFIGV2ZW50PSdhcmNfdHdpdHRlcic7IjsKICAg
IGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFi
bGUgdG8gZGVsZXRlIGFyY190d2l0dGVyIHByZWZlcmVuY2VzJzsKICAgIH0KCn0KZnVuY3Rp
b24gYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAgICRt
ZXRob2RzID0gYXJyYXkoJ3Rpbnl1cmwnID0+ICdUaW55dXJsJywKICAgICAgJ2lzZ2QnID0+
ICdJcy5nZCcsCiAgICAgICdhcmNfdHdpdHRlcicgPT4gJ1RYUCBUd2VldCcsCiAgICAgICdz
bWQnID0+ICdzbWRfc2hvcnRfdXJsJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUs
ICRtZXRob2RzLCAkdmFsLCAnJywgJycsICRuYW1lKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRl
cl90YWJfc2VsZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkdGFicyA9IGFycmF5KCdjb250ZW50
JyA9PiAnQ29udGVudCcsCiAgICAgICAgJ2V4dGVuc2lvbnMnID0+ICdFeHRlbnNpb25zJywK
ICAgICAgICAnJyA9PiAnSGlkZGVuJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUs
ICR0YWJzLCAkdmFsLCAnJywgJycsICRuYW1lKTsKfQovLyBQcm92aWRlIGludGVyZmFjZSBm
b3Igc2V0dGluZyBwcmVmZXJlbmNlcwpmdW5jdGlvbiBhcmNfdHdpdHRlcl9wcmVmcygkZXZl
bnQsJHN0ZXApCnsKCiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJHVzZXIgICAgICAgICAgPSAk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXTsKICAgICRwcmVmaXggICAgICAgID0gJHByZWZz
WydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggICAgICAgID0gJHByZWZzWydh
cmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICR0d2VldF9kZWZhdWx0ID0gJHByZWZzWydhcmNf
dHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAgICAkdXJsX21ldGhvZCAgICA9ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddOwogICAgJHNob3J0X3VybCAgICAgPSAkcHJlZnNb
J2FyY19zaG9ydF91cmwnXTsKICAgICRzaG9ydF9zaXRlX3VybD0gJHByZWZzWydhcmNfc2hv
cnRfc2l0ZV91cmwnXTsKICAgICRjYWNoZV9kaXIgICAgID0gJHByZWZzWydhcmNfdHdpdHRl
cl9jYWNoZV9kaXInXTsKICAgICR0YWIgICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRl
cl90YWInXTsKCiAgICBzd2l0Y2ggKCRzdGVwKSB7CiAgICAgICAgY2FzZSAncHJlZnNfc2F2
ZSc6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsICdQcmVmZXJlbmNlcyBzYXZlZCcpOyBicmVhazsK
ICAgICAgICBjYXNlICdyZWdpc3Rlcic6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsJ0Nvbm5lY3Qg
dG8gVHdpdHRlcicpOyBicmVhazsKICAgICAgICBjYXNlICd2YWxpZGF0ZSc6CiAgICAgICAg
ZGVmYXVsdDogcGFnZXRvcCgnVFhQIFR3ZWV0Jyk7CiAgICB9CgogICAgJGh0bWwgPSAnJzsK
CiAgICBpZiAoJHN0ZXA9PSdyZWdpc3RlcicpIHsgLy8gT0F1dGggcmVnaXN0cmF0aW9uIHBy
b2Nlc3MKCiAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2Nv
bnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBC
dWlsZCBhIGNhbGxiYWNrIFVSTCBmb3IgVHdpdHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQg
c3RhZ2UKICAgICAgICAkY2FsbGJhY2tVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50
LCd2YWxpZGF0ZScpOwoKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9r
ZW4oJGNhbGxiYWNrVVJMKTsKICAgICAgICAkcmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJv
YXV0aF90b2tlbiJdOwogICAgICAgICRyZXF1ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0
WyJvYXV0aF90b2tlbl9zZWNyZXQiXTsKCiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVy
X3JlcXVlc3RUb2tlbicsJHJlcXVlc3RfdG9rZW4sICdhcmNfdHdpdHRlcicsMik7CiAgICAg
ICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCcsJHJlcXVlc3Rf
dG9rZW5fc2VjcmV0LCAnYXJjX3R3aXR0ZXInLDIpOwoKICAgICRodG1sID0gIjxkaXYgY2xh
c3M9J3RleHQtY29sdW1uJz4iCiAgICAgIC4iPHA+Ii5ocmVmKCdTaWduLWluIHRvIFR3aXR0
ZXInLCAkdHdpdC0+Z2V0QXV0aG9yaXplVVJMKCRyZXF1ZXN0KSkuIiBhbmQgZm9sbG93IHRo
ZSBpbnN0cnVjdGlvbnMgdG8gYWxsb3cgVFhQIFR3ZWV0IHRvIHVzZSB5b3VyIGFjY291bnQu
IElmIHlvdSBhcmUgYWxyZWFkeSBzaWduZWQgaW4gdG8gVHdpdHRlciB0aGVuIHRoYXQgYWNj
b3VudCB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aCBUWFAgVHdlZXQgc28geW91IG1heSBuZWVk
IHRvIHNpZ24gb3V0IGZpcnN0IGlmIHlvdSB3YW50IHRvIHVzZSBhIGRpZmZlcmVudCBhY2Nv
dW50LjwvcD4iCiAgICAgIC4iPC9kaXY+IjsKCiAgICB9IGVsc2VpZiAoJHN0ZXA9PSd2YWxp
ZGF0ZScpIHsKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJf
Y29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQs
ICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJ10KICAgICAgICAgICAgLCAkcHJl
ZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCddKTsKICAgICAgICAvLyBBc2sg
VHdpdHRlciBmb3IgYW4gYWNjZXNzIHRva2VuIChhbmQgYW4gYWNjZXNzIHRva2VuIHNlY3Jl
dCkKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRBY2Nlc3NUb2tlbiggZ3BzKCdvYXV0
aF92ZXJpZmllcicpICk7CiAgICAgICAgJGFjY2Vzc190b2tlbiA9ICRyZXF1ZXN0WydvYXV0
aF90b2tlbiddOwogICAgICAgICRhY2Nlc3NfdG9rZW5fc2VjcmV0ID0gJHJlcXVlc3RbJ29h
dXRoX3Rva2VuX3NlY3JldCddOwogICAgICAgICR1c2VyID0gJHJlcXVlc3RbJ3NjcmVlbl9u
YW1lJ107CiAgICAgICAgLy8gU3RvcmUgdGhlIGFjY2VzcyB0b2tlbiBhbmQgc2VjcmV0CiAg
ICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJywkYWNjZXNzX3Rva2Vu
LCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9hY2Nl
c3NUb2tlblNlY3JldCcsJGFjY2Vzc190b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAnYXJj
X3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91c2VyJywkdXNl
cik7CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddID0gJGFjY2Vz
c190b2tlbjsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0
J10gPSAkYWNjZXNzX3Rva2VuX3NlY3JldDsKICAgICAgICB1bnNldCgkdHdpdCk7CiAgICB9
CgogICAgaWYgKCRzdGVwPT0icHJlZnNfc2F2ZSIpIHsKICAgICAgICAkcHJlZml4ID0gdHJp
bShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAkc3VmZml4ID0gdHJpbShn
cHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAkdHdlZXRfZGVmYXVsdCA9IGdw
cygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpOwogICAgICAgICR1cmxfbWV0aG9kID0g
Z3BzKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJyk7CiAgICAgICAgJHNob3J0X3VybCA9IGdw
cygnYXJjX3Nob3J0X3VybCcpOwogICAgICAgICRzaG9ydF9zaXRlX3VybCA9IGdwcygnYXJj
X3Nob3J0X3NpdGVfdXJsJyk7CiAgICAgICAgJGNhY2hlX2RpciA9IGdwcygnYXJjX3R3aXR0
ZXJfY2FjaGVfZGlyJyk7CiAgICAgICAgJHRhYiA9IGdwcygnYXJjX3R3aXR0ZXJfdGFiJyk7
CiAgICAgICAgaWYgKHN0cmxlbigkcHJlZml4KTw9MjApIHsKICAgICAgICAgICAgc2V0X3By
ZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCk7CiAgICAgICAgfSBlbHNlIHsKICAg
ICAgICAgICAgJHByZWZpeCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAg
ICAgfQogICAgICAgIGlmIChzdHJsZW4oJHN1ZmZpeCk8PTIwKSB7CiAgICAgICAgICAgIHNl
dF9wcmVmKCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgpOwogICAgICAgIH0gZWxzZSB7
CiAgICAgICAgICAgICRzdWZmaXggPSAkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddOwog
ICAgICAgIH0KICAgICAgICAkdHdlZXRfZGVmYXVsdCA9ICgkdHdlZXRfZGVmYXVsdCkgPyAx
IDogMDsKICAgICAgICAkc2hvcnRfdXJsID0gKCRzaG9ydF91cmwpID8gMSA6IDA7CiAgICAg
ICAgaWYgKCEkc2hvcnRfc2l0ZV91cmwpICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1snc2l0
ZXVybCddOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Jywk
dHdlZXRfZGVmYXVsdCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF91cmwnLCRzaG9y
dF91cmwpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJs
X21ldGhvZCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsJHNob3J0
X3NpdGVfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywk
Y2FjaGVfZGlyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdGFiJywkdGFiKTsK
ICAgIH0KCiAgICBpZiAoICRzdGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgIGlmICggaXNz
ZXQoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmIGlzc2V0
KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CiAgICAgICAg
ICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1sn
YXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2Fy
Y190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVnaXN0ZXJV
UkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwoKICAgICAgICAg
ICAgLy8gRGVmaW5lIHRoZSBmaWVsZHMgcmVhZHkgdG8gYnVpbGQgdGhlIGZvcm0KICAgICAg
ICAgICAgJGZpZWxkcyA9IGFycmF5KAogICAgICAgICdUd2VldCBTZXR0aW5ncycgPT4gYXJy
YXkoCiAgICAgICAgICAnYXJjX3R3aXR0ZXJfcHJlZml4JyA9PiBhcnJheSgKICAgICAgICAg
ICAgJ2xhYmVsJyA9PiAnVHdlZXQgcHJlZml4JywKICAgICAgICAgICAgJ3ZhbHVlJyA9PiAk
cHJlZml4CiAgICAgICAgICApLAogICAgICAgICAgJ2FyY190d2l0dGVyX3N1ZmZpeCcgPT4g
YXJyYXkoCiAgICAgICAgICAgICdsYWJlbCcgPT4gJ1R3ZWV0IHN1ZmZpeCcsCiAgICAgICAg
ICAgICd2YWx1ZScgPT4gJHN1ZmZpeAogICAgICAgICAgKSwKICAgICAgICAgICdhcmNfdHdp
dHRlcl90d2VldF9kZWZhdWx0JyA9PiBhcnJheSgKICAgICAgICAgICAgJ2xhYmVsJyA9PiAn
VHdlZXQgYXJ0aWNsZXMgYnkgZGVmYXVsdCcsCiAgICAgICAgICAgICd0eXBlJyA9PiAneWVz
bm9SYWRpbycsCiAgICAgICAgICAgICd2YWx1ZScgPT4gJHR3ZWV0X2RlZmF1bHQKICAgICAg
ICAgICksCiAgICAgICAgICAnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcgPT4gYXJyYXkoCiAg
ICAgICAgICAgICdsYWJlbCcgPT4gJ1VSTCBzaG9ydG5lcicsCiAgICAgICAgICAgICd0eXBl
JyA9PiAnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QnLAogICAgICAgICAgICAndmFs
dWUnID0+ICR1cmxfbWV0aG9kCiAgICAgICAgICApCiAgICAgICAgKSwKICAgICAgICAnVFhQ
IFR3ZWV0IHNob3J0IFVSTCcgPT4gYXJyYXkoCiAgICAgICAgICAnYXJjX3Nob3J0X3VybCcg
PT4gYXJyYXkoCiAgICAgICAgICAgICdsYWJlbCcgPT4gJ0VuYWJsZSBUWFAgVHdlZXQgc2hv
cnQgVVJMIHJlZGlyZWN0JywKICAgICAgICAgICAgJ3R5cGUnID0+ICd5ZXNub1JhZGlvJywK
ICAgICAgICAgICAgJ3ZhbHVlJyA9PiAkc2hvcnRfdXJsCiAgICAgICAgICApLAogICAgICAg
ICAgJ2FyY19zaG9ydF9zaXRlX3VybCcgPT4gYXJyYXkoCiAgICAgICAgICAgICdsYWJlbCcg
PT4gJ1RYUCBUd2VldCBzaG9ydCBzaXRlIFVSTCcsCiAgICAgICAgICAgICd2YWx1ZScgPT4g
JHNob3J0X3NpdGVfdXJsCiAgICAgICAgICApCiAgICAgICAgKSwKICAgICAgICAnVHdpdHRl
ciBUYWInID0+IGFycmF5KAogICAgICAgICAgJ2FyY190d2l0dGVyX3RhYicgPT4gYXJyYXko
CiAgICAgICAgICAgICdsYWJlbCcgPT4gJ0xvY2F0aW9uIG9mIHRhYicsCiAgICAgICAgICAg
ICd0eXBlJyA9PiAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCcsCiAgICAgICAgICAgICd2YWx1
ZScgPT4gJHRhYgogICAgICAgICAgKQogICAgICAgICksCiAgICAgICAgJ0NhY2hlJyA9PiBh
cnJheSgKICAgICAgICAgICdhcmNfdHdpdHRlcl9jYWNoZV9kaXInID0+IGFycmF5KAogICAg
ICAgICAgICAnbGFiZWwnID0+ICdDYWNoZSBkaXJlY3RvcnknLAogICAgICAgICAgICAndmFs
dWUnID0+ICRjYWNoZV9kaXIKICAgICAgICAgICkKICAgICAgICApCiAgICAgICAgICAgICk7
CgogICAgICAgICAgICAkZm9ybSA9ICI8aDI+VHdpdHRlciBhY2NvdW50IGRldGFpbHM8L2gy
PiIKICAgICAgICAuIjxwPjxzcGFuIGNsYXNzPSdlZGl0LWxhYmVsJz5Ud2l0dGVyIHVzZXJu
YW1lPC9zcGFuPiIKICAgICAgICAuIjxzcGFuIGNsYXNzPSdlZGl0LXZhbHVlJz4iCiAgICAg
ICAgLigkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSA/ICR1c2VyLicgKCcuaHJlZignUmUt
Y29ubmVjdCcsJHJlZ2lzdGVyVVJMKS4nKScgOiAnPGVtPnVua25vd248L2VtPicuaHJlZign
Q29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpKQogICAgICAgICAgICAgICAgLiI8
L3NwYW4+PC9wPiI7CgogICAgICAgICAgICAkZm9ybSAuPSBfYXJjX3R3aXR0ZXJfZm9ybV9i
dWlsZGVyKCRmaWVsZHMpOwoKICAgICAgICAgICAgJGZvcm0gLj0gc0lucHV0KCdwcmVmc19z
YXZlJykubi5lSW5wdXQoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpOwoKICAgICAgJGZv
cm0gLj0gJzxwPicuZklucHV0KCdzdWJtaXQnLCAnU3VibWl0JywgZ1R4dCgnc2F2ZV9idXR0
b24nKSwgJ3B1Ymxpc2gnKS4nPC9wPic7CgogICAgICAkaHRtbCA9ICI8aDEgY2xhc3M9J3R4
cC1oZWFkaW5nJz5UWFAgVHdlZXQ8L2gxPiIKICAgICAgICAuIjxwIGNsYXNzPSduYXYtdGVy
dGlhcnknPiIKICAgICAgICAuIjxhIGhyZWY9Jy4vP2V2ZW50PWFyY19hZG1pbl90d2l0dGVy
JyBjbGFzcz0nbmF2bGluayc+VHdpdHRlcjwvYT48YSBocmVmPScuLz9ldmVudD1wbHVnaW5f
cHJlZnMuYXJjX3R3aXR0ZXInIGNsYXNzPSduYXZsaW5rLWFjdGl2ZSc+T3B0aW9uczwvYT4i
CiAgICAgICAgLiI8L3A+IjsKCiAgICAgICRodG1sIC49IGZvcm0oIjxkaXYgY2xhc3M9J3Bs
dWdpbi1jb2x1bW4nPiIuJGZvcm0uIjwvZGl2PiIsICIgY2xhc3M9J2VkaXQtZm9ybSciKTsK
CiAgICAgICAgfSBlbHNlaWYgKCAkc3RlcCE9J3JlZ2lzdGVyJyApIHsKCiAgICAgICAgICAg
ICRyZWdpc3RlclVSTCA9IGFyY190d2l0dGVyOjpjYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lz
dGVyJyk7CgogICAgICAgICAgICAkZm9ybSA9ICI8aDI+VHdpdHRlciBhY2NvdW50IGRldGFp
bHM8L2gyPiIKICAgICAgICAuIjxzcGFuIGNsYXNzPSdlZGl0LWxhYmVsJz5Ud2l0dGVyIHVz
ZXJuYW1lPC9zcGFuPiIKICAgICAgICAuIjxzcGFuIGNsYXNzPSdlZGl0LXZhbHVlJz48ZW0+
dW5rbm93bjwvZW0+ICZtZGFzaDsgIgogICAgICAgIC5ocmVmKCdDb25uZWN0IHRvIFR3aXR0
ZXInLCRyZWdpc3RlclVSTCkKICAgICAgICAgICAgICAgIC4iPC9zcGFuPiI7CgogICAgICAk
aHRtbCA9IGZvcm0oIjxkaXYgY2xhc3M9J3BsdWdpbi1jb2x1bW4nPiIuJGZvcm0uIjwvZGl2
PiIsICIgY2xhc3M9J2VkaXQtZm9ybSciKTsKCiAgICAgICAgfQogICAgfQoKICAgIC8vIFNl
dCBqUXVlcnkgZm9yIHN3aXRjaGluZyBvbi9vZmYgcmVsZXZhbnQgYXJjX3Nob3J0X3VybCBm
aWVsZHMKICAgICRqcyA9IDw8PEpTCjxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5
cGU9InRleHQvamF2YXNjcmlwdCI+CiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAg
dmFyIG9ub2ZmID0gJCgnLmFyY19zaG9ydF91cmwnKTsKICB2YXIgYXJjX3Nob3J0X3VybF9v
ZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1hcmNfc2hvcnRfdXJsLTAnKTsKICB2YXIgdXJsID0g
JCgnLmFyY19zaG9ydF9zaXRlX3VybCcpOwogIHZhciB1cmxfbWV0aG9kID0gJCgnc2VsZWN0
W25hbWU9ImFyY190d2l0dGVyX3VybF9tZXRob2QiXScpOwoKICBpZiAoYXJjX3Nob3J0X3Vy
bF9vZmYuYXR0cignY2hlY2tlZCcpPT0nY2hlY2tlZCcgJiYgJCgnb3B0aW9uOnNlbGVjdGVk
JywgdXJsX21ldGhvZCkudmFsKCkhPSdhcmNfdHdpdHRlcicpIHsKICAgIHVybC5oaWRlKCk7
CiAgfQogICQoJ2lucHV0Jywgb25vZmYpLmNoYW5nZShmdW5jdGlvbigpewogICAgaWYgKCQo
J29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7
CiAgICAgIGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09J2NoZWNrZWQnID8g
dXJsLmhpZGUoKSA6IHVybC5zaG93KCk7CiAgICB9CiAgfSk7CgogIGlmICgkKCdvcHRpb246
c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0dGVyJykgewogICAgb25v
ZmYuaGlkZSgpOyB1cmwuc2hvdygpOwogIH0KICB1cmxfbWV0aG9kLmNoYW5nZShmdW5jdGlv
bigpewogICAgaWYgKCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0n
YXJjX3R3aXR0ZXInKSB7CiAgICAgIG9ub2ZmLnRvZ2dsZSgpOyB1cmwuc2hvdygpOwogICAg
fSBlbHNlIHsKICAgICAgb25vZmYudG9nZ2xlKCk7CiAgICAgIGFyY19zaG9ydF91cmxfb2Zm
LmF0dHIoJ2NoZWNrZWQnKT09J2NoZWNrZWQnID8gdXJsLmhpZGUoKSA6IHVybC5zaG93KCk7
CiAgICB9CiAgfSkKfSk7Cjwvc2NyaXB0PgpKUzsKCiAgICBlY2hvICRqcy4kaHRtbDsKfQoK
ZnVuY3Rpb24gX2FyY190d2l0dGVyX2Zvcm1fYnVpbGRlcigkZmllbGRzKSB7CgogICRmb3Jt
ID0gJyc7CgogIGZvcmVhY2ggKCRmaWVsZHMgYXMgJGZrID0+ICRmdikgewoKICAgICRmb3Jt
IC49ICgkZmspID8gIjxoMj4kZms8L2gyPiIgOiAnJzsKCiAgICBmb3JlYWNoICgkZnYgYXMg
JGsgPT4gJHYpIHsKCiAgICAgICR0eXBlID0gaXNzZXQoJHZbJ3R5cGUnXSkgPyAkdlsndHlw
ZSddIDogJ3RleHQnOwoKICAgICAgJGZvcm0gLj0gIjxwIGNsYXNzPSckayc+IgogICAgICAg
IC4iPHNwYW4gY2xhc3M9J2VkaXQtbGFiZWwnPjxsYWJlbCBmb3I9JyRrJz4iLiR2WydsYWJl
bCddLiI8L2xhYmVsPjwvc3Bhbj4iOwoKICAgICAgc3dpdGNoICgkdHlwZSkgIHsKCiAgICAg
ICAgY2FzZSAndGV4dGFyZWEnOgoKICAgICAgICAgICRmb3JtIC49IHRleHRfYXJlYSgkaywg
JzUwJywgJzU1MCcsICR2Wyd2YWx1ZSddLCAkayk7CiAgICAgICAgICBicmVhazsKCiAgICAg
ICAgY2FzZSAneWVzbm9SYWRpbyc6CgogICAgICAgICAgJGZvcm0gLj0gIjxzcGFuIGNsYXNz
PSdlZGl0LXZhbHVlJz4iLnllc25vUmFkaW8oJGssICR2Wyd2YWx1ZSddLCAnJywgJGspLiI8
L3NwYW4+IjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdhcmNfdHdpdHRlcl90
YWJfc2VsZWN0JzoKCiAgICAgICAgICAkZm9ybSAuPSAiPHNwYW4gY2xhc3M9J2VkaXQtdmFs
dWUnPiIuYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgkaywgJHZbJ3ZhbHVlJ10pLiI8L3NwYW4+
IjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdhcmNfdHdpdHRlcl91cmxfbWV0
aG9kX3NlbGVjdCc6CgogICAgICAgICAgJGZvcm0gLj0gIjxzcGFuIGNsYXNzPSdlZGl0LXZh
bHVlJz4iLmFyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0KCRrLCAkdlsndmFsdWUnXSku
Ijwvc3Bhbj4iOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CgogICAgICAg
ICAgJGZvcm0gLj0gIjxzcGFuIGNsYXNzPSdlZGl0LXZhbHVlJz4iLmZJbnB1dCgndGV4dCcs
JGssJHZbJ3ZhbHVlJ10sJycsJycsJycsJycsJycsJGspLiI8L3NwYW4+IjsKICAgICAgICAg
IGJyZWFrOwoKICAgICAgfQoKICAgICAgJGZvcm0gLj0gIjwvcD4iOwogICAgfQoKICB9Cgog
IHJldHVybiAkZm9ybTsKfQoKLy8gQWRkIFR3aXR0ZXIgdGFiIHRvIFRleHRwYXR0ZXJuCmZ1
bmN0aW9uIGFyY19hZG1pbl90d2l0dGVyKCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRw
cmVmcywgJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJT
ZWNyZXQ7CgogICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1
bWVyS2V5CiAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJl
ZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2Fy
Y190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwoKICAgICR0d2l0LT5jYWNoZURpcigk
cHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddKTsKCiAgICAkZGF0YSA9ICR0d2l0LT5n
ZXQoJ3VzZXJzL3Nob3cnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNb
J2FyY190d2l0dGVyX3VzZXInXSkpOwogICAgJHR3aXR0ZXJVc2VyID0gJGRhdGE7CiAgICAk
dHdpdHRlclVzZXJVUkwgPSAnaHR0cDovL3d3dy50d2l0dGVyLmNvbS8nLiR0d2l0dGVyVXNl
ci0+c2NyZWVuX25hbWU7CgogICAgaWYgKCRzdGVwPT0idHdlZXQiKSB7IC8vIHBvc3QgYW4g
dXBkYXRlIHRvIFR3aXR0ZXIKCiAgICAgICAgLy8gZmV0Y2ggYW5kIGNsZWFuIG1lc3NhZ2UK
ICAgICAgICAkbWVzc2FnZSA9IHN0cmlwX3RhZ3MoZ3BzKCdtZXNzYWdlJykpOwogICAgICAg
ICRjb3VudCA9IHN0cmxlbigkbWVzc2FnZSk7CgogICAgICAgIGlmICgkY291bnQ8PTE0MCAm
JiAkY291bnQ+MCkgeyAvLyBwb3N0IHVwZGF0ZQogICAgICAgICAgICAkcmVzdWx0ID0gJHR3
aXQtPnBvc3QoJ3N0YXR1c2VzL3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICRtZXNzYWdl
KSk7CiAgICAgICAgfSBlbHNlIHsgLy8gbWVzc2FnZSB0b28gbG9uZywgSmF2YVNjcmlwdCBp
bnRlcmZhY2Ugc2hvdWxkIHByZXZlbnQgdGhpcwogICAgICAgICAgICAkcmVzdWx0ID0gZmFs
c2U7CiAgICAgICAgfQoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJywKICAgICAgICAgICAg
KCgkcmVzdWx0IT1mYWxzZSk/J1R3aXR0ZXIgdXBkYXRlZCc6J0Vycm9yIHVwZGF0aW5nIFR3
aXR0ZXInKSk7CgogICAgfSBlbHNlaWYgKCRzdGVwPT0iZGVsZXRlIikgeyAvLyBkZWxldGUg
YW4gdXBkYXRlIGZyb20gVHdpdHRlcgoKICAgICAgICAkaWQgPSBzdHJpcF90YWdzKGdwcygn
aWQnKSk7CiAgICAgICAgaWYgKCRpZCkgewogICAgICAgICAgICAkdHdpdC0+ZGVsZXRlKCdz
dGF0dXNlcy9kZXN0cm95LycuJGlkKTsKICAgICAgICAgICAgc2FmZV9kZWxldGUoJ2FyY190
d2l0dGVyJywidHdlZXRfaWQgPSAkaWQiKTsKICAgICAgICB9CgogICAgICAgIHBhZ2V0b3Ao
J1R3aXR0ZXInLCdUd2l0dGVyIHVwZGF0ZWQnKTsKCiAgICB9IGVsc2UgewoKICAgICAgICBw
YWdldG9wKCdUd2l0dGVyJyk7CgogICAgfQoKICAgIC8vIFByZXBhcmUgSmF2YVNjcmlwdCB0
byBjcmVhdGUgVHdpdHRlciB1cGRhdGUgaW50ZXJmYWNlCgogICAgJGpzID0gJzxzY3JpcHQg
bGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+JzsKICAgICRq
cy49IDw8PEpTCiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpewogICAgdmFyIGNv
dW50ZXIgPSAkKCc8c3Bhbj4nLCB7CiAgICAgICAgJ3RleHQnIDogJzE0MCcsCiAgICAgICAg
J2lkJyA6ICd0d2VldGNvdW50JwogICAgICB9KTsKICAgICQoJy5tZXNzYWdlJykuYXBwZW5k
KGNvdW50ZXIpOwogICAgICAgICAgICB2YXIgY291bnRlclN0eWxlID0gJ2ZvbnQtd2VpZ2h0
OmJvbGQ7cGFkZGluZy1sZWZ0Oi41ZW07Zm9udC1zaXplOjJlbTtsaW5lLWhlaWdodDoxLjJl
bTsnOwogICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRl
clN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAgICAkKCcjbWVzc2FnZScpLmtleXVw
KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMTQwLSQoJyNtZXNz
YWdlJykudmFsKCkubGVuZ3RoOwogICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5o
dG1sKGNvdW50KycnKTsgLy8gaGFjayB0byBmb3JjZSBvdXRwdXQgb2YgMAogICAgICAgICAg
ICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJs
aXNoJykucHJvcCgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTsKICAgICAgICAgICAgICAgIH0g
ZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLnByb3AoJ2Rp
c2FibGVkJywgJycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGNv
dW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0
eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojZjAwOycpOwogICAgICAgICAgICAgICAgfSBl
bHNlIGlmIChjb3VudDwxMCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50
JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiMwMDA7Jyk7CiAgICAgICAg
ICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50Jyku
YXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7CkpTOwogICAgJGpzLj0gIjwvc2Ny
aXB0PiI7CgogICAgJG91dCA9ICcnOwogICAgJHR3ZWV0cyA9ICR0d2l0LT5nZXQoJ3N0YXR1
c2VzL3VzZXJfdGltZWxpbmUnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJl
ZnNbJ2FyY190d2l0dGVyX3VzZXInXSwnY291bnQnPT4yNSkpOwogICAgaWYgKCR0d2VldHMp
IGZvcmVhY2ggKCR0d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUgPSBzdHJ0b3Rp
bWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICRkYXRlID0g
c2FmZV9zdHJmdGltZSgkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLCR0aW1lKTsKICAg
ICAgICAkb3V0Lj0gdHIodGQoJGRhdGUsJ3NwYW4nKQogICAgICAgICAgICAudGQoYXJjX1R3
aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0CiAgICAgICAgICAg
ICAgICAsIEVOVF9RVU9URVMsJ1VURi04JykpKQogICAgICAgICAgICAudGQoZExpbmsoJ2Fy
Y19hZG1pbl90d2l0dGVyJywnZGVsZXRlJywnaWQnLCR0d2VldC0+aWRfc3RyLCcnKSkKICAg
ICAgICAgICAgKTsKICAgIH0KCiAgICAkZmllbGRzID0gYXJyYXkoCiAgICAnJyA9PiBhcnJh
eSgKICAgICAgJ21lc3NhZ2UnID0+IGFycmF5KAogICAgICAgICdsYWJlbCcgPT4gJ1VwZGF0
ZSBUd2l0dGVyJywKICAgICAgICAndHlwZScgPT4gJ3RleHRhcmVhJywKICAgICAgICAndmFs
dWUnID0+ICcnCiAgICAgICkKICAgICkKICAgICk7CgogICAgJHByb2ZpbGUgPSAnPGltZyBz
cmM9IicuJHR3aXR0ZXJVc2VyLT5wcm9maWxlX2ltYWdlX3VybC4nIiBhbHQ9IlR3aXR0ZXIg
YXZhdGFyIiBzdHlsZT0iZmxvYXQ6bGVmdDsgbWFyZ2luLXJpZ2h0OiAxZW0iIC8+JwogICAg
LmdyYWYoaHJlZigkdHdpdHRlclVzZXItPm5hbWUsJHR3aXR0ZXJVc2VyVVJMKSwnIHN0eWxl
PSJmb250LXNpemU6MS4yZW07Zm9udC13ZWlnaHQ6Ym9sZDsiJykKICAgIC5ncmFmKGhyZWYo
JHR3aXR0ZXJVc2VyLT5mcmllbmRzX2NvdW50LicgZm9sbG93aW5nJywkdHdpdHRlclVzZXJV
UkwuJy9mb2xsb3dpbmcnKQogICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPmZvbGxvd2Vy
c19jb3VudC4nIGZvbGxvd2VycycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93ZXJzJykKICAg
IC4nLCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5zdGF0dXNlc19jb3VudC4nIHVwZGF0ZXMnLCR0
d2l0dGVyVXNlclVSTCkpOwoKICAgICRmb3JtID0gX2FyY190d2l0dGVyX2Zvcm1fYnVpbGRl
cigkZmllbGRzKQogICAgLmVJbnB1dCgnYXJjX2FkbWluX3R3aXR0ZXInKQogICAgLnNJbnB1
dCgndHdlZXQnKTsKICAkZm9ybSAuPSAnPHA+Jy5mSW5wdXQoJ3N1Ym1pdCcsICdTdWJtaXQn
LCBnVHh0KCdVcGRhdGUnKSwgJ3B1Ymxpc2gnKS4nPC9wPic7CgogICRodG1sID0gIjxoMSBj
bGFzcz0ndHhwLWhlYWRpbmcnPlRYUCBUd2VldDwvaDE+IgogICAgLiI8cCBjbGFzcz0nbmF2
LXRlcnRpYXJ5Jz4iCiAgICAuIjxhIGhyZWY9Jy4vP2V2ZW50PWFyY19hZG1pbl90d2l0dGVy
JyBjbGFzcz0nbmF2bGluay1hY3RpdmUnPlR3aXR0ZXI8L2E+PGEgaHJlZj0nLi8/ZXZlbnQ9
cGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJyBjbGFzcz0nbmF2bGluayc+T3B0aW9uczwvYT4i
CiAgICAuIjwvcD4iOwoKICAgICRodG1sIC49ICI8ZGl2IGNsYXNzPSd0ZXh0LWNvbHVtbic+
Ii4kcHJvZmlsZS4iPC9kaXY+IgogICAgLiI8YnIgc3R5bGU9J2NsZWFyOmJvdGgnIC8+Igog
ICAgLmZvcm0oIjxkaXYgY2xhc3M9J3BsdWdpbi1jb2x1bW4nPiIuJGZvcm0uIjwvZGl2PiIu
YnIpOwoKICAgIC8vIEF0dGFjaCByZWNlbnQgVHdpdHRlciB1cGRhdGVzCgogICAgJGh0bWwu
PSAiPGRpdiBjbGFzcz0ndHhwLWxpc3R0YWJsZXMnPiIKICAgIC5zdGFydFRhYmxlKCdhcmNf
dHdpdHRlcl90aW1lbGluZScsJycsJ3R4cC1saXN0JykuJG91dC5lbmRUYWJsZSgpCiAgICAu
IjwvZGl2PiI7CgogICAgLy8gT3V0cHV0IEphdmFTY3JpcHQgYW5kIEhUTUwKCiAgICBlY2hv
ICRqcy4kaHRtbDsKfQoKLy8gQWRkIFR3aXR0ZXIgb3B0aW9ucyB0byBhcnRpY2xlIGFydGlj
bGUgc2NyZWVuCmZ1bmN0aW9uIGFyY19hcHBlbmRfdHdpdHRlcigkZXZlbnQsICRzdGVwLCAk
ZGF0YSwgJHJzMSkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyLCAkYXBwX21v
ZGU7CgogICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAg
ICAkcHJlZml4ID0gKCRwcmVmaXgpID8gJHByZWZpeCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJf
cHJlZml4J107CiAgICAkc3VmZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcp
KTsKICAgICRzdWZmaXggPSAoJHN1ZmZpeCkgPyAkc3VmZml4IDogJHByZWZzWydhcmNfdHdp
dHRlcl9zdWZmaXgnXTsKCiAgICBpZiAoJHJzMVsnSUQnXSkgewogICAgICAgICRzcWwgPSAi
U0VMRUNUIHR3ZWV0X2lkLHR3ZWV0IEZST00gIi5QRlguImFyY190d2l0dGVyIFdIRVJFIGFy
dGljbGVfaWQ9Ii4kcnMxWydJRCddLiI7IjsKICAgICAgICAkcnMyID0gc2FmZV9xdWVyeSgk
c3FsKTsgJHJzMiA9IG5leHRSb3coJHJzMik7CiAgICB9IGVsc2UgeyAvLyBuZXcgYXJ0aWNs
ZQogICAgICAgICRyczIgPSAnJzsKICAgIH0KCiAgICBpZiAoJGFwcF9tb2RlID09ICdhc3lu
YycpCiAgICB7CiAgICAgc2VuZF9zY3JpcHRfcmVzcG9uc2UoJyQoIiNhcmNfdHdpdHRlciIp
LnJlbW92ZSgpOycpOwogICAgfQoKICAgIGlmICgkcnMxWydJRCddICYmICRyczJbJ3R3ZWV0
X2lkJ10pIHsKICAgICAgICAkY29udGVudCA9IHRhZyhhcmNfVHdpdHRlcjo6bWFrZUxpbmtz
KCRyczJbJ3R3ZWV0J10pLCdwJyk7CiAgICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRj
b250ZW50LCAnVHdpdHRlciB1cGRhdGUnLCAnYXJjX3R3aXR0ZXInKTsKICAgIH0gZWxzZSB7
CiAgICAgICAgJHZhciA9IGdwcygnYXJjX3R3ZWV0X3RoaXMnKTsKICAgICAgICAkdmFyID0g
KCRyczFbJ0lEJ10mJiEkdmFyKSA/IDAgOiAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2Rl
ZmF1bHQnXTsKICAgICAgICAkY29udGVudCAgPSB0YWcoeWVzbm9SYWRpbygnYXJjX3R3ZWV0
X3RoaXMnLCAkdmFyLCAnJywgJ2FyY190d2VldF90aGlzJyksJ3AnKTsKICAgICAgICAkY29u
dGVudCAuPSB0YWcoaHJlZignT3B0aW9ucycsJyNhcmNfdHdpdHRlcl9vcHRpb25zJywgJyBv
bmNsaWNrPSIkKFwnI2FyY190d2l0dGVyX29wdGlvbnNcJykudG9nZ2xlKCk7IHJldHVybiBm
YWxzZTsiJyksJ3AnLCcgc3R5bGU9Im1hcmdpbi10b3A6NXB4OyInKTsKICAgICAgICAkY29u
dGVudCAuPSB0YWcodGFnKHRhZygnVHdlZXQgcHJlZml4JywnbGFiZWwnLCAnIGZvcj0iYXJj
X3R3aXR0ZXJfcHJlZml4IicpCiAgICAgICAgICAgIC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdp
dHRlcl9wcmVmaXgnLCRwcmVmaXgsJ2VkaXQnLCcnLCcnLCcyMicsJycsJ2FyY190d2l0dGVy
X3ByZWZpeCcpLCdwJykKICAgICAgICAgICAgLnRhZyh0YWcoJ1R3ZWV0IHN1ZmZpeCAoZWcg
I2hhc2h0YWdzKScsJ2xhYmVsJywgJyBmb3I9ImFyY190d2l0dGVyX3N1ZmZpeCInKQogICAg
ICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3VmZml4LCdl
ZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRlcl9zdWZmaXgnKSwncCcpCiAgICAgICAg
ICAgICwnZGl2JywnIGlkPSJhcmNfdHdpdHRlcl9vcHRpb25zIiBjbGFzcz0idG9nZ2xlIiBz
dHlsZT0iZGlzcGxheTpub25lIicpOwogICAgICAgIGlmIChpc3NldCgkYXJjX3R3aXR0ZXJb
J2Vycm9yJ10pKSB7CiAgICAgICAgICAgICRjb250ZW50IC49ICc8cD4nLiRhcmNfdHdpdHRl
clsnZXJyb3InXS4nPC9wPic7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkZGF0YS5maWVs
ZHNldCgkY29udGVudCwgJ1VwZGF0ZSBUd2l0dGVyJywgJ2FyY190d2l0dGVyJyk7CiAgICB9
Cgp9CgovLyBVcGRhdGUgVHdpdHRlciB3aXRoIHBvc3RlZCBhcnRpY2xlCmZ1bmN0aW9uIGFy
Y19hcnRpY2xlX3R3ZWV0KCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFy
Y190d2l0dGVyLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAsICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkYXJ0aWNsZV9pZCA9IGVtcHR5KCRHTE9CQUxT
WydJRCddKSA/IGdwcygnSUQnKSA6ICRHTE9CQUxTWydJRCddOwogICAgaWYgKCFlbXB0eSgk
YXJ0aWNsZV9pZCkpIHsKCiAgICAgICAgaW5jbHVkZV9vbmNlIHR4cGF0aC4nL3B1Ymxpc2gv
dGFnaGFuZGxlcnMucGhwJzsKCiAgICAgICAgJGFydGljbGUgPSBzYWZlX3JvdygiSUQsIFRp
dGxlLCBTZWN0aW9uLCBQb3N0ZWQiLCAndGV4dHBhdHRlcm4nLAogICAgICAgICAgICAiSUQ9
eyRhcnRpY2xlX2lkfSBBTkQgU3RhdHVzPTQgQU5EIG5vdygpPj1Qb3N0ZWQiKTsKCiAgICAg
ICAgaWYgKCRhcnRpY2xlICYmIGdwcygnYXJjX3R3ZWV0X3RoaXMnKSkgeyAvLyB0d2VldCBh
cnRpY2xlCgogICAgICAgICAgICAvLyBOZWVkIHRvIG1hbnVhbGx5IHVwZGF0ZSB0aGUgJ1VS
TCBvbmx5IHRpdGxlJyBiZWZvcmUgYnVpbGRpbmcgdGhlCiAgICAgICAgICAgIC8vIFVSTAog
ICAgICAgICAgICAkYXJ0aWNsZVsndXJsX3RpdGxlJ10gPSBncHMoJ3VybF90aXRsZScpOwog
ICAgICAgICAgICAvLyBNYWtlIHNob3J0IFVSTAogICAgICAgICAgICAkdXJsID0gcGVybWxp
bmt1cmwoJGFydGljbGUpOwogICAgICAgICAgICAkc2hvcnRfdXJsID0gYXJjX3Nob3J0ZW5f
dXJsKCR1cmwsJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ10sCiAgICAgICAgICAg
ICAgICBhcnJheSgnaWQnPT4kYXJ0aWNsZV9pZCkpOwoKICAgICAgICAgICAgaWYgKCEkc2hv
cnRfdXJsKSB7IC8vIEZhaWxlZCB0byBvYnRhaW4gYSBzaG9ydGVuZWQgVVJMLCBkbyBub3Qg
dHdlZXQhCiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVW5hYmxl
IHRvIG9idGFpbiBhIHNob3J0IFVSTCBmb3IgdGhpcyBhcnRpY2xlLic7CgogICAgICAgICAg
ICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBDb25z
dHJ1Y3QgVHdpdHRlciB1cGRhdGUKICAgICAgICAgICAgJHByZWZpeCAgPSB0cmltKGdwcygn
YXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAgICAgICAkcHJlX2xlbiA9IHN0cmxlbigk
cHJlZml4KTsKICAgICAgICAgICAgJHByZWZpeCAgPSAoJHByZWZpeCAmJiAkcHJlX2xlbjw9
MjApID8gJHByZWZpeC4nICcgOiAnJzsKICAgICAgICAgICAgJHN1ZmZpeCAgPSB0cmltKGdw
cygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAgICAgICAgICAkc3VmX2xlbiA9IHN0cmxl
bigkc3VmZml4KTsKICAgICAgICAgICAgJHN1ZmZpeCAgPSAoJHN1ZmZpeCAmJiAkc3VmX2xl
bjw9NDApID8gJyAnLiRzdWZmaXggOiAnJzsKICAgICAgICAgICAgJHVybF9sZW4gPSBzdHJs
ZW4oJHNob3J0X3VybCkrMTsgLy8gY291bnQgVVJMIGxlbmd0aCArIDEgZm9yIHByZWZpeGVk
IHNwYWNlCiAgICAgICAgICAgIGlmICgkcHJlZml4KSAkcHJlX2xlbiArPSAxOwogICAgICAg
ICAgICBpZiAoJHN1ZmZpeCkgJHN1Zl9sZW4gKz0gMTsKICAgICAgICAgICAgaWYgKChzdHJs
ZW4oJGFydGljbGVbJ1RpdGxlJ10pKyR1cmxfbGVuKyRwcmVfbGVuKyRzdWZfbGVuKT4xNDAp
IHsKICAgICAgICAgICAgICAgICRhcnRpY2xlWydUaXRsZSddID0gc3Vic3RyKCRhcnRpY2xl
WydUaXRsZSddLDAsMTM1LSR1cmxfbGVuLSRwcmVfbGVuLSRzdWZfbGVuKS4nLi4uJzsKICAg
ICAgICAgICAgfQogICAgICAgICAgICAkdHdlZXQgPSAkcHJlZml4LiRhcnRpY2xlWydUaXRs
ZSddLiIgIi4kc2hvcnRfdXJsLiRzdWZmaXg7CgogICAgICAgICAgICAvLyBVcGRhdGUgVHdp
dHRlcgogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJf
Y29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgICAg
ICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKICAgICAgICAg
ICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBhcnJheSgnc3Rh
dHVzJyA9PiAkdHdlZXQpKTsKCiAgICAgICAgICAgICR0d2VldF9pZCA9IChpc19vYmplY3Qo
JHJlc3VsdCkpID8gJHJlc3VsdC0+aWRfc3RyIDogMDsKCiAgICAgICAgICAgIGlmICgkdHdl
ZXRfaWQpIHsKCiAgICAgICAgICAgICAgICAkdHdlZXQgPSBhZGRzbGFzaGVzKCR0d2VldCk7
CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIGFyY190d2l0dGVyIHRhYmxlIHdpdGggdHdl
ZXQKICAgICAgICAgICAgICAgICRzcWwgPSAiSU5TRVJUIElOVE8gIi5QRlguImFyY190d2l0
dGVyIChhcnRpY2xlX2lkLHR3ZWV0X2lkLHR3ZWV0LHRpbnl1cmwpICI7CiAgICAgICAgICAg
ICAgICAkc3FsLj0gIlZBTFVFUygkYXJ0aWNsZV9pZCwkdHdlZXRfaWQsXCIkdHdlZXRcIiwn
JHNob3J0X3VybCcpOyI7CiAgICAgICAgICAgICAgICBzYWZlX3F1ZXJ5KCRzcWwpOwoKICAg
ICAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAg
ICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVHdpdHRlciByZXNwb25zZTog
JwogICAgICAgICAgICAgICAgICAgIC4kdHdpdC0+aHR0cF9jb2RlOwogICAgICAgICAgICAg
ICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQoKICAgICAgICB9CgogICAgfQoKICAg
IHJldHVybiBmYWxzZTsKCn0KCi8qCiAqIFNob3J0ZW4gVVJMcyB1c2luZyB2YXJpb3VzIG1l
dGhvZHMKICovCgpmdW5jdGlvbiBhcmNfc2hvcnRlbl91cmwoJHVybCwgJG1ldGhvZD0nJywg
JGF0dHM9YXJyYXkoKSkKewogIGdsb2JhbCAkcHJlZnM7CgogICRjaCA9IGN1cmxfaW5pdCgp
OwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9IRUFERVIsIDApOwogIGN1cmxfc2V0b3B0
KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgY3VybF9zZXRvcHQoJGNo
LCBDVVJMT1BUX1RJTUVPVVQsIDEwKTsKCiAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICBjYXNl
ICdzbWQnOiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQgVVJMIHVzaW5nIFNNRCBTaG9ydCBVUkwK
ICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBodS4kYXR0c1snaWQnXSA6IGZhbHNlOyBi
cmVhazsKICAgIGNhc2UgJ2FyY190d2l0dGVyJzogLy8gbmF0aXZlIFVSTCBzaG9ydGVuaW5n
CgogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IFBST1RPQ09MLiRwcmVmc1snYXJjX3No
b3J0X3NpdGVfdXJsJ10uJy8nLiRhdHRzWydpZCddIDogZmFsc2U7CiAgICAgIGJyZWFrOwoK
ICAgIGNhc2UgJ2lzZ2QnOgoKICAgICAgJHUgPSAnaHR0cDovL2lzLmdkL2FwaS5waHA/bG9u
Z3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BU
X1VSTCwgJHUpOwoKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMoJGNoKTsKICAgICAgaWYg
KCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewogICAgICAgIHJldHVybiAk
dGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2VyX2Vycm9yKCdhcmNfdHdp
dHRlciBmYWlsZWQgdG8gZ2V0IGEgaXMuZ2QgVVJMIGZvciAnCiAgICAgICAgICAgIC4kdXJs
LEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQogICAgICBicmVhazsKCiAgICBjYXNlICd0aW55
dXJsJzogZGVmYXVsdDogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1c2luZyBUaW55VVJM
CgogICAgICAkdSA9ICdodHRwOi8vdGlueXVybC5jb20vYXBpLWNyZWF0ZS5waHA/dXJsPScu
dXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAk
dSk7CiAgICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVy
bCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7
CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFp
bGVkIHRvIGdldCBhIFRpbnlVUkwgZm9yICcuJHVybCxFX1VTRVJfV0FSTklORyk7CiAgICAg
IH0KCiAgfQoKICByZXR1cm4gZmFsc2U7IC8vIGZhaWwKCn0KCi8qCiAqIFNob3J0ZW5lZCBV
UkwgcmVkaXJlY3QgYmFzZWQgb24gc21kX3Nob3J0X3VybAogKi8KZnVuY3Rpb24gYXJjX3No
b3J0X3VybF9yZWRpcmVjdCgkZXZlbnQsICRzdGVwKSB7CiAgZ2xvYmFsICRwcmVmczsKCiAg
JGhhdmVfaWQgPSAwOwoKICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBhdmFpbGFibGUgc2hv
cnQgc2l0ZSB1cmwgYW5kIGlmIGl0IGlzIGJlaW5nIHVzZWQgaW4KICAvLyB0aGlzIGluc3Rh
bmNlCiAgJHNob3J0X3NpdGVfdXJsID0gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXTsK
ICBpZiAoJHNob3J0X3NpdGVfdXJsKSB7CiAgICAkc2hvcnRfc2l0ZV91cmwgPSBQUk9UT0NP
TC4kc2hvcnRfc2l0ZV91cmwuJy8nOwogICAgJHVybF9wYXJ0cyA9IHBhcnNlX3VybCgkc2hv
cnRfc2l0ZV91cmwpOwogICAgJHJlID0gJyNeJy4kdXJsX3BhcnRzWydwYXRoJ10uJyhbMC05
XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVnX21hdGNoKCRyZSwgJF9TRVJWRVJbJ1JFUVVF
U1RfVVJJJ10sICRtKTsKICB9CgogIC8vIEZhbGwgYmFjayB0byBzdGFuZGFyZCBzaXRlIHVy
bCAoc21kX3Nob3J0X3VybCBiZWhhdmlvdXIpCiAgaWYgKCRoYXZlX2lkKSB7CiAgICAkdXJs
X3BhcnRzID0gcGFyc2VfdXJsKGh1KTsKICAgICRyZSA9ICcjXicuJHVybF9wYXJ0c1sncGF0
aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRjaCgkcmUsICRfU0VS
VkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBEbyB0aGUgcmVkaXJlY3QgaWYg
d2UndmUgZ290IGFuIGFydGljbGUgaWQKICBpZiAoJGhhdmVfaWQpIHsKICAgICRpZCA9ICRt
WzFdOwogICAgJHBlcm1saW5rID0gcGVybWxpbmt1cmxfaWQoJGlkKTsKCiAgICBpZiAoJHBl
cm1saW5rKSB7CiAgICAgIG9iX2VuZF9jbGVhbigpOwoKICAgICAgLy8gU3R1cGlkLCBvdmVy
IHRoZSB0b3AgaGVhZGVyIHNldHRpbmcgZm9yIElFCiAgICAgIGhlYWRlcigiU3RhdHVzOiAz
MDEiKTsKICAgICAgaGVhZGVyKCJIVFRQLzEuMCAzMDEgTW92ZWQgUGVybWFuZW50bHkiKTsK
ICAgICAgaGVhZGVyKCJMb2NhdGlvbjogIi4kcGVybWxpbmssIFRSVUUsIDMwMSk7CgogICAg
ICAvLyBJbiBjYXNlIHRoZSBoZWFkZXIoKSBtZXRob2QgZmFpbHMsIGZhbGwgYmFjayBvbiBh
IGNsYXNzaWMgcmVkaXJlY3QKICAgICAgZWNobyAnPGh0bWw+PGhlYWQ+PE1FVEEgSFRUUC1F
UVVJVj0iUmVmcmVzaCIgQ09OVEVOVD0iMDtVUkw9JwogICAgICAgIC4kcGVybWxpbmsuJyI+
PC9oZWFkPjxib2R5PjwvYm9keT48L2h0bWw+JzsKICAgICAgZGllKCk7CiAgICB9CiAgfQoK
fQoKLy8gQXV0byBlbmFibGUgcGx1Z2luIG9uIGluc3RhbGwgKG9yaWdpbmFsIGlkZWEgYnkg
TWljaGFlbCBNYW5mcmUpCmZ1bmN0aW9uIF9hcmNfdHdpdHRlcl9hdXRvX2VuYWJsZSgkZXZl
bnQsICRzdGVwLCAkcHJlZml4PSdhcmNfdHdpdHRlcicpCnsKICAkcGx1Z2luID0gc3Vic3Ry
KCRldmVudCwgc3RybGVuKCdwbHVnaW5fbGlmZWN5Y2xlLicpKTsKICBpZiAoc3RybmNtcCgk
cGx1Z2luLCAkcHJlZml4LCBzdHJsZW4oJHByZWZpeCkpID09IDApCiAgewogICAgc2FmZV91
cGRhdGUoJ3R4cF9wbHVnaW4nLCAic3RhdHVzID0gMSIsICJuYW1lID0gJyIgLiBkb1NsYXNo
KCRwbHVnaW4pIC4gIiciKTsKICB9Cn0KCi8qCiAqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
CiovCgpjbGFzcyBhcmNfdHdpdHRlciBleHRlbmRzIFR3aXR0ZXJPQXV0aCB7CiAgICAvLyBD
YWNoaW5nIHZhcmlhYmxlcwogICAgcHJpdmF0ZSAkX2NhY2hlID0gdHJ1ZTsKICAgIHByaXZh
dGUgJF9jYWNoZV9kaXIgPSAnLi90bXAnOwogICAgcHJpdmF0ZSAkX2NhY2hlX3RpbWUgPSAx
ODAwOyAvLyAzMCBtaW51dGUgY2FjaGUKCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29u
c3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxMCiAgICAg
ICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkKICAgIHsKICAgICAgICBwYXJlbnQ6
Ol9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRvYXV0aF90
b2tlbgogICAgICAgICAgICAsICRvYXV0aF90b2tlbl9zZWNyZXQpOwogICAgICAgICR0aGlz
LT5mb3JtYXQgPSAnanNvbic7CiAgICAgICAgJHRoaXMtPnRpbWVvdXQgPSAxNTsKICAgICAg
ICAkdGhpcy0+Y29ubmVjdHRpbWVvdXQgPSAxNTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rp
b24gY2FsbGJhY2tVUkwoJGV2ZW50LCRzdGVwKQogICAgewogICAgICAgIHJldHVybiBwcmVn
X3JlcGxhY2UoJy9cPy4qLycsICcnLFBST1RPQ09MLiRfU0VSVkVSWydTRVJWRVJfTkFNRSdd
LiRfU0VSVkVSWydSRVFVRVNUX1VSSSddKQogICAgICAgICAgLic/ZXZlbnQ9Jy4kZXZlbnQu
JyZhbXA7c3RlcD0nLiRzdGVwOwogICAgfQoKICAgIC8vIGNyZWF0ZSBUd2l0dGVyIGFuZCBl
eHRlcm5hbCBsaW5rcyBpbiB0ZXh0CiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIG1ha2VM
aW5rcygkdGV4dCkKICAgIHsKICAgICAgICAkdXJsID0gJy9cYihodHRwfGh0dHBzfGZ0cCk6
XC9cLyhbQS1aMC05XVtBLVowLTlfLV0qKD86XC5bQS1aMC05XVtBLVowLTlfLV0qKSspOj8o
XGQrKT9cLz8oW1wvXHcrXC5dKylcYi9pJzsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFj
ZSgkdXJsLCAiPGEgaHJlZj0nJDAnIHJlbD0nZXh0ZXJuYWwnPiQwPC9hPiIsICR0ZXh0KTsK
ICAgICAgICAkdXJsID0gJy9cYihefFxzKXd3dy4oW2Etel9BLVowLTldKykoKFwuW2Etel0r
KSspXGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9
J2h0dHA6Ly93d3cuJDIkMycgcmVsPSdleHRlcm5hbCc+d3d3LiQyJDM8L2E+IiwgJHRleHQp
OwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMpLj9AKFthLXpfQS1aMC05
XSspLyIsCiAgICAgICAgICAgICIkMUA8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vJDIn
IHJlbD0nZXh0ZXJuYWwnPiQyPC9hPiIsJHRleHQpOwogICAgICAgICR0ZXh0ID0gcHJlZ19y
ZXBsYWNlKCIvKF58XHMpKFwjKFthLXpfQS1aMC05Ol8tXSspKS8iLAogICAgICAgICAgICAi
JDE8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vc2VhcmNoP3E9JTIzJDMnIHJlbD0nZXh0
ZXJuYWwnPiQyPC9hPiIsJHRleHQpOwogICAgICAgIHJldHVybiAkdGV4dDsKICB9CgogICAg
cHVibGljIGZ1bmN0aW9uIGdldCgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAg
ICAgICAkYXBpX3VybCA9IG1kNSgkdXJsLnVybGVuY29kZShzZXJpYWxpemUoJHBhcmFtcykp
KTsKICAgICAgICAkZGF0YSA9ICcnOwoKICAgICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAv
LyBjaGVjayBmb3IgY2FjaGVkIGpzb24KCiAgICAgICAgICAgICRkYXRhID0gJHRoaXMtPl9y
ZXRyaWV2ZUNhY2hlKCRhcGlfdXJsKTsKCiAgICAgICAgfQogICAgICAgIGlmIChlbXB0eSgk
ZGF0YSkpIHsKICAgICAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmdldCgkdXJsLCAkcGFyYW1z
KTsgLy8gZGF0YSBhbHJlYWR5IGpzb25fZGVjb2RlJ2QKICAgICAgICAgICAgaWYgKCR0aGlz
LT5odHRwX2NvZGU9PT0yMDAgJiYgJGVuY29kZWRfZGF0YT1qc29uX2VuY29kZSgkZGF0YSkp
IHsgLy8gc2F2ZSBjYWNoZQogICAgICAgICAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hl
X2Rpci4nLycuJGFwaV91cmw7CiAgICAgICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygk
ZmlsZSwkZW5jb2RlZF9kYXRhLExPQ0tfRVgpOwogICAgICAgICAgICAgICAgcmV0dXJuICRk
YXRhOwogICAgICAgICAgICB9IGVsc2UgeyAvLyBmYWlsZWQgdG8gcmV0cmlldmUgZGF0YSBm
cm9tIFR3aXR0ZXIKCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBh
dHRlbXB0IHRvIGZvcmNlIGNhY2hlZCBqc29uIHJldHVybgoKICAgICAgICAgICAgICAgICAg
ICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCx0cnVlKTsKICAgICAg
ICAgICAgICAgICAgICBpZiAoJGRhdGEpIHJldHVybiBqc29uX2RlY29kZSgkZGF0YSk7Cgog
ICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAg
ICAgICAgIH0KICAgICAgICB9IGVsc2UgeyAvLyByZXR1cm4gY2FjaGVkIGpzb24KICAgICAg
ICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRkYXRhKTsKICAgICAgICB9CiAgICB9IC8vZW5k
IGdldCgpCgogICAgZnVuY3Rpb24gcG9zdCgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAg
IHsKICAgICAgICAkZGF0YSA9IHBhcmVudDo6cG9zdCgkdXJsLCRwYXJhbXMpOwogICAgICAg
IHJldHVybiAkZGF0YTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxldGUoJHVybCwgJHBhcmFt
cyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmRlbGV0ZSgkdXJs
LCRwYXJhbXMpOwogICAgICAgIHJldHVybiAkZGF0YTsKICAgIH0KCiAgICAvLyBDYWNoZSBt
ZXRob2RzCgogICAgcHVibGljIGZ1bmN0aW9uIHNldENhY2hpbmcoJGNhY2hlPXRydWUpCiAg
ICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZSA9ICgkY2FjaGUpID8gdHJ1ZSA6IGZhbHNlOwog
ICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZURp
cigkbG9jKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfZGlyID0gJGxvYzsKICAgICAg
ICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVUaW1lKCRt
aW5zKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfdGltZSA9ICRtaW5zKjYwOyAvLyBj
b252ZXJ0IG1pbnV0ZXMgaW50byBzZWNvbmRzCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9
CgogICAgcHJpdmF0ZSBmdW5jdGlvbiBfcmV0cmlldmVDYWNoZSgkdXJsLCRvdmVyaWRlX3Rp
bWVvdXQ9ZmFsc2UpCiAgICB7CiAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4n
LycuJHVybDsKICAgICAgICBpZiAoZmlsZV9leGlzdHMoJGZpbGUpKSB7CgogICAgICAgICAg
ICAkZGlmZiA9IHRpbWUoKSAtIGZpbGVtdGltZSgkZmlsZSk7CiAgICAgICAgICAgIGlmICgk
b3ZlcmlkZV90aW1lb3V0IHx8ICRkaWZmIDwgJHRoaXMtPl9jYWNoZV90aW1lKSB7CiAgICAg
ICAgICAgICAgICByZXR1cm4gZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOwogICAgICAgICAg
ICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9
CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9
CiAgICB9Cn0KCi8qCiAqIEFicmFoYW0gV2lsbGlhbXMgKGFicmFoYW1AYWJyYWguYW0pIGh0
dHA6Ly9hYnJhaC5hbQogKgogKiBUaGUgZmlyc3QgUEhQIExpYnJhcnkgdG8gc3VwcG9ydCBP
QXV0aCBmb3IgVHdpdHRlcidzIFJFU1QgQVBJLgogKi8KCi8qKgogKiBUd2l0dGVyIE9BdXRo
IGNsYXNzCiAqLwpjbGFzcyBUd2l0dGVyT0F1dGggewogIC8qIENvbnRhaW5zIHRoZSBsYXN0
IEhUVFAgc3RhdHVzIGNvZGUgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2NvZGU7CiAg
LyogQ29udGFpbnMgdGhlIGxhc3QgQVBJIGNhbGwuICovCiAgcHVibGljICR1cmw7CiAgLyog
U2V0IHVwIHRoZSBBUEkgcm9vdCBVUkwuICovCiAgcHVibGljICRob3N0ID0gImh0dHBzOi8v
YXBpLnR3aXR0ZXIuY29tLzEuMS8iOwogIC8qIFNldCB0aW1lb3V0IGRlZmF1bHQuICovCiAg
cHVibGljICR0aW1lb3V0ID0gMzA7CiAgLyogU2V0IGNvbm5lY3QgdGltZW91dC4gKi8KICBw
dWJsaWMgJGNvbm5lY3R0aW1lb3V0ID0gMzA7CiAgLyogVmVyaWZ5IFNTTCBDZXJ0LiAqLwog
IHB1YmxpYyAkc3NsX3ZlcmlmeXBlZXIgPSBGQUxTRTsKICAvKiBSZXNwb25zIGZvcm1hdC4g
Ki8KICBwdWJsaWMgJGZvcm1hdCA9ICdqc29uJzsKICAvKiBEZWNvZGUgcmV0dXJuZWQganNv
biBkYXRhLiAqLwogIHB1YmxpYyAkZGVjb2RlX2pzb24gPSBUUlVFOwogIC8qIENvbnRhaW5z
IHRoZSBsYXN0IEhUVFAgaGVhZGVycyByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfaW5m
bzsKICAvKiBTZXQgdGhlIHVzZXJhZ25ldC4gKi8KICBwdWJsaWMgJHVzZXJhZ2VudCA9ICdU
d2l0dGVyT0F1dGggdjAuMi4wLWJldGEyJzsKICAvKiBJbW1lZGlhdGVseSByZXRyeSB0aGUg
QVBJIGNhbGwgaWYgdGhlIHJlc3BvbnNlIHdhcyBub3Qgc3VjY2Vzc2Z1bC4gKi8KICAvL3B1
YmxpYyAkcmV0cnkgPSBUUlVFOwoKICAvKioKICAgKiBTZXQgQVBJIFVSTFMKICAgKi8KICBm
dW5jdGlvbiBhY2Nlc3NUb2tlblVSTCgpICB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRl
ci5jb20vb2F1dGgvYWNjZXNzX3Rva2VuJzsgfQogIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVS
TCgpIHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9hdXRoZW50aWNh
dGUnOyB9CiAgZnVuY3Rpb24gYXV0aG9yaXplVVJMKCkgICAgeyByZXR1cm4gJ2h0dHBzOi8v
YXBpLnR3aXR0ZXIuY29tL29hdXRoL2F1dGhvcml6ZSc7IH0KICBmdW5jdGlvbiByZXF1ZXN0
VG9rZW5VUkwoKSB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvcmVx
dWVzdF90b2tlbic7IH0KCiAgLyoqCiAgICogRGVidWcgaGVscGVycwogICAqLwogIGZ1bmN0
aW9uIGxhc3RTdGF0dXNDb2RlKCkgeyByZXR1cm4gJHRoaXMtPmh0dHBfc3RhdHVzOyB9CiAg
ZnVuY3Rpb24gbGFzdEFQSUNhbGwoKSB7IHJldHVybiAkdGhpcy0+bGFzdF9hcGlfY2FsbDsg
fQoKICAvKioKICAgKiBjb25zdHJ1Y3QgVHdpdHRlck9BdXRoIG9iamVjdAogICAqLwogIGZ1
bmN0aW9uIF9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRv
YXV0aF90b2tlbiA9IE5VTEwsICRvYXV0aF90b2tlbl9zZWNyZXQgPSBOVUxMKSB7CiAgICAk
dGhpcy0+c2hhMV9tZXRob2QgPSBuZXcgT0F1dGhTaWduYXR1cmVNZXRob2RfSE1BQ19TSEEx
KCk7CiAgICAkdGhpcy0+Y29uc3VtZXIgPSBuZXcgT0F1dGhDb25zdW1lcigkY29uc3VtZXJf
a2V5LCAkY29uc3VtZXJfc2VjcmV0KTsKICAgIGlmICghZW1wdHkoJG9hdXRoX3Rva2VuKSAm
JiAhZW1wdHkoJG9hdXRoX3Rva2VuX3NlY3JldCkpIHsKICAgICAgJHRoaXMtPnRva2VuID0g
bmV3IE9BdXRoQ29uc3VtZXIoJG9hdXRoX3Rva2VuLCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsK
ICAgIH0gZWxzZSB7CiAgICAgICR0aGlzLT50b2tlbiA9IE5VTEw7CiAgICB9CiAgfQoKCiAg
LyoqCiAgICogR2V0IGEgcmVxdWVzdF90b2tlbiBmcm9tIFR3aXR0ZXIKICAgKgogICAqIEBy
ZXR1cm5zIGEga2V5L3ZhbHVlIGFycmF5IGNvbnRhaW5pbmcgb2F1dGhfdG9rZW4gYW5kIG9h
dXRoX3Rva2VuX3NlY3JldAogICAqLwogIGZ1bmN0aW9uIGdldFJlcXVlc3RUb2tlbigkb2F1
dGhfY2FsbGJhY2spIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRwYXJhbWV0
ZXJzWydvYXV0aF9jYWxsYmFjayddID0gJG9hdXRoX2NhbGxiYWNrOwogICAgJHJlcXVlc3Qg
PSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5yZXF1ZXN0VG9rZW5VUkwoKSwgJ0dFVCcs
ICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVy
cygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9r
ZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAg
cmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdldCB0aGUgYXV0aG9yaXplIFVSTAog
ICAqCiAgICogQHJldHVybnMgYSBzdHJpbmcKICAgKi8KICBmdW5jdGlvbiBnZXRBdXRob3Jp
emVVUkwoJHRva2VuLCAkc2lnbl9pbl93aXRoX3R3aXR0ZXIgPSBUUlVFKSB7CiAgICBpZiAo
aXNfYXJyYXkoJHRva2VuKSkgewogICAgICAkdG9rZW4gPSAkdG9rZW5bJ29hdXRoX3Rva2Vu
J107CiAgICB9CiAgICBpZiAoZW1wdHkoJHNpZ25faW5fd2l0aF90d2l0dGVyKSkgewogICAg
ICByZXR1cm4gJHRoaXMtPmF1dGhvcml6ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2Vu
fSI7CiAgICB9IGVsc2UgewogICAgICAgcmV0dXJuICR0aGlzLT5hdXRoZW50aWNhdGVVUkwo
KSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfQogIH0KCiAgLyoqCiAgICogRXhj
aGFuZ2UgcmVxdWVzdCB0b2tlbiBhbmQgc2VjcmV0IGZvciBhbiBhY2Nlc3MgdG9rZW4gYW5k
CiAgICogc2VjcmV0LCB0byBzaWduIEFQSSBjYWxscy4KICAgKgogICAqIEByZXR1cm5zIGFy
cmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAg
ICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAg
ICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAg
ICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIikKICAgKi8KICBmdW5jdGlvbiBn
ZXRBY2Nlc3NUb2tlbigkb2F1dGhfdmVyaWZpZXIpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJy
YXkoKTsKICAgICRwYXJhbWV0ZXJzWydvYXV0aF92ZXJpZmllciddID0gJG9hdXRoX3Zlcmlm
aWVyOwogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NU
b2tlblVSTCgpLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGls
OjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBP
QXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tl
bl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogT25lIHRp
bWUgZXhjaGFuZ2Ugb2YgdXNlcm5hbWUgYW5kIHBhc3N3b3JkIGZvciBhY2Nlc3MgdG9rZW4g
YW5kIHNlY3JldC4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4g
InRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tlbl9z
ZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAgInVz
ZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25hbWUi
ID0+ICJhYnJhaGFtIiwKICAgKiAgICAgICAgICAgICAgICAieF9hdXRoX2V4cGlyZXMiID0+
ICIwIikKICAgKi8KICBmdW5jdGlvbiBnZXRYQXV0aFRva2VuKCR1c2VybmFtZSwgJHBhc3N3
b3JkKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1sneF9h
dXRoX3VzZXJuYW1lJ10gPSAkdXNlcm5hbWU7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3Bh
c3N3b3JkJ10gPSAkcGFzc3dvcmQ7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX21vZGUnXSA9
ICdjbGllbnRfYXV0aCc7CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRo
aXMtPmFjY2Vzc1Rva2VuVVJMKCksICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2Vu
ID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50
b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2Vu
WydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoq
CiAgICogR0VUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBn
ZXQoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhp
cy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRo
aXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICBy
ZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9u
c2U7CiAgfQoKICAvKioKICAgKiBQT1NUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAg
Ki8KICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAg
JHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnUE9TVCcsICRwYXJhbWV0
ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29k
ZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQog
ICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIERFTEVURSB3cmFwcGVyIGZv
ciBvQXV0aFJlcWV1c3QuCiAgICovCiAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbWV0
ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgk
dXJsLCAnREVMRVRFJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09
ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVj
b2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoq
CiAgICogRm9ybWF0IGFuZCBzaWduIGFuIE9BdXRoIC8gQVBJIHJlcXVlc3QKICAgKi8KICBm
dW5jdGlvbiBvQXV0aFJlcXVlc3QoJHVybCwgJG1ldGhvZCwgJHBhcmFtZXRlcnMpIHsKICAg
IGlmIChzdHJycG9zKCR1cmwsICdodHRwczovLycpICE9PSAwICYmIHN0cnJwb3MoJHVybCwg
J2h0dHA6Ly8nKSAhPT0gMCkgewogICAgICAkdXJsID0gInskdGhpcy0+aG9zdH17JHVybH0u
eyR0aGlzLT5mb3JtYXR9IjsKICAgIH0KICAgICRyZXF1ZXN0ID0gT0F1dGhSZXF1ZXN0Ojpm
cm9tX2NvbnN1bWVyX2FuZF90b2tlbigkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbiwg
JG1ldGhvZCwgJHVybCwgJHBhcmFtZXRlcnMpOwogICAgJHJlcXVlc3QtPnNpZ25fcmVxdWVz
dCgkdGhpcy0+c2hhMV9tZXRob2QsICR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRva2VuKTsK
ICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnR0VUJzoKICAgICAgcmV0dXJuICR0
aGlzLT5odHRwKCRyZXF1ZXN0LT50b191cmwoKSwgJ0dFVCcpOwogICAgZGVmYXVsdDoKICAg
ICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0LT5nZXRfbm9ybWFsaXplZF9odHRwX3Vy
bCgpLCAkbWV0aG9kLCAkcmVxdWVzdC0+dG9fcG9zdGRhdGEoKSk7CiAgICB9CiAgfQoKICAv
KioKICAgKiBNYWtlIGFuIEhUVFAgcmVxdWVzdAogICAqCiAgICogQHJldHVybiBBUEkgcmVz
dWx0cwogICAqLwogIGZ1bmN0aW9uIGh0dHAoJHVybCwgJG1ldGhvZCwgJHBvc3RmaWVsZHMg
PSBOVUxMKSB7CiAgICAkdGhpcy0+aHR0cF9pbmZvID0gYXJyYXkoKTsKICAgICRjaSA9IGN1
cmxfaW5pdCgpOwogICAgLyogQ3VybCBzZXR0aW5ncyAqLwogICAgY3VybF9zZXRvcHQoJGNp
LCBDVVJMT1BUX1VTRVJBR0VOVCwgJHRoaXMtPnVzZXJhZ2VudCk7CiAgICBjdXJsX3NldG9w
dCgkY2ksIENVUkxPUFRfQ09OTkVDVFRJTUVPVVQsICR0aGlzLT5jb25uZWN0dGltZW91dCk7
CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVElNRU9VVCwgJHRoaXMtPnRpbWVvdXQp
OwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCBUUlVFKTsK
ICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IVFRQSEVBREVSLCBhcnJheSgnRXhwZWN0
OicpKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgJHRo
aXMtPnNzbF92ZXJpZnlwZWVyKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFE
RVJGVU5DVElPTiwgYXJyYXkoJHRoaXMsICdnZXRIZWFkZXInKSk7CiAgICBjdXJsX3NldG9w
dCgkY2ksIENVUkxPUFRfSEVBREVSLCBGQUxTRSk7CgogICAgc3dpdGNoICgkbWV0aG9kKSB7
CiAgICAgIGNhc2UgJ1BPU1QnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9Q
T1NULCBUUlVFKTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAg
ICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0ZmllbGRzKTsK
ICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0RFTEVURSc6CiAgICAgICAg
Y3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NVU1RPTVJFUVVFU1QsICdERUxFVEUnKTsKICAg
ICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgJHVybCA9ICJ7JHVy
bH0/eyRwb3N0ZmllbGRzfSI7CiAgICAgICAgfQogICAgfQoKICAgIGN1cmxfc2V0b3B0KCRj
aSwgQ1VSTE9QVF9VUkwsICR1cmwpOwogICAgJHJlc3BvbnNlID0gY3VybF9leGVjKCRjaSk7
CiAgICAkdGhpcy0+aHR0cF9jb2RlID0gY3VybF9nZXRpbmZvKCRjaSwgQ1VSTElORk9fSFRU
UF9DT0RFKTsKICAgICR0aGlzLT5odHRwX2luZm8gPSBhcnJheV9tZXJnZSgkdGhpcy0+aHR0
cF9pbmZvLCBjdXJsX2dldGluZm8oJGNpKSk7CiAgICAkdGhpcy0+dXJsID0gJHVybDsKICAg
IGN1cmxfY2xvc2UgKCRjaSk7CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAg
ICogR2V0IHRoZSBoZWFkZXIgaW5mbyB0byBzdG9yZS4KICAgKi8KICBmdW5jdGlvbiBnZXRI
ZWFkZXIoJGNoLCAkaGVhZGVyKSB7CiAgICAkaSA9IHN0cnBvcygkaGVhZGVyLCAnOicpOwog
ICAgaWYgKCFlbXB0eSgkaSkpIHsKICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKCctJywgJ18n
LCBzdHJ0b2xvd2VyKHN1YnN0cigkaGVhZGVyLCAwLCAkaSkpKTsKICAgICAgJHZhbHVlID0g
dHJpbShzdWJzdHIoJGhlYWRlciwgJGkgKyAyKSk7CiAgICAgICR0aGlzLT5odHRwX2hlYWRl
clska2V5XSA9ICR2YWx1ZTsKICAgIH0KICAgIHJldHVybiBzdHJsZW4oJGhlYWRlcik7CiAg
fQp9Ci8qIEdlbmVyaWMgZXhjZXB0aW9uIGNsYXNzCiAqLwppZiAoIWNsYXNzX2V4aXN0cygn
T0F1dGhFeGNlcHRpb24nKSkgewogIGNsYXNzIE9BdXRoRXhjZXB0aW9uIGV4dGVuZHMgRXhj
ZXB0aW9uIHsKICAgIC8vIHBhc3MKICB9Cn0KCmNsYXNzIE9BdXRoQ29uc3VtZXIgewogIHB1
YmxpYyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoKICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgk
a2V5LCAkc2VjcmV0LCAkY2FsbGJhY2tfdXJsPU5VTEwpIHsKICAgICR0aGlzLT5rZXkgPSAk
a2V5OwogICAgJHRoaXMtPnNlY3JldCA9ICRzZWNyZXQ7CiAgICAkdGhpcy0+Y2FsbGJhY2tf
dXJsID0gJGNhbGxiYWNrX3VybDsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAg
ICByZXR1cm4gIk9BdXRoQ29uc3VtZXJba2V5PSR0aGlzLT5rZXksc2VjcmV0PSR0aGlzLT5z
ZWNyZXRdIjsKICB9Cn0KCmNsYXNzIE9BdXRoVG9rZW4gewogIC8vIGFjY2VzcyB0b2tlbnMg
YW5kIHJlcXVlc3QgdG9rZW5zCiAgcHVibGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7Cgog
IC8qKgogICAqIGtleSA9IHRoZSB0b2tlbgogICAqIHNlY3JldCA9IHRoZSB0b2tlbiBzZWNy
ZXQKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgka2V5LCAkc2VjcmV0KSB7CiAgICAk
dGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0OwogIH0KCiAg
LyoqCiAgICogZ2VuZXJhdGVzIHRoZSBiYXNpYyBzdHJpbmcgc2VyaWFsaXphdGlvbiBvZiBh
IHRva2VuIHRoYXQgYSBzZXJ2ZXIKICAgKiB3b3VsZCByZXNwb25kIHRvIHJlcXVlc3RfdG9r
ZW4gYW5kIGFjY2Vzc190b2tlbiBjYWxscyB3aXRoCiAgICovCiAgZnVuY3Rpb24gdG9fc3Ry
aW5nKCkgewogICAgcmV0dXJuICJvYXV0aF90b2tlbj0iIC4KICAgICAgICAgICBPQXV0aFV0
aWw6OnVybGVuY29kZV9yZmMzOTg2KCR0aGlzLT5rZXkpIC4KICAgICAgICAgICAiJm9hdXRo
X3Rva2VuX3NlY3JldD0iIC4KICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMz
OTg2KCR0aGlzLT5zZWNyZXQpOwogIH0KCiAgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAg
IHJldHVybiAkdGhpcy0+dG9fc3RyaW5nKCk7CiAgfQp9CgovKioKICogQSBjbGFzcyBmb3Ig
aW1wbGVtZW50aW5nIGEgU2lnbmF0dXJlIE1ldGhvZAogKiBTZWUgc2VjdGlvbiA5ICgiU2ln
bmluZyBSZXF1ZXN0cyIpIGluIHRoZSBzcGVjCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0aFNp
Z25hdHVyZU1ldGhvZCB7CiAgLyoqCiAgICogTmVlZHMgdG8gcmV0dXJuIHRoZSBuYW1lIG9m
IHRoZSBTaWduYXR1cmUgTWV0aG9kIChpZSBITUFDLVNIQTEpCiAgICogQHJldHVybiBzdHJp
bmcKICAgKi8KICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKTsKCiAgLyoq
CiAgICogQnVpbGQgdXAgdGhlIHNpZ25hdHVyZQogICAqIE5PVEU6IFRoZSBvdXRwdXQgb2Yg
dGhpcyBmdW5jdGlvbiBNVVNUIE5PVCBiZSB1cmxlbmNvZGVkLgogICAqIHRoZSBlbmNvZGlu
ZyBpcyBoYW5kbGVkIGluIE9BdXRoUmVxdWVzdCB3aGVuIHRoZSBmaW5hbAogICAqIHJlcXVl
c3QgaXMgc2VyaWFsaXplZAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QKICAg
KiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhUb2tl
biAkdG9rZW4KICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwogIGFic3RyYWN0IHB1YmxpYyBm
dW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsK
CiAgLyoqCiAgICogVmVyaWZpZXMgdGhhdCBhIGdpdmVuIHNpZ25hdHVyZSBpcyBjb3JyZWN0
CiAgICogQHBhcmFtIE9BdXRoUmVxdWVzdCAkcmVxdWVzdAogICAqIEBwYXJhbSBPQXV0aENv
bnN1bWVyICRjb25zdW1lcgogICAqIEBwYXJhbSBPQXV0aFRva2VuICR0b2tlbgogICAqIEBw
YXJhbSBzdHJpbmcgJHNpZ25hdHVyZQogICAqIEByZXR1cm4gYm9vbAogICAqLwogIHB1Ymxp
YyBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2Vu
LCAkc2lnbmF0dXJlKSB7CiAgICAkYnVpbHQgPSAkdGhpcy0+YnVpbGRfc2lnbmF0dXJlKCRy
ZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gJGJ1aWx0ID09ICRzaWdu
YXR1cmU7CiAgfQp9CgovKioKICogVGhlIEhNQUMtU0hBMSBzaWduYXR1cmUgbWV0aG9kIHVz
ZXMgdGhlIEhNQUMtU0hBMSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQgaW4gW1JG
QzIxMDRdCiAqIHdoZXJlIHRoZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcgaXMgdGhlIHRleHQg
YW5kIHRoZSBrZXkgaXMgdGhlIGNvbmNhdGVuYXRlZCB2YWx1ZXMgKGVhY2ggZmlyc3QKICog
ZW5jb2RlZCBwZXIgUGFyYW1ldGVyIEVuY29kaW5nKSBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0
IGFuZCBUb2tlbiBTZWNyZXQsIHNlcGFyYXRlZCBieSBhbiAnJicKICogY2hhcmFjdGVyIChB
U0NJSSBjb2RlIDM4KSBldmVuIGlmIGVtcHR5LgogKiAgIC0gQ2hhcHRlciA5LjIgKCJITUFD
LVNIQTEiKQogKi8KY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfSE1BQ19TSEExIGV4dGVu
ZHMgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAg
cmV0dXJuICJITUFDLVNIQTEiOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25h
dHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRiYXNlX3N0cmluZyA9
ICRyZXF1ZXN0LT5nZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CiAgICAkcmVxdWVzdC0+
YmFzZV9zdHJpbmcgPSAkYmFzZV9zdHJpbmc7CgogICAgJGtleV9wYXJ0cyA9IGFycmF5KAog
ICAgICAkY29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0b2tlbikgPyAkdG9rZW4tPnNlY3Jl
dCA6ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9y
ZmMzOTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGltcGxvZGUoJyYnLCAka2V5X3BhcnRz
KTsKCiAgICByZXR1cm4gYmFzZTY0X2VuY29kZShoYXNoX2htYWMoJ3NoYTEnLCAkYmFzZV9z
dHJpbmcsICRrZXksIHRydWUpKTsKICB9Cn0KCi8qKgogKiBUaGUgUExBSU5URVhUIG1ldGhv
ZCBkb2VzIG5vdCBwcm92aWRlIGFueSBzZWN1cml0eSBwcm90ZWN0aW9uIGFuZCBTSE9VTEQg
b25seSBiZSB1c2VkCiAqIG92ZXIgYSBzZWN1cmUgY2hhbm5lbCBzdWNoIGFzIEhUVFBTLiBJ
dCBkb2VzIG5vdCB1c2UgdGhlIFNpZ25hdHVyZSBCYXNlIFN0cmluZy4KICogICAtIENoYXB0
ZXIgOS40ICgiUExBSU5URVhUIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX1BM
QUlOVEVYVCBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVuY3Rp
b24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlBMQUlOVEVYVCI7CiAgfQoKICAvKioKICAg
KiBvYXV0aF9zaWduYXR1cmUgaXMgc2V0IHRvIHRoZSBjb25jYXRlbmF0ZWQgZW5jb2RlZCB2
YWx1ZXMgb2YgdGhlIENvbnN1bWVyIFNlY3JldCBhbmQKICAgKiBUb2tlbiBTZWNyZXQsIHNl
cGFyYXRlZCBieSBhICcmJyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpLCBldmVuIGlmIGVp
dGhlciBzZWNyZXQgaXMKICAgKiBlbXB0eS4gVGhlIHJlc3VsdCBNVVNUIGJlIGVuY29kZWQg
YWdhaW4uCiAgICogICAtIENoYXB0ZXIgOS40LjEgKCJHZW5lcmF0aW5nIFNpZ25hdHVyZXMi
KQogICAqCiAgICogUGxlYXNlIG5vdGUgdGhhdCB0aGUgc2Vjb25kIGVuY29kaW5nIE1VU1Qg
Tk9UIGhhcHBlbiBpbiB0aGUgU2lnbmF0dXJlTWV0aG9kLCBhcwogICAqIE9BdXRoUmVxdWVz
dCBoYW5kbGVzIHRoaXMhCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVy
ZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRrZXlfcGFydHMgPSBhcnJh
eSgKICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2VuLT5z
ZWNyZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNv
ZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtleV9w
YXJ0cyk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJpbmcgPSAka2V5OwoKICAgIHJldHVybiAk
a2V5OwogIH0KfQoKLyoqCiAqIFRoZSBSU0EtU0hBMSBzaWduYXR1cmUgbWV0aG9kIHVzZXMg
dGhlIFJTQVNTQS1QS0NTMS12MV81IHNpZ25hdHVyZSBhbGdvcml0aG0gYXMgZGVmaW5lZCBp
bgogKiBbUkZDMzQ0N10gc2VjdGlvbiA4LjIgKG1vcmUgc2ltcGx5IGtub3duIGFzIFBLQ1Mj
MSksIHVzaW5nIFNIQS0xIGFzIHRoZSBoYXNoIGZ1bmN0aW9uIGZvcgogKiBFTVNBLVBLQ1Mx
LXYxXzUuIEl0IGlzIGFzc3VtZWQgdGhhdCB0aGUgQ29uc3VtZXIgaGFzIHByb3ZpZGVkIGl0
cyBSU0EgcHVibGljIGtleSBpbiBhCiAqIHZlcmlmaWVkIHdheSB0byB0aGUgU2VydmljZSBQ
cm92aWRlciwgaW4gYSBtYW5uZXIgd2hpY2ggaXMgYmV5b25kIHRoZSBzY29wZSBvZiB0aGlz
CiAqIHNwZWNpZmljYXRpb24uCiAqICAgLSBDaGFwdGVyIDkuMyAoIlJTQS1TSEExIikKICov
CmFic3RyYWN0IGNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX1JTQV9TSEExIGV4dGVuZHMg
T0F1dGhTaWduYXR1cmVNZXRob2QgewogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpIHsK
ICAgIHJldHVybiAiUlNBLVNIQTEiOwogIH0KCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxl
bWVudCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEp
IGRvIGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2Yg
Y29uc3VtZXIKICAvLyAoMikgZmV0Y2ggdmlhIGh0dHAgdXNpbmcgYSB1cmwgcHJvdmlkZWQg
YnkgdGhlIHJlcXVlc3RlcgogIC8vICgzKSBzb21lIHNvcnQgb2Ygc3BlY2lmaWMgZGlzY292
ZXJ5IGNvZGUgYmFzZWQgb24gcmVxdWVzdAogIC8vCiAgLy8gRWl0aGVyIHdheSBzaG91bGQg
cmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjZXJ0aWZpY2F0ZQogIHBy
b3RlY3RlZCBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9wdWJsaWNfY2VydCgmJHJlcXVlc3Qp
OwoKICAvLyBVcCB0byB0aGUgU1AgdG8gaW1wbGVtZW50IHRoaXMgbG9va3VwIG9mIGtleXMu
IFBvc3NpYmxlIGlkZWFzIGFyZToKICAvLyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBv
ZiB0cnVzdGVkIGNlcnRzIGtleWVkIG9mZiBvZiBjb25zdW1lcgogIC8vCiAgLy8gRWl0aGVy
IHdheSBzaG91bGQgcmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjZXJ0
aWZpY2F0ZQogIHByb3RlY3RlZCBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9wcml2YXRlX2Nl
cnQoJiRyZXF1ZXN0KTsKCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVx
dWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0
LT5nZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJp
bmcgPSAkYmFzZV9zdHJpbmc7CgogICAgLy8gRmV0Y2ggdGhlIHByaXZhdGUga2V5IGNlcnQg
YmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3ByaXZhdGVf
Y2VydCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHJpdmF0ZSBrZXkgSUQgZnJvbSB0
aGUgY2VydGlmaWNhdGUKICAgICRwcml2YXRla2V5aWQgPSBvcGVuc3NsX2dldF9wcml2YXRl
a2V5KCRjZXJ0KTsKCiAgICAvLyBTaWduIHVzaW5nIHRoZSBrZXkKICAgICRvayA9IG9wZW5z
c2xfc2lnbigkYmFzZV9zdHJpbmcsICRzaWduYXR1cmUsICRwcml2YXRla2V5aWQpOwoKICAg
IC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHJp
dmF0ZWtleWlkKTsKCiAgICByZXR1cm4gYmFzZTY0X2VuY29kZSgkc2lnbmF0dXJlKTsKICB9
CgogIHB1YmxpYyBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1l
ciwgJHRva2VuLCAkc2lnbmF0dXJlKSB7CiAgICAkZGVjb2RlZF9zaWcgPSBiYXNlNjRfZGVj
b2RlKCRzaWduYXR1cmUpOwoKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5nZXRfc2ln
bmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CgogICAgLy8gRmV0Y2ggdGhlIHB1YmxpYyBrZXkgY2Vy
dCBiYXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhpcy0+ZmV0Y2hfcHVibGlj
X2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhlIHB1YmxpYyBrZXkgSUQgZnJvbSB0
aGUgY2VydGlmaWNhdGUKICAgICRwdWJsaWNrZXlpZCA9IG9wZW5zc2xfZ2V0X3B1YmxpY2tl
eSgkY2VydCk7CgogICAgLy8gQ2hlY2sgdGhlIGNvbXB1dGVkIHNpZ25hdHVyZSBhZ2FpbnN0
IHRoZSBvbmUgcGFzc2VkIGluIHRoZSBxdWVyeQogICAgJG9rID0gb3BlbnNzbF92ZXJpZnko
JGJhc2Vfc3RyaW5nLCAkZGVjb2RlZF9zaWcsICRwdWJsaWNrZXlpZCk7CgogICAgLy8gUmVs
ZWFzZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVuc3NsX2ZyZWVfa2V5KCRwdWJsaWNrZXlp
ZCk7CgogICAgcmV0dXJuICRvayA9PSAxOwogIH0KfQoKY2xhc3MgT0F1dGhSZXF1ZXN0IHsK
ICBwcml2YXRlICRwYXJhbWV0ZXJzOwogIHByaXZhdGUgJGh0dHBfbWV0aG9kOwogIHByaXZh
dGUgJGh0dHBfdXJsOwogIC8vIGZvciBkZWJ1ZyBwdXJwb3NlcwogIHB1YmxpYyAkYmFzZV9z
dHJpbmc7CiAgcHVibGljIHN0YXRpYyAkdmVyc2lvbiA9ICcxLjAnOwogIHB1YmxpYyBzdGF0
aWMgJFBPU1RfSU5QVVQgPSAncGhwOi8vaW5wdXQnOwoKICBmdW5jdGlvbiBfX2NvbnN0cnVj
dCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgQCRw
YXJhbWV0ZXJzIG9yICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRwYXJhbWV0ZXJzID0g
YXJyYXlfbWVyZ2UoIE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycyhwYXJzZV91cmwoJGh0
dHBfdXJsLCBQSFBfVVJMX1FVRVJZKSksICRwYXJhbWV0ZXJzKTsKICAgICR0aGlzLT5wYXJh
bWV0ZXJzID0gJHBhcmFtZXRlcnM7CiAgICAkdGhpcy0+aHR0cF9tZXRob2QgPSAkaHR0cF9t
ZXRob2Q7CiAgICAkdGhpcy0+aHR0cF91cmwgPSAkaHR0cF91cmw7CiAgfQoKCiAgLyoqCiAg
ICogYXR0ZW1wdCB0byBidWlsZCB1cCBhIHJlcXVlc3QgZnJvbSB3aGF0IHdhcyBwYXNzZWQg
dG8gdGhlIHNlcnZlcgogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9yZXF1
ZXN0KCRodHRwX21ldGhvZD1OVUxMLCAkaHR0cF91cmw9TlVMTCwgJHBhcmFtZXRlcnM9TlVM
TCkgewogICAgJHNjaGVtZSA9ICghaXNzZXQoJF9TRVJWRVJbJ0hUVFBTJ10pIHx8ICRfU0VS
VkVSWydIVFRQUyddICE9ICJvbiIpCiAgICAgICAgICAgICAgPyAnaHR0cCcKICAgICAgICAg
ICAgICA6ICdodHRwcyc7CiAgICBAJGh0dHBfdXJsIG9yICRodHRwX3VybCA9ICRzY2hlbWUg
LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOi8vJyAuICRfU0VSVkVSWydIVFRQ
X0hPU1QnXSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6JyAuCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVSWydTRVJWRVJfUE9SVCddIC4KICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ107CiAgICBA
JGh0dHBfbWV0aG9kIG9yICRodHRwX21ldGhvZCA9ICRfU0VSVkVSWydSRVFVRVNUX01FVEhP
RCddOwoKICAgIC8vIFdlIHdlcmVuJ3QgaGFuZGVkIGFueSBwYXJhbWV0ZXJzLCBzbyBsZXQn
cyBmaW5kIHRoZSBvbmVzIHJlbGV2YW50IHRvCiAgICAvLyB0aGlzIHJlcXVlc3QuCiAgICAv
LyBJZiB5b3UgcnVuIFhNTC1SUEMgb3Igc2ltaWxhciB5b3Ugc2hvdWxkIHVzZSB0aGlzIHRv
IHByb3ZpZGUgeW91ciBvd24KICAgIC8vIHBhcnNlZCBwYXJhbWV0ZXItbGlzdAogICAgaWYg
KCEkcGFyYW1ldGVycykgewogICAgICAvLyBGaW5kIHJlcXVlc3QgaGVhZGVycwogICAgICAk
cmVxdWVzdF9oZWFkZXJzID0gT0F1dGhVdGlsOjpnZXRfaGVhZGVycygpOwoKICAgICAgLy8g
UGFyc2UgdGhlIHF1ZXJ5LXN0cmluZyB0byBmaW5kIEdFVCBwYXJhbWV0ZXJzCiAgICAgICRw
YXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRfU0VSVkVSWydRVUVS
WV9TVFJJTkcnXSk7CgogICAgICAvLyBJdCdzIGEgUE9TVCByZXF1ZXN0IG9mIHRoZSBwcm9w
ZXIgY29udGVudC10eXBlLCBzbyBwYXJzZSBQT1NUCiAgICAgIC8vIHBhcmFtZXRlcnMgYW5k
IGFkZCB0aG9zZSBvdmVycmlkaW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUCiAgICAgIGlm
ICgkaHR0cF9tZXRob2QgPT0gIlBPU1QiCiAgICAgICAgICAmJiBAc3Ryc3RyKCRyZXF1ZXN0
X2hlYWRlcnNbIkNvbnRlbnQtVHlwZSJdLAogICAgICAgICAgICAgICAgICAgICAiYXBwbGlj
YXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikKICAgICAgICAgICkgewogICAgICAgICRw
b3N0X2RhdGEgPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoCiAgICAgICAgICBmaWxl
X2dldF9jb250ZW50cyhzZWxmOjokUE9TVF9JTlBVVCkKICAgICAgICApOwogICAgICAgICRw
YXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRlcnMsICRwb3N0X2RhdGEpOwogICAg
ICB9CgogICAgICAvLyBXZSBoYXZlIGEgQXV0aG9yaXphdGlvbi1oZWFkZXIgd2l0aCBPQXV0
aCBkYXRhLiBQYXJzZSB0aGUgaGVhZGVyCiAgICAgIC8vIGFuZCBhZGQgdGhvc2Ugb3ZlcnJp
ZGluZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVCBvciBQT1NUCiAgICAgIGlmIChAc3Vic3Ry
KCRyZXF1ZXN0X2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSwgMCwgNikgPT0gIk9BdXRoICIp
IHsKICAgICAgICAkaGVhZGVyX3BhcmFtZXRlcnMgPSBPQXV0aFV0aWw6OnNwbGl0X2hlYWRl
cigKICAgICAgICAgICRyZXF1ZXN0X2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXQogICAgICAg
ICk7CiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywgJGhl
YWRlcl9wYXJhbWV0ZXJzKTsKICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gbmV3IE9BdXRo
UmVxdWVzdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwogIH0KCiAg
LyoqCiAgICogcHJldHR5IG11Y2ggYSBoZWxwZXIgZnVuY3Rpb24gdG8gc2V0IHVwIHRoZSBy
ZXF1ZXN0CiAgICovCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBmcm9tX2NvbnN1bWVyX2Fu
ZF90b2tlbigkY29uc3VtZXIsICR0b2tlbiwgJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRw
YXJhbWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFy
cmF5KCk7CiAgICAkZGVmYXVsdHMgPSBhcnJheSgib2F1dGhfdmVyc2lvbiIgPT4gT0F1dGhS
ZXF1ZXN0OjokdmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF9ub25jZSIg
PT4gT0F1dGhSZXF1ZXN0OjpnZW5lcmF0ZV9ub25jZSgpLAogICAgICAgICAgICAgICAgICAg
ICAgIm9hdXRoX3RpbWVzdGFtcCIgPT4gT0F1dGhSZXF1ZXN0OjpnZW5lcmF0ZV90aW1lc3Rh
bXAoKSwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF9jb25zdW1lcl9rZXkiID0+ICRj
b25zdW1lci0+a2V5KTsKICAgIGlmICgkdG9rZW4pCiAgICAgICRkZWZhdWx0c1snb2F1dGhf
dG9rZW4nXSA9ICR0b2tlbi0+a2V5OwoKICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2Uo
JGRlZmF1bHRzLCAkcGFyYW1ldGVycyk7CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3Qo
JGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9CgogIHB1YmxpYyBm
dW5jdGlvbiBzZXRfcGFyYW1ldGVyKCRuYW1lLCAkdmFsdWUsICRhbGxvd19kdXBsaWNhdGVz
ID0gdHJ1ZSkgewogICAgaWYgKCRhbGxvd19kdXBsaWNhdGVzICYmIGlzc2V0KCR0aGlzLT5w
YXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5IGFkZGVkIHBh
cmFtZXRlcihzKSB3aXRoIHRoaXMgbmFtZSwgc28gYWRkIHRvIHRoZSBsaXN0CiAgICAgIGlm
IChpc19zY2FsYXIoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAgIC8vIFRo
aXMgaXMgdGhlIGZpcnN0IGR1cGxpY2F0ZSwgc28gdHJhbnNmb3JtIHNjYWxhciAoc3RyaW5n
KQogICAgICAgIC8vIGludG8gYW4gYXJyYXkgc28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRl
cwogICAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9IGFycmF5KCR0aGlzLT5wYXJh
bWV0ZXJzWyRuYW1lXSk7CiAgICAgIH0KCiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1l
XVtdID0gJHZhbHVlOwogICAgfSBlbHNlIHsKICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5h
bWVdID0gJHZhbHVlOwogICAgfQogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGdldF9wYXJhbWV0
ZXIoJG5hbWUpIHsKICAgIHJldHVybiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0p
ID8gJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdIDogbnVsbDsKICB9CgogIHB1YmxpYyBmdW5j
dGlvbiBnZXRfcGFyYW1ldGVycygpIHsKICAgIHJldHVybiAkdGhpcy0+cGFyYW1ldGVyczsK
ICB9CgogIHB1YmxpYyBmdW5jdGlvbiB1bnNldF9wYXJhbWV0ZXIoJG5hbWUpIHsKICAgIHVu
c2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSk7CiAgfQoKICAvKioKICAgKiBUaGUgcmVx
dWVzdCBwYXJhbWV0ZXJzLCBzb3J0ZWQgYW5kIGNvbmNhdGVuYXRlZCBpbnRvIGEgbm9ybWFs
aXplZCBzdHJpbmcuCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBwdWJsaWMgZnVuY3Rp
b24gZ2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMoKSB7CiAgICAvLyBHcmFiIGFsbCBwYXJhbWV0
ZXJzCiAgICAkcGFyYW1zID0gJHRoaXMtPnBhcmFtZXRlcnM7CgogICAgLy8gUmVtb3ZlIG9h
dXRoX3NpZ25hdHVyZSBpZiBwcmVzZW50CiAgICAvLyBSZWY6IFNwZWM6IDkuMS4xICgiVGhl
IG9hdXRoX3NpZ25hdHVyZSBwYXJhbWV0ZXIgTVVTVCBiZSBleGNsdWRlZC4iKQogICAgaWYg
KGlzc2V0KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVyZSddKSkgewogICAgICB1bnNldCgkcGFy
YW1zWydvYXV0aF9zaWduYXR1cmUnXSk7CiAgICB9CgogICAgcmV0dXJuIE9BdXRoVXRpbDo6
YnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1zKTsKICB9CgogIC8qKgogICAqIFJldHVybnMgdGhl
IGJhc2Ugc3RyaW5nIG9mIHRoaXMgcmVxdWVzdAogICAqCiAgICogVGhlIGJhc2Ugc3RyaW5n
IGRlZmluZWQgYXMgdGhlIG1ldGhvZCwgdGhlIHVybAogICAqIGFuZCB0aGUgcGFyYW1ldGVy
cyAobm9ybWFsaXplZCksIGVhY2ggdXJsZW5jb2RlZAogICAqIGFuZCB0aGUgY29uY2F0ZWQg
d2l0aCAmLgogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX2Jhc2Vfc3Ry
aW5nKCkgewogICAgJHBhcnRzID0gYXJyYXkoCiAgICAgICR0aGlzLT5nZXRfbm9ybWFsaXpl
ZF9odHRwX21ldGhvZCgpLAogICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwo
KSwKICAgICAgJHRoaXMtPmdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkKICAgICk7CgogICAg
JHBhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcGFydHMpOwoKICAgIHJl
dHVybiBpbXBsb2RlKCcmJywgJHBhcnRzKTsKICB9CgogIC8qKgogICAqIGp1c3QgdXBwZXJj
YXNlcyB0aGUgaHR0cCBtZXRob2QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25vcm1h
bGl6ZWRfaHR0cF9tZXRob2QoKSB7CiAgICByZXR1cm4gc3RydG91cHBlcigkdGhpcy0+aHR0
cF9tZXRob2QpOwogIH0KCiAgLyoqCiAgICogcGFyc2VzIHRoZSB1cmwgYW5kIHJlYnVpbGRz
IGl0IHRvIGJlCiAgICogc2NoZW1lOi8vaG9zdC9wYXRoCiAgICovCiAgcHVibGljIGZ1bmN0
aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCkgewogICAgJHBhcnRzID0gcGFyc2VfdXJs
KCR0aGlzLT5odHRwX3VybCk7CgogICAgJHBvcnQgPSBAJHBhcnRzWydwb3J0J107CiAgICAk
c2NoZW1lID0gJHBhcnRzWydzY2hlbWUnXTsKICAgICRob3N0ID0gJHBhcnRzWydob3N0J107
CiAgICAkcGF0aCA9IEAkcGFydHNbJ3BhdGgnXTsKCiAgICAkcG9ydCBvciAkcG9ydCA9ICgk
c2NoZW1lID09ICdodHRwcycpID8gJzQ0MycgOiAnODAnOwoKICAgIGlmICgoJHNjaGVtZSA9
PSAnaHR0cHMnICYmICRwb3J0ICE9ICc0NDMnKQogICAgICAgIHx8ICgkc2NoZW1lID09ICdo
dHRwJyAmJiAkcG9ydCAhPSAnODAnKSkgewogICAgICAkaG9zdCA9ICIkaG9zdDokcG9ydCI7
CiAgICB9CiAgICByZXR1cm4gIiRzY2hlbWU6Ly8kaG9zdCRwYXRoIjsKICB9CgogIC8qKgog
ICAqIGJ1aWxkcyBhIHVybCB1c2FibGUgZm9yIGEgR0VUIHJlcXVlc3QKICAgKi8KICBwdWJs
aWMgZnVuY3Rpb24gdG9fdXJsKCkgewogICAgJHBvc3RfZGF0YSA9ICR0aGlzLT50b19wb3N0
ZGF0YSgpOwogICAgJG91dCA9ICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpOwog
ICAgaWYgKCRwb3N0X2RhdGEpIHsKICAgICAgJG91dCAuPSAnPycuJHBvc3RfZGF0YTsKICAg
IH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBkYXRhIG9u
ZSB3b3VsZCBzZW5kIGluIGEgUE9TVCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9u
IHRvX3Bvc3RkYXRhKCkgewogICAgcmV0dXJuIE9BdXRoVXRpbDo6YnVpbGRfaHR0cF9xdWVy
eSgkdGhpcy0+cGFyYW1ldGVycyk7CiAgfQoKICAvKioKICAgKiBidWlsZHMgdGhlIEF1dGhv
cml6YXRpb246IGhlYWRlcgogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19oZWFkZXIoJHJl
YWxtPW51bGwpIHsKICAgICRmaXJzdCA9IHRydWU7CiAgaWYoJHJlYWxtKSB7CiAgICAgICRv
dXQgPSAnQXV0aG9yaXphdGlvbjogT0F1dGggcmVhbG09IicgLiBPQXV0aFV0aWw6OnVybGVu
Y29kZV9yZmMzOTg2KCRyZWFsbSkgLiAnIic7CiAgICAgICRmaXJzdCA9IGZhbHNlOwogICAg
fSBlbHNlCiAgICAgICRvdXQgPSAnQXV0aG9yaXphdGlvbjogT0F1dGgnOwoKICAgICR0b3Rh
bCA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkdGhpcy0+cGFyYW1ldGVycyBhcyAkayA9PiAk
dikgewogICAgICBpZiAoc3Vic3RyKCRrLCAwLCA1KSAhPSAib2F1dGgiKSBjb250aW51ZTsK
ICAgICAgaWYgKGlzX2FycmF5KCR2KSkgewogICAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2Vw
dGlvbignQXJyYXlzIG5vdCBzdXBwb3J0ZWQgaW4gaGVhZGVycycpOwogICAgICB9CiAgICAg
ICRvdXQgLj0gKCRmaXJzdCkgPyAnICcgOiAnLCc7CiAgICAgICRvdXQgLj0gT0F1dGhVdGls
Ojp1cmxlbmNvZGVfcmZjMzk4NigkaykgLgogICAgICAgICAgICAgICc9IicgLgogICAgICAg
ICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHYpIC4KICAgICAgICAgICAg
ICAnIic7CiAgICAgICRmaXJzdCA9IGZhbHNlOwogICAgfQogICAgcmV0dXJuICRvdXQ7CiAg
fQoKICBwdWJsaWMgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAgIHJldHVybiAkdGhpcy0+
dG9fdXJsKCk7CiAgfQoKCiAgcHVibGljIGZ1bmN0aW9uIHNpZ25fcmVxdWVzdCgkc2lnbmF0
dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICR0aGlzLT5zZXRfcGFyYW1l
dGVyKAogICAgICAib2F1dGhfc2lnbmF0dXJlX21ldGhvZCIsCiAgICAgICRzaWduYXR1cmVf
bWV0aG9kLT5nZXRfbmFtZSgpLAogICAgICBmYWxzZQogICAgKTsKICAgICRzaWduYXR1cmUg
PSAkdGhpcy0+YnVpbGRfc2lnbmF0dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIs
ICR0b2tlbik7CiAgICAkdGhpcy0+c2V0X3BhcmFtZXRlcigib2F1dGhfc2lnbmF0dXJlIiwg
JHNpZ25hdHVyZSwgZmFsc2UpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25h
dHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRzaWdu
YXR1cmUgPSAkc2lnbmF0dXJlX21ldGhvZC0+YnVpbGRfc2lnbmF0dXJlKCR0aGlzLCAkY29u
c3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gJHNpZ25hdHVyZTsKICB9CgogIC8qKgogICAq
IHV0aWwgZnVuY3Rpb246IGN1cnJlbnQgdGltZXN0YW1wCiAgICovCiAgcHJpdmF0ZSBzdGF0
aWMgZnVuY3Rpb24gZ2VuZXJhdGVfdGltZXN0YW1wKCkgewogICAgcmV0dXJuIHRpbWUoKTsK
ICB9CgogIC8qKgogICAqIHV0aWwgZnVuY3Rpb246IGN1cnJlbnQgbm9uY2UKICAgKi8KICBw
cml2YXRlIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0ZV9ub25jZSgpIHsKICAgICRtdCA9IG1p
Y3JvdGltZSgpOwogICAgJHJhbmQgPSBtdF9yYW5kKCk7CgogICAgcmV0dXJuIG1kNSgkbXQg
LiAkcmFuZCk7IC8vIG1kNXMgbG9vayBuaWNlciB0aGFuIG51bWJlcnMKICB9Cn0KCmNsYXNz
IE9BdXRoU2VydmVyIHsKICBwcm90ZWN0ZWQgJHRpbWVzdGFtcF90aHJlc2hvbGQgPSAzMDA7
IC8vIGluIHNlY29uZHMsIGZpdmUgbWludXRlcwogIHByb3RlY3RlZCAkdmVyc2lvbiA9ICcx
LjAnOyAgICAgICAgICAgICAvLyBoaSBibGFpbmUKICBwcm90ZWN0ZWQgJHNpZ25hdHVyZV9t
ZXRob2RzID0gYXJyYXkoKTsKCiAgcHJvdGVjdGVkICRkYXRhX3N0b3JlOwoKICBmdW5jdGlv
biBfX2NvbnN0cnVjdCgkZGF0YV9zdG9yZSkgewogICAgJHRoaXMtPmRhdGFfc3RvcmUgPSAk
ZGF0YV9zdG9yZTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBhZGRfc2lnbmF0dXJlX21ldGhv
ZCgkc2lnbmF0dXJlX21ldGhvZCkgewogICAgJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzWyRz
aWduYXR1cmVfbWV0aG9kLT5nZXRfbmFtZSgpXSA9CiAgICAgICRzaWduYXR1cmVfbWV0aG9k
OwogIH0KCiAgLy8gaGlnaCBsZXZlbCBmdW5jdGlvbnMKCiAgLyoqCiAgICogcHJvY2VzcyBh
IHJlcXVlc3RfdG9rZW4gcmVxdWVzdAogICAqIHJldHVybnMgdGhlIHJlcXVlc3QgdG9rZW4g
b24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9yZXF1ZXN0X3Rva2Vu
KCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKCiAgICAk
Y29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKCiAgICAvLyBubyB0
b2tlbiByZXF1aXJlZCBmb3IgdGhlIGluaXRpYWwgdG9rZW4gcmVxdWVzdAogICAgJHRva2Vu
ID0gTlVMTDsKCiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3Vt
ZXIsICR0b2tlbik7CgogICAgLy8gUmV2IEEgY2hhbmdlCiAgICAkY2FsbGJhY2sgPSAkcmVx
dWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfY2FsbGJhY2snKTsKICAgICRuZXdfdG9rZW4g
PSAkdGhpcy0+ZGF0YV9zdG9yZS0+bmV3X3JlcXVlc3RfdG9rZW4oJGNvbnN1bWVyLCAkY2Fs
bGJhY2spOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogcHJvY2Vz
cyBhbiBhY2Nlc3NfdG9rZW4gcmVxdWVzdAogICAqIHJldHVybnMgdGhlIGFjY2VzcyB0b2tl
biBvbiBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZldGNoX2FjY2Vzc190b2tl
bigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CgogICAg
JGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8gcmVx
dWlyZXMgYXV0aG9yaXplZCByZXF1ZXN0IHRva2VuCiAgICAkdG9rZW4gPSAkdGhpcy0+Z2V0
X3Rva2VuKCRyZXF1ZXN0LCAkY29uc3VtZXIsICJyZXF1ZXN0Iik7CgogICAgJHRoaXMtPmNo
ZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJl
diBBIGNoYW5nZQogICAgJHZlcmlmaWVyID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29h
dXRoX3ZlcmlmaWVyJyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5l
d19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllcik7CgogICAgcmV0
dXJuICRuZXdfdG9rZW47CiAgfQoKICAvKioKICAgKiB2ZXJpZnkgYW4gYXBpIGNhbGwsIGNo
ZWNrcyBhbGwgdGhlIHBhcmFtZXRlcnMKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdmVyaWZ5
X3JlcXVlc3QoJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3Qp
OwogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CiAgICAk
dG9rZW4gPSAkdGhpcy0+Z2V0X3Rva2VuKCRyZXF1ZXN0LCAkY29uc3VtZXIsICJhY2Nlc3Mi
KTsKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRv
a2VuKTsKICAgIHJldHVybiBhcnJheSgkY29uc3VtZXIsICR0b2tlbik7CiAgfQoKICAvLyBJ
bnRlcm5hbHMgZnJvbSBoZXJlCiAgLyoqCiAgICogdmVyc2lvbiAxCiAgICovCiAgcHJpdmF0
ZSBmdW5jdGlvbiBnZXRfdmVyc2lvbigmJHJlcXVlc3QpIHsKICAgICR2ZXJzaW9uID0gJHJl
cXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3ZlcnNpb24iKTsKICAgIGlmICghJHZlcnNp
b24pIHsKICAgICAgLy8gU2VydmljZSBQcm92aWRlcnMgTVVTVCBhc3N1bWUgdGhlIHByb3Rv
Y29sIHZlcnNpb24gdG8gYmUgMS4wIGlmIHRoaXMgcGFyYW1ldGVyIGlzIG5vdCBwcmVzZW50
LgogICAgICAvLyBDaGFwdGVyIDcuMCAoIkFjY2Vzc2luZyBQcm90ZWN0ZWQgUmVzc291cmNl
cyIpCiAgICAgICR2ZXJzaW9uID0gJzEuMCc7CiAgICB9CiAgICBpZiAoJHZlcnNpb24gIT09
ICR0aGlzLT52ZXJzaW9uKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiT0F1
dGggdmVyc2lvbiAnJHZlcnNpb24nIG5vdCBzdXBwb3J0ZWQiKTsKICAgIH0KICAgIHJldHVy
biAkdmVyc2lvbjsKICB9CgogIC8qKgogICAqIGZpZ3VyZSBvdXQgdGhlIHNpZ25hdHVyZSB3
aXRoIHNvbWUgZGVmYXVsdHMKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF9zaWduYXR1
cmVfbWV0aG9kKCYkcmVxdWVzdCkgewogICAgJHNpZ25hdHVyZV9tZXRob2QgPQogICAgICAg
IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfc2lnbmF0dXJlX21ldGhvZCIpOwoK
ICAgIGlmICghJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICAgLy8gQWNjb3JkaW5nIHRvIGNo
YXB0ZXIgNyAoIkFjY2Vzc2luZyBQcm90ZWN0ZWQgUmVzc291cmNlcyIpIHRoZSBzaWduYXR1
cmUtbWV0aG9kCiAgICAgIC8vIHBhcmFtZXRlciBpcyByZXF1aXJlZCwgYW5kIHdlIGNhbid0
IGp1c3QgZmFsbGJhY2sgdG8gUExBSU5URVhUCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2Vw
dGlvbignTm8gc2lnbmF0dXJlIG1ldGhvZCBwYXJhbWV0ZXIuIFRoaXMgcGFyYW1ldGVyIGlz
IHJlcXVpcmVkJyk7CiAgICB9CgogICAgaWYgKCFpbl9hcnJheSgkc2lnbmF0dXJlX21ldGhv
ZCwKICAgICAgICAgICAgICAgICAgYXJyYXlfa2V5cygkdGhpcy0+c2lnbmF0dXJlX21ldGhv
ZHMpKSkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIlNpZ25h
dHVyZSBtZXRob2QgJyRzaWduYXR1cmVfbWV0aG9kJyBub3Qgc3VwcG9ydGVkICIgLgogICAg
ICAgICJ0cnkgb25lIG9mIHRoZSBmb2xsb3dpbmc6ICIgLgogICAgICAgIGltcGxvZGUoIiwg
IiwgYXJyYXlfa2V5cygkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHMpKQogICAgICApOwogICAg
fQogICAgcmV0dXJuICR0aGlzLT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhv
ZF07CiAgfQoKICAvKioKICAgKiB0cnkgdG8gZmluZCB0aGUgY29uc3VtZXIgZm9yIHRoZSBw
cm92aWRlZCByZXF1ZXN0J3MgY29uc3VtZXIga2V5CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlv
biBnZXRfY29uc3VtZXIoJiRyZXF1ZXN0KSB7CiAgICAkY29uc3VtZXJfa2V5ID0gQCRyZXF1
ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9jb25zdW1lcl9rZXkiKTsKICAgIGlmICghJGNv
bnN1bWVyX2tleSkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQg
Y29uc3VtZXIga2V5Iik7CiAgICB9CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmRhdGFfc3Rv
cmUtPmxvb2t1cF9jb25zdW1lcigkY29uc3VtZXJfa2V5KTsKICAgIGlmICghJGNvbnN1bWVy
KSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBjb25zdW1lciIp
OwogICAgfQoKICAgIHJldHVybiAkY29uc3VtZXI7CiAgfQoKICAvKioKICAgKiB0cnkgdG8g
ZmluZCB0aGUgdG9rZW4gZm9yIHRoZSBwcm92aWRlZCByZXF1ZXN0J3MgdG9rZW4ga2V5CiAg
ICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfdG9rZW4oJiRyZXF1ZXN0LCAkY29uc3VtZXIs
ICR0b2tlbl90eXBlPSJhY2Nlc3MiKSB7CiAgICAkdG9rZW5fZmllbGQgPSBAJHJlcXVlc3Qt
PmdldF9wYXJhbWV0ZXIoJ29hdXRoX3Rva2VuJyk7CiAgICAkdG9rZW4gPSAkdGhpcy0+ZGF0
YV9zdG9yZS0+bG9va3VwX3Rva2VuKAogICAgICAkY29uc3VtZXIsICR0b2tlbl90eXBlLCAk
dG9rZW5fZmllbGQKICAgICk7CiAgICBpZiAoISR0b2tlbikgewogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oIkludmFsaWQgJHRva2VuX3R5cGUgdG9rZW46ICR0b2tlbl9maWVs
ZCIpOwogICAgfQogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIGFsbC1pbi1v
bmUgZnVuY3Rpb24gdG8gY2hlY2sgdGhlIHNpZ25hdHVyZSBvbiBhIHJlcXVlc3QKICAgKiBz
aG91bGQgZ3Vlc3MgdGhlIHNpZ25hdHVyZSBtZXRob2QgYXBwcm9wcmlhdGVseQogICAqLwog
IHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCYkcmVxdWVzdCwgJGNvbnN1bWVy
LCAkdG9rZW4pIHsKICAgIC8vIHRoaXMgc2hvdWxkIHByb2JhYmx5IGJlIGluIGEgZGlmZmVy
ZW50IG1ldGhvZAogICAgJHRpbWVzdGFtcCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcign
b2F1dGhfdGltZXN0YW1wJyk7CiAgICAkbm9uY2UgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0
ZXIoJ29hdXRoX25vbmNlJyk7CgogICAgJHRoaXMtPmNoZWNrX3RpbWVzdGFtcCgkdGltZXN0
YW1wKTsKICAgICR0aGlzLT5jaGVja19ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNl
LCAkdGltZXN0YW1wKTsKCiAgICAkc2lnbmF0dXJlX21ldGhvZCA9ICR0aGlzLT5nZXRfc2ln
bmF0dXJlX21ldGhvZCgkcmVxdWVzdCk7CgogICAgJHNpZ25hdHVyZSA9ICRyZXF1ZXN0LT5n
ZXRfcGFyYW1ldGVyKCdvYXV0aF9zaWduYXR1cmUnKTsKICAgICR2YWxpZF9zaWcgPSAkc2ln
bmF0dXJlX21ldGhvZC0+Y2hlY2tfc2lnbmF0dXJlKAogICAgICAkcmVxdWVzdCwKICAgICAg
JGNvbnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRzaWduYXR1cmUKICAgICk7CgogICAg
aWYgKCEkdmFsaWRfc2lnKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52
YWxpZCBzaWduYXR1cmUiKTsKICAgIH0KICB9CgogIC8qKgogICAqIGNoZWNrIHRoYXQgdGhl
IHRpbWVzdGFtcCBpcyBuZXcgZW5vdWdoCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVj
a190aW1lc3RhbXAoJHRpbWVzdGFtcCkgewogICAgaWYoICEgJHRpbWVzdGFtcCApCiAgICAg
IHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyB0aW1lc3RhbXAg
cGFyYW1ldGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICApOwoKICAgIC8v
IHZlcmlmeSB0aGF0IHRpbWVzdGFtcCBpcyByZWNlbnRpc2gKICAgICRub3cgPSB0aW1lKCk7
CiAgICBpZiAoYWJzKCRub3cgLSAkdGltZXN0YW1wKSA+ICR0aGlzLT50aW1lc3RhbXBfdGhy
ZXNob2xkKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAiRXhw
aXJlZCB0aW1lc3RhbXAsIHlvdXJzICR0aW1lc3RhbXAsIG91cnMgJG5vdyIKICAgICAgKTsK
ICAgIH0KICB9CgogIC8qKgogICAqIGNoZWNrIHRoYXQgdGhlIG5vbmNlIGlzIG5vdCByZXBl
YXRlZAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAk
dG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCkgewogICAgaWYoICEgJG5vbmNlICkKICAgICAg
dGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdNaXNzaW5nIG5vbmNlIHBhcmFt
ZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAvLyB2ZXJp
ZnkgdGhhdCB0aGUgbm9uY2UgaXMgdW5pcXVlaXNoCiAgICAkZm91bmQgPSAkdGhpcy0+ZGF0
YV9zdG9yZS0+bG9va3VwX25vbmNlKAogICAgICAkY29uc3VtZXIsCiAgICAgICR0b2tlbiwK
ICAgICAgJG5vbmNlLAogICAgICAkdGltZXN0YW1wCiAgICApOwogICAgaWYgKCRmb3VuZCkg
ewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIk5vbmNlIGFscmVhZHkgdXNlZDog
JG5vbmNlIik7CiAgICB9CiAgfQoKfQoKY2xhc3MgT0F1dGhEYXRhU3RvcmUgewogIGZ1bmN0
aW9uIGxvb2t1cF9jb25zdW1lcigkY29uc3VtZXJfa2V5KSB7CiAgICAvLyBpbXBsZW1lbnQg
bWUKICB9CgogIGZ1bmN0aW9uIGxvb2t1cF90b2tlbigkY29uc3VtZXIsICR0b2tlbl90eXBl
LCAkdG9rZW4pIHsKICAgIC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbG9va3Vw
X25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAgIC8v
IGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbmV3X3JlcXVlc3RfdG9rZW4oJGNvbnN1
bWVyLCAkY2FsbGJhY2sgPSBudWxsKSB7CiAgICAvLyByZXR1cm4gYSBuZXcgdG9rZW4gYXR0
YWNoZWQgdG8gdGhpcyBjb25zdW1lcgogIH0KCiAgZnVuY3Rpb24gbmV3X2FjY2Vzc190b2tl
bigkdG9rZW4sICRjb25zdW1lciwgJHZlcmlmaWVyID0gbnVsbCkgewogICAgLy8gcmV0dXJu
IGEgbmV3IGFjY2VzcyB0b2tlbiBhdHRhY2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgICAvLyBm
b3IgdGhlIHVzZXIgYXNzb2NpYXRlZCB3aXRoIHRoaXMgdG9rZW4gaWYgdGhlIHJlcXVlc3Qg
dG9rZW4KICAgIC8vIGlzIGF1dGhvcml6ZWQKICAgIC8vIHNob3VsZCBhbHNvIGludmFsaWRh
dGUgdGhlIHJlcXVlc3QgdG9rZW4KICB9Cgp9CgpjbGFzcyBPQXV0aFV0aWwgewogIHB1Ymxp
YyBzdGF0aWMgZnVuY3Rpb24gdXJsZW5jb2RlX3JmYzM5ODYoJGlucHV0KSB7CiAgaWYgKGlz
X2FycmF5KCRpbnB1dCkpIHsKICAgIHJldHVybiBhcnJheV9tYXAoYXJyYXkoJ09BdXRoVXRp
bCcsICd1cmxlbmNvZGVfcmZjMzk4NicpLCAkaW5wdXQpOwogIH0gZWxzZSBpZiAoaXNfc2Nh
bGFyKCRpbnB1dCkpIHsKICAgIHJldHVybiBzdHJfcmVwbGFjZSgKICAgICAgJysnLAogICAg
ICAnICcsCiAgICAgIHN0cl9yZXBsYWNlKCclN0UnLCAnficsIHJhd3VybGVuY29kZSgkaW5w
dXQpKQogICAgKTsKICB9IGVsc2UgewogICAgcmV0dXJuICcnOwogIH0KfQoKCiAgLy8gVGhp
cyBkZWNvZGUgZnVuY3Rpb24gaXNuJ3QgdGFraW5nIGludG8gY29uc2lkZXJhdGlvbiB0aGUg
YWJvdmUKICAvLyBtb2RpZmljYXRpb25zIHRvIHRoZSBlbmNvZGluZyBwcm9jZXNzLiBIb3dl
dmVyLCB0aGlzIG1ldGhvZCBkb2Vzbid0CiAgLy8gc2VlbSB0byBiZSB1c2VkIGFueXdoZXJl
IHNvIGxlYXZpbmcgaXQgYXMgaXMuCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiB1cmxkZWNv
ZGVfcmZjMzk4Nigkc3RyaW5nKSB7CiAgICByZXR1cm4gdXJsZGVjb2RlKCRzdHJpbmcpOwog
IH0KCiAgLy8gVXRpbGl0eSBmdW5jdGlvbiBmb3IgdHVybmluZyB0aGUgQXV0aG9yaXphdGlv
bjogaGVhZGVyIGludG8KICAvLyBwYXJhbWV0ZXJzLCBoYXMgdG8gZG8gc29tZSB1bmVzY2Fw
aW5nCiAgLy8gQ2FuIGZpbHRlciBvdXQgYW55IG5vbi1vYXV0aCBwYXJhbWV0ZXJzIGlmIG5l
ZWRlZCAoZGVmYXVsdCBiZWhhdmlvdXIpCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzcGxp
dF9oZWFkZXIoJGhlYWRlciwgJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycyA9IHRydWUp
IHsKICAgICRwYXR0ZXJuID0gJy8oKFstX2Etel0qKT0oIihbXiJdKikifChbXixdKikpLD8p
Lyc7CiAgICAkb2Zmc2V0ID0gMDsKICAgICRwYXJhbXMgPSBhcnJheSgpOwogICAgd2hpbGUg
KHByZWdfbWF0Y2goJHBhdHRlcm4sICRoZWFkZXIsICRtYXRjaGVzLCBQUkVHX09GRlNFVF9D
QVBUVVJFLCAkb2Zmc2V0KSA+IDApIHsKICAgICAgJG1hdGNoID0gJG1hdGNoZXNbMF07CiAg
ICAgICRoZWFkZXJfbmFtZSA9ICRtYXRjaGVzWzJdWzBdOwogICAgICAkaGVhZGVyX2NvbnRl
bnQgPSAoaXNzZXQoJG1hdGNoZXNbNV0pKSA/ICRtYXRjaGVzWzVdWzBdIDogJG1hdGNoZXNb
NF1bMF07CiAgICAgIGlmIChwcmVnX21hdGNoKCcvXm9hdXRoXy8nLCAkaGVhZGVyX25hbWUp
IHx8ICEkb25seV9hbGxvd19vYXV0aF9wYXJhbWV0ZXJzKSB7CiAgICAgICAgJHBhcmFtc1sk
aGVhZGVyX25hbWVdID0gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4NigkaGVhZGVyX2Nv
bnRlbnQpOwogICAgICB9CiAgICAgICRvZmZzZXQgPSAkbWF0Y2hbMV0gKyBzdHJsZW4oJG1h
dGNoWzBdKTsKICAgIH0KCiAgICBpZiAoaXNzZXQoJHBhcmFtc1sncmVhbG0nXSkpIHsKICAg
ICAgdW5zZXQoJHBhcmFtc1sncmVhbG0nXSk7CiAgICB9CgogICAgcmV0dXJuICRwYXJhbXM7
CiAgfQoKICAvLyBoZWxwZXIgdG8gdHJ5IHRvIHNvcnQgb3V0IGhlYWRlcnMgZm9yIHBlb3Bs
ZSB3aG8gYXJlbid0IHJ1bm5pbmcgYXBhY2hlCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBn
ZXRfaGVhZGVycygpIHsKICAgIGlmIChmdW5jdGlvbl9leGlzdHMoJ2FwYWNoZV9yZXF1ZXN0
X2hlYWRlcnMnKSkgewogICAgICAvLyB3ZSBuZWVkIHRoaXMgdG8gZ2V0IHRoZSBhY3R1YWwg
QXV0aG9yaXphdGlvbjogaGVhZGVyCiAgICAgIC8vIGJlY2F1c2UgYXBhY2hlIHRlbmRzIHRv
IHRlbGwgdXMgaXQgZG9lc24ndCBleGlzdAogICAgICAkaGVhZGVycyA9IGFwYWNoZV9yZXF1
ZXN0X2hlYWRlcnMoKTsKCiAgICAgIC8vIHNhbml0aXplIHRoZSBvdXRwdXQgb2YgYXBhY2hl
X3JlcXVlc3RfaGVhZGVycyBiZWNhdXNlCiAgICAgIC8vIHdlIGFsd2F5cyB3YW50IHRoZSBr
ZXlzIHRvIGJlIENhc2VkLUxpa2UtVGhpcyBhbmQgYXJoKCkKICAgICAgLy8gcmV0dXJucyB0
aGUgaGVhZGVycyBpbiB0aGUgc2FtZSBjYXNlIGFzIHRoZXkgYXJlIGluIHRoZQogICAgICAv
LyByZXF1ZXN0CiAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICBmb3JlYWNoKCAkaGVhZGVy
cyBBUyAka2V5ID0+ICR2YWx1ZSApIHsKICAgICAgICAka2V5ID0gc3RyX3JlcGxhY2UoCiAg
ICAgICAgICAgICIgIiwKICAgICAgICAgICAgIi0iLAogICAgICAgICAgICB1Y3dvcmRzKHN0
cnRvbG93ZXIoc3RyX3JlcGxhY2UoIi0iLCAiICIsICRrZXkpKSkKICAgICAgICAgICk7CiAg
ICAgICAgJG91dFska2V5XSA9ICR2YWx1ZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAg
Ly8gb3RoZXJ3aXNlIHdlIGRvbid0IGhhdmUgYXBhY2hlIGFuZCBhcmUganVzdCBnb2luZyB0
byBoYXZlIHRvIGhvcGUKICAgICAgLy8gdGhhdCAkX1NFUlZFUiBhY3R1YWxseSBjb250YWlu
cyB3aGF0IHdlIG5lZWQKICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGlmKCBpc3NldCgk
X1NFUlZFUlsnQ09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydDb250ZW50LVR5cGUn
XSA9ICRfU0VSVkVSWydDT05URU5UX1RZUEUnXTsKICAgICAgaWYoIGlzc2V0KCRfRU5WWydD
T05URU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRbJ0NvbnRlbnQtVHlwZSddID0gJF9FTlZb
J0NPTlRFTlRfVFlQRSddOwoKICAgICAgZm9yZWFjaCAoJF9TRVJWRVIgYXMgJGtleSA9PiAk
dmFsdWUpIHsKICAgICAgICBpZiAoc3Vic3RyKCRrZXksIDAsIDUpID09ICJIVFRQXyIpIHsK
ICAgICAgICAgIC8vIHRoaXMgaXMgY2hhb3MsIGJhc2ljYWxseSBpdCBpcyBqdXN0IHRoZXJl
IHRvIGNhcGl0YWxpemUgdGhlIGZpcnN0CiAgICAgICAgICAvLyBsZXR0ZXIgb2YgZXZlcnkg
d29yZCB0aGF0IGlzIG5vdCBhbiBpbml0aWFsIEhUVFAgYW5kIHN0cmlwIEhUVFAKICAgICAg
ICAgIC8vIGNvZGUgZnJvbSBwcnplbWVrCiAgICAgICAgICAka2V5ID0gc3RyX3JlcGxhY2Uo
CiAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgIi0iLAogICAgICAgICAgICB1Y3dvcmRz
KHN0cnRvbG93ZXIoc3RyX3JlcGxhY2UoIl8iLCAiICIsIHN1YnN0cigka2V5LCA1KSkpKQog
ICAgICAgICAgKTsKICAgICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgICAgfQog
ICAgICB9CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8vIFRoaXMgZnVuY3Rpb24g
dGFrZXMgYSBpbnB1dCBsaWtlIGE9YiZhPWMmZD1lIGFuZCByZXR1cm5zIHRoZSBwYXJzZWQK
ICAvLyBwYXJhbWV0ZXJzIGxpa2UgdGhpcwogIC8vIGFycmF5KCdhJyA9PiBhcnJheSgnYics
J2MnKSwgJ2QnID0+ICdlJykKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHBhcnNlX3BhcmFt
ZXRlcnMoICRpbnB1dCApIHsKICAgIGlmICghaXNzZXQoJGlucHV0KSB8fCAhJGlucHV0KSBy
ZXR1cm4gYXJyYXkoKTsKCiAgICAkcGFpcnMgPSBleHBsb2RlKCcmJywgJGlucHV0KTsKCiAg
ICAkcGFyc2VkX3BhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHBhaXJzIGFz
ICRwYWlyKSB7CiAgICAgICRzcGxpdCA9IGV4cGxvZGUoJz0nLCAkcGFpciwgMik7CiAgICAg
ICRwYXJhbWV0ZXIgPSBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRzcGxpdFswXSk7
CiAgICAgICR2YWx1ZSA9IGlzc2V0KCRzcGxpdFsxXSkgPyBPQXV0aFV0aWw6OnVybGRlY29k
ZV9yZmMzOTg2KCRzcGxpdFsxXSkgOiAnJzsKCiAgICAgIGlmIChpc3NldCgkcGFyc2VkX3Bh
cmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5IHJl
Y2lldmVkIHBhcmFtZXRlcihzKSB3aXRoIHRoaXMgbmFtZSwgc28gYWRkIHRvIHRoZSBsaXN0
CiAgICAgICAgLy8gb2YgcGFyYW1ldGVycyB3aXRoIHRoaXMgbmFtZQoKICAgICAgICBpZiAo
aXNfc2NhbGFyKCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAgICAg
IC8vIFRoaXMgaXMgdGhlIGZpcnN0IGR1cGxpY2F0ZSwgc28gdHJhbnNmb3JtIHNjYWxhciAo
c3RyaW5nKSBpbnRvIGFuIGFycmF5CiAgICAgICAgICAvLyBzbyB3ZSBjYW4gYWRkIHRoZSBk
dXBsaWNhdGVzCiAgICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0gPSBh
cnJheSgkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pOwogICAgICAgIH0KCiAgICAg
ICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdW10gPSAkdmFsdWU7CiAgICAgIH0g
ZWxzZSB7CiAgICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0gJHZhbHVl
OwogICAgICB9CiAgICB9CiAgICByZXR1cm4gJHBhcnNlZF9wYXJhbWV0ZXJzOwogIH0KCiAg
cHVibGljIHN0YXRpYyBmdW5jdGlvbiBidWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpIHsKICAg
IGlmICghJHBhcmFtcykgcmV0dXJuICcnOwoKICAgIC8vIFVybGVuY29kZSBib3RoIGtleXMg
YW5kIHZhbHVlcwogICAgJGtleXMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFy
cmF5X2tleXMoJHBhcmFtcykpOwogICAgJHZhbHVlcyA9IE9BdXRoVXRpbDo6dXJsZW5jb2Rl
X3JmYzM5ODYoYXJyYXlfdmFsdWVzKCRwYXJhbXMpKTsKICAgICRwYXJhbXMgPSBhcnJheV9j
b21iaW5lKCRrZXlzLCAkdmFsdWVzKTsKCiAgICAvLyBQYXJhbWV0ZXJzIGFyZSBzb3J0ZWQg
YnkgbmFtZSwgdXNpbmcgbGV4aWNvZ3JhcGhpY2FsIGJ5dGUgdmFsdWUgb3JkZXJpbmcuCiAg
ICAvLyBSZWY6IFNwZWM6IDkuMS4xICgxKQogICAgdWtzb3J0KCRwYXJhbXMsICdzdHJjbXAn
KTsKCiAgICAkcGFpcnMgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHBhcmFtcyBhcyAkcGFy
YW1ldGVyID0+ICR2YWx1ZSkgewogICAgICBpZiAoaXNfYXJyYXkoJHZhbHVlKSkgewogICAg
ICAgIC8vIElmIHR3byBvciBtb3JlIHBhcmFtZXRlcnMgc2hhcmUgdGhlIHNhbWUgbmFtZSwg
dGhleSBhcmUgc29ydGVkIGJ5IHRoZWlyIHZhbHVlCiAgICAgICAgLy8gUmVmOiBTcGVjOiA5
LjEuMSAoMSkKICAgICAgICBuYXRzb3J0KCR2YWx1ZSk7CiAgICAgICAgZm9yZWFjaCAoJHZh
bHVlIGFzICRkdXBsaWNhdGVfdmFsdWUpIHsKICAgICAgICAgICRwYWlyc1tdID0gJHBhcmFt
ZXRlciAuICc9JyAuICRkdXBsaWNhdGVfdmFsdWU7CiAgICAgICAgfQogICAgICB9IGVsc2Ug
ewogICAgICAgICRwYWlyc1tdID0gJHBhcmFtZXRlciAuICc9JyAuICR2YWx1ZTsKICAgICAg
fQogICAgfQogICAgLy8gRm9yIGVhY2ggcGFyYW1ldGVyLCB0aGUgbmFtZSBpcyBzZXBhcmF0
ZWQgZnJvbSB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZSBieSBhbiAnPScgY2hhcmFjdGVyIChB
U0NJSSBjb2RlIDYxKQogICAgLy8gRWFjaCBuYW1lLXZhbHVlIHBhaXIgaXMgc2VwYXJhdGVk
IGJ5IGFuICcmJyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpCiAgICByZXR1cm4gaW1wbG9k
ZSgnJicsICRwYWlycyk7CiAgfQp9IjtzOjM6Im1kNSI7czozMjoiOGMyOTYyNzU1ZmI1MzI0
MTU0OTQ1YzQyNTY3OTVmODgiO30=
