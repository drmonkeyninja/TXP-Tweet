# arc_twitter v4.1
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://andy-carter.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjM6
IjQuMSI7czo2OiJhdXRob3IiO3M6MTE6IkFuZHkgQ2FydGVyIjtzOjEwOiJhdXRob3JfdXJp
IjtzOjIzOiJodHRwOi8vYW5keS1jYXJ0ZXIuY29tLyI7czoxMToiZGVzY3JpcHRpb24iO3M6
NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0ZXI8L2E+IGZvciBU
ZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUiO3M6MToiNSI7czo1
OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTc5NjA6Igk8aDEgY2xhc3M9InRpdGxl
Ij48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJjX3R3aXR0ZXIgZm9y
IFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJf
YXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2lu
c3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248L2E+PC9saT4KCQk8
bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwvYT48
L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+VGhlIGFyY190
d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVy
X3R3ZWV0X2J1dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl90d2VldF9idXR0b24gdGFnPC9h
PjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uX3RhZyI+
VGhlIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl90d2VldF91cmwiPlRoZSBhcmNfdHdpdHRlcl90d2VldF91cmwg
dGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90aW55dXJsIj5UaGUg
YXJjX3R3aXR0ZXJfdGlueXVybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJj
X3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNsZXM8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8L2E+PC9saT4KCTwv
b2w+CgoJPHA+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgcHJvdmlkZXMg
YWNjZXNzIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50IHRocm91Z2ggYm90aCB0aGUgYWRtaW4g
aW50ZXJmYWNlIGFuZCB0aGUgcHVibGljIHNpZGUgb2YgeW91ciBzaXRlLiBVcGRhdGUgVHdp
dHRlciB3aGVuIHlvdSBwb3N0IGEgbmV3IGFydGljbGUgKHdpdGggYXJ0aWNsZS1ieS1hcnRp
Y2xlIG9wdCBvdXQgb3B0aW9uKSwgdXBkYXRlIGFuZCB2aWV3IHlvdXIgVHdpdHRlciBmZWVk
IHRocm91Z2ggdGhlIGFkbWluIFR3aXR0ZXIgdGFiLCBhbmQgZGlzcGxheSBUd2l0dGVyIGZl
ZWRzIG9uIHlvdXIgc2l0ZS48L3A+CgoJPHA+UmVxdWlyZW1lbnRzOi08L3A+CgoJPHVsPgoJ
CTxsaT5UZXh0cGF0dGVybiA0LjUrPC9saT4KCQk8bGk+PHNwYW4gY2xhc3M9ImNhcHMiPlBI
UDwvc3Bhbj4gNSBhbmQgY1VSTDwvbGk+Cgk8L3VsPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIg
aWQ9ImFyY190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9oMj4KCgk8cD48YSBocmVmPSJodHRw
Oi8vYW5keS1jYXJ0ZXIuY29tIj5BbmR5IENhcnRlcjwvYT4uIEZvciBvdGhlciBUZXh0cGF0
dGVybiBwbHVnaW5zIGJ5IG1lIHZpc2l0IG15IDxhIGhyZWY9Imh0dHA6Ly9hbmR5LWNhcnRl
ci5jb20vdHhwIj5QbHVnaW5zIHBhZ2U8L2E+LjwvcD4KCgk8cD5Db250cmlidXRvcnM6IEFu
ZHkgQ2FydGVyLCBQaGlsIFdhcmVoYW0gYW5kIFRvbW15IFNjaG11Y2tlci48L3A+CgoJPHA+
VGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly9tYW5mcmUubmV0LyI+TWljaGFlbCBNYW5mcmU8
L2E+IGZvciBpbnNwaXJhdGlvbiBmb3IgdGhlIGFydGljbGUgdHdlZXQgcGFydCBvZiB0aGlz
IHBsdWdpbiBiYXNlZCBvbiBoaXMgPHNwYW4gY2xhc3M9InRhZyI+bWVtX3R3aXR0ZXI8L3Nw
YW4+IHBsdWdpbi4gIEFkZGl0aW9uYWwgdGhhbmtzIHRvIHRoZSBncmVhdCBUZXh0cGF0dGVy
biBjb21tdW5pdHkgZm9yIGhlbHBpbmcgdG8gdGVzdCB0aGlzIHBsdWdpbiBhbmQgZm9yIHN1
Z2dlc3RpbmcgbmV3IGZlYXR1cmVzLiBUaGUgT0F1dGggcGFydCBvZiB0aGUgcGx1Z2luIGlz
IHRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vdHdpdHRlci5jb20vYWJyYWhhbSI+QWJyYWhh
bSBXaWxsaWFtczwvYT4uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248L2gyPgoK
CTxwPlRvIGluc3RhbGwgZ28gdG8gdGhlICYjODIxNjtwbHVnaW5zJiM4MjE3OyB0YWIgdW5k
ZXIgJiM4MjE2O2FkbWluJiM4MjE3OyBhbmQgcGFzdGUgdGhlIHBsdWdpbiBjb2RlIGludG8g
dGhlICYjODIxNjtJbnN0YWxsIHBsdWdpbiYjODIxNzsgYm94LCAmIzgyMTY7dXBsb2FkJiM4
MjE3OyBhbmQgdGhlbiAmIzgyMTY7aW5zdGFsbCYjODIxNzsuIFRoZSBwbHVnaW4gd2lsbCBi
ZSBhdXRvbWF0aWNhbGx5IGFjdGl2YXRlZC48L3A+CgoJPHA+QmVmb3JlIHlvdSBzdGFydCB1
c2luZyA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4geW91IHdpbGwgbmVl
ZCB0byBtYWtlIHN1cmUgdGhhdCB0aGUgY2FjaGUgZGlyZWN0b3J5IGlzIHdyaXRhYmxlLiBT
ZWUgdGhlICYjODIxNjtDYWNoaW5nJiM4MjE3OyBzdWJzZWN0aW9uIGJlbG93IGZvciBmdXJ0
aGVyIGluZm9ybWF0aW9uLjwvcD4KCgk8cD48c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRl
cjwvc3Bhbj4gc2hvdWxkIG5vdyBiZSByZWFkeSBmb3IgdXNlIG9uIHRoZSBwdWJsaWMtc2lk
ZSBvZiB5b3VyIHNpdGUuPC9wPgoKCTxwPlRvIHVubG9jayB0aGUgYWRtaW4gZmVhdHVyZXMg
b2YgdGhpcyBwbHVnaW4geW91IHdpbGwgbmVlZCB0byBhc3NvY2lhdGUgeW91ciBzaXRlIHdp
dGggYSBUd2l0dGVyIGFjY291bnQgYnkgY29ubmVjdGluZyB0byBUd2l0dGVyIGZyb20gdGhl
IHBsdWdpbiYjODIxNztzIG9wdGlvbnMgc2NyZWVuLiBDbGljayBvbiB0aGUgbGluayB0byBj
b25uZWN0IHRvIFR3aXR0ZXIsIHlvdSB3aWxsIGJlIGFza2VkIHRvIGxvZ2luIHRvIFR3aXR0
ZXIsIGNsaWNraW5nIHRoaXMgbGluayB3aWxsIHRlbXBvcmFyaWx5IHRha2UgeW91IHRvIHRo
ZSBUd2l0dGVyIHNpdGUgd2hlcmUgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gYW5kIGFw
cHJvdmUgYWNjZXNzIGZvciA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB0
byByZWFkIGFuZCB3cml0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gSWYgYWxsIGlzIHN1
Y2Nlc3NmdWwgeW91IHdpbGwgYmUgcmV0dXJuZWQgdG8gdGhlIG9wdGlvbnMgc2NyZWVuIGFu
ZCB5b3VyIHVzZXIgbmFtZSB3aWxsIGFwcGVhci48L3A+CgoJPHA+QXQgYW55IHRpbWUgeW91
IGNhbiBkaXNhc3NvY2lhdGUgeW91ciBUd2l0dGVyIGFjY291bnQgd2l0aCA8c3BhbiBjbGFz
cz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB2aWEgeW91ciBUd2l0dGVyIGFjY291bnQgcHJl
ZmVyZW5jZXMgb24gdGhlIDxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXIgd2Vic2l0ZTwvYT4uPC9wPgoKCTxwPlRvIHVuaW5zdGFsbCA8c3BhbiBjbGFzcz0idGFn
Ij5hcmNfdHdpdHRlcjwvc3Bhbj4gc2ltcGx5IGRlbGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhl
ICYjODIxNjtQbHVnaW5zJiM4MjE3OyB0YWIuICBUaGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVn
aW4gY29kZSwgZGVsZXRlIHJlbGF0ZWQgcHJlZmVyZW5jZXMgYW5kIGRyb3AgdGhlIDxzcGFu
IGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB0YWJsZSBmcm9tIHlvdXIgVGV4dHBh
dHRlcm4gZGF0YWJhc2UuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsg
LyZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0
cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3Ro
PgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4K
CQkJPHRkPlR3aXR0ZXIgdXNlciBuYW1lPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIg
dXNlcm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVv
dDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+cmV0d2VldHM8L3RkPgoJCQk8dGQ+MSB0
byBpbmNsdWRlIHJldHdlZXRzLCAwIHRvIGV4Y2x1ZGUgdGhlbSBmcm9tIHRoZSBmZWVkPC90
ZD4KCQkJPHRkPjA8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+cmVwbGllczwvdGQ+CgkJ
CTx0ZD4xIHRvIGluY2x1ZGUgcmVwbGllcywgMCB0byBleGNsdWRlIHRoZW0gZnJvbSB0aGUg
ZmVlZDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90
ZD4KCQkJPHRkPk1heGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIw
MCk8L3RkPgoJCQk8dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+ZmV0Y2g8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1i
ZXIgb2YgdHdlZXRzIHRvIHJldHJpZXZlIGZyb20gVHdpdHRlciAobWF4LiAyMDApPHN1cCBj
bGFzcz0iZm9vdG5vdGUiPjxhIGhyZWY9IiNmbjI5OTk1MDg4OTUyOTc5NzlkYmM1ZjIiPjE8
L2E+PC9zdXA+PC90ZD4KCQkJPHRkPjA8L3RkPgoJCQk8dGQ+ZmV0Y2g9JnF1b3Q7NTAmcXVv
dDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5G
b3JtYXQgdGhhdCB1cGRhdGUgZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxl
bT5BcmNoaXZlIGRhdGUgZm9ybWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVv
dDslYiAlT2UsICVJOiVNICVwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxh
YmVsPC90ZD4KCQkJPHRkPkxhYmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJ
PHRkPiA8ZW0+bm8gbGFiZWw8L2VtPjwvdGQ+CgkJCTx0ZD5sYWJlbD0mcXVvdDtNeSBUd2l0
dGVyIHRpbWVsaW5lJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFn
PC90ZD4KCQkJPHRkPkluZGVwZW5kZW50IHdyYXB0YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRk
PiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5sYWJlbHRhZz0mcXVvdDtoMyZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5icmVhazwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFz
cz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgKHdp
dGhvdXQgYnJhY2tldHMpLCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0
ZXM8L3RkPgoJCQk8dGQ+bGk8L3RkPgoJCQk8dGQ+YnJlYWs9JnF1b3Q7YnImcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3JhcHRhZzwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFz
cz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgdG8g
YmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0czwvdGQ+CgkJCTx0ZD4g
PGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+d3JhcHRhZz0mcXVvdDt1bCZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0i
Y2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJp
YnV0ZSBmb3Igd3JhcHRhZzwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlcjwvdGQ+CgkJCTx0ZD5j
bGFzcz0mcXVvdDt0d2l0dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNs
YXNzX3Bvc3RlZDwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9
ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNw
YW4gdGFnIGFyb3VuZCBwb3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0
ZWQ8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxwIGlkPSJmbjI5OTk1MDg4OTUyOTc5Nzlk
YmM1ZjIiIGNsYXNzPSJmb290bm90ZSI+PHN1cD4xPC9zdXA+IFR3aXR0ZXImIzgyMTc7cyA8
c3BhbiBjbGFzcz0iY2FwcyI+QVBJPC9zcGFuPiBjb3VudHMgdGhlIG51bWJlciBvZiB0d2Vl
dHMgdG8gcmV0dXJuIGJlZm9yZSBhcHBseWluZyBzb21lIG9mIHRoZSBmaWx0ZXJzLCBzbyB0
aGUgcmVzcG9uc2UgY2FuIGJlIGZld2VyIHR3ZWV0cyB0aGFuIGV4cGVjdGVkLiBUbyBoZWxw
IGF2b2lkIHRoaXMgeW91IGNhbiBzZXQgYSA8ZW0+ZmV0Y2g8L2VtPiBsaW1pdCB0aGF0IGlz
IGhpZ2hlciB0aGFuIHRoZSBkaXNwbGF5IDxlbT5saW1pdDwvZW0+IHRoYXQgeW91IHdhbnQg
dG8gb3V0cHV0LiBJZiA8ZW0+ZmV0Y2g8L2VtPiBpcyBsZXNzIHRoYW4gPGVtPmxpbWl0PC9l
bT4gdGhlIGxhdHRlciB3aWxsIGJlIHVzZWQgaW5zdGVhZC48L3A+CgoJPGgzPkV4YW1wbGUg
dXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXIgdXNlcj0mcXVvdDtkcm1vbmtl
eW5pbmphJnF1b3Q7IGxpbWl0PSZxdW90OzUmcXVvdDsgd3JhcHRhZz0mcXVvdDt1bCZxdW90
OyBicmVhaz0mcXVvdDtsaSZxdW90OyBkYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0g
JXAmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBidWxsZXQgcG9pbnQgbGlzdCBv
ZiB0aGUgbGFzdCA1IFR3aXR0ZXIgdXBkYXRlcyBmcm9tIGRybW9ua2V5bmluamEmIzgyMTc7
cyBUd2l0dGVyIGZlZWQgd2l0aCBhIGRlZmluZWQgZGF0ZSBmb3JtYXQgdG8gb3ZlcnJpZGUg
dGhlIGRlZmF1bHQgYXJjaGl2ZSBkYXRlIGZvcm1hdC48L3A+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+VGhlIGFyY190d2l0dGVyX3NlYXJj
aCB0YWc8L2gyPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJf
c2VhcmNoIGhhc2h0YWdzPSZxdW90O3R4cCZxdW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8
L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVz
Y3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnNlYXJjaDwvdGQ+CgkJCTx0ZD5Db21tYSBzZXBhcmF0
ZWQgbGlzdCBvZiBzZWFyY2ggd29yZHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPnNlYXJjaD0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+aGFzaHRhZ3M8L3RkPgoJCQk8dGQ+Q29tbWEgc2VwYXJhdGVk
IGxpc3Qgb2YgaGFzaHRhZ3MgdG8gc2VhcmNoIGZvciAobm90IGluY2x1ZGluZyB0aGUgaGFz
aCk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPmhhc2h0YWdzPSZx
dW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5y
ZXBseTwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB0d2VldHMgaW4gcmVwbHkgdG88L3RkPgoJ
CQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnJlcGx5PSZxdW90O3R3aXR0ZXIm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bWVudGlvbjwvdGQ+CgkJCTx0ZD5V
c2VybmFtZSBvZiB1c2VyIG1lbnRpb25lZCBpbiB0d2VldHMgKDxpPmkuZS48L2k+IHR3ZWV0
cyBjb250YWluaW5nIEB1c2VybmFtZSk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPm1lbnRpb249JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51bWJlciBvZiB0d2VldHMg
dG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJPHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0
PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8
L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90
ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZvcm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRh
dGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5MYWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUg
bGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVsPC9lbT48L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQgd3JhcHRhZyBmb3Ig
bGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFz
cz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyksIG9y
IHN0cmluZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNs
YXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0
byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRk
PiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwvdGQ+CgkJCTx0ZD5hcmNf
dHdpdHRlcl9zZWFyY2g8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfdXNlcjwv
dGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwv
c3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3Vu
ZCB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItdXNlcjwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNh
cHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1
dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9zdGVkIGRhdGU8L3RkPgoJCQk8dGQ+
YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8aDM+RXhhbXBs
ZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggc2VhcmNoPSZx
dW90O3BsdWdpbiZxdW90OyBoYXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDsg
bGltaXQ9JnF1b3Q7MjUmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBsaXN0IG9m
IHR3ZWV0cyBjb250YWluaW5nIHRoZSB3b3JkICYjODIxNjtwbHVnaW4mIzgyMTc7IGFuZCB0
aGUgaGFzaHRhZ3MgJiM4MjE2OyN0eHAmIzgyMTc7IGFuZCAmIzgyMTY7I3RleHRwYXR0ZXJu
JiM4MjE3Oy4gVGhlIHRhZyB3aWxsIHJldHVybiBhIG1heGltdW0gb2YgMjUgdHdlZXRzLjwv
cD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9yZXR3ZWV0X3RhZyI+
VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiB0YWc8L2gyPgoKCTxwPk91dHB1dHMgdGhl
IFR3aXR0ZXIgdHdlZXQgYnV0dG9uIChmb3JtZXJseSAmbHQ7dHhwOmFyY190d2l0dGVyX3Jl
dHdlZXQgLyZndDspLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3R3ZWV0X2J1dHRvbiAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJs
ZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3Ro
PgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWUgdG8gcXVvdGU8
L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRk
PnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD51cmw8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJj
YXBzIj5VUkw8L3NwYW4+PC9zcGFuPiB0byB0d2VldDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD50ZXh0PC90ZD4KCQkJPHRkPlR3ZWV0IHRleHQ8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Zm9sbG93MTwvdGQ+CgkJCTx0ZD5TdWdnZXN0ZWQgVHdpdHRlciBhY2NvdW50IHRv
IGZvbGxvdywgZm9yIGV4YW1wbGUgeW91ciBvd248L3RkPgoJCQk8dGQ+QSBUd2l0dGVyIHVz
ZXIgdG8gcmVjb21tZW5kPC90ZD4KCQkJPHRkPmZvbGxvdzE9JnF1b3Q7VGV4dHBhdHRlcm4m
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93MjwvdGQ+CgkJCTx0ZD5B
cyBmb2xsb3cxPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxhbmd1YWdlPC90ZD4KCQkJPHRkPmVuPC90
ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+Q291bnQgYm94IHBvc2l0aW9uLCBvcHRpb25zOiBub25l
LCBob3Jpem9udGFsIG9yIHZlcnRpY2FsPC90ZD4KCQkJPHRkPmhvcml6b250YWw8L3RkPgoJ
CQk8dGQ+Y291bnQ9JnF1b3Q7bm9uZSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5pbmNsdWRlX2pzPC90ZD4KCQkJPHRkPldoZXRoZXIgb3Igbm90IHRvIGluY2x1ZGUgdGhl
IHdpZGdldCBKYXZhU2NyaXB0PC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9q
cz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPm9wdGltaXNlX2pz
PC90ZD4KCQkJPHRkPk9wdGltaXNlIHRoZSBKYXZhU2NyaXB0IGJ5IHVzaW5nIGEgbG9jYWwg
c2NyaXB0IHJhdGhlciB0aGFuIHRoYXQgaG9zdGVkIG9uIHRoZSBUd2l0dGVyIHNpdGU8L3Rk
PgoJCQk8dGQ+MDwvdGQ+CgkJCTx0ZD5vcHRpbWlzZV9qcz0mcXVvdDsxJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJj
YXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmli
dXRlIGFwcGxpZWQgdG8gdGhlIHR3ZWV0IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVyLXNo
YXJlLWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9u
IiBpZD0iYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl9m
b2xsb3dfYnV0dG9uIHRhZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUgVHdpdHRlciBmb2xsb3cg
YnV0dG9uIChhbiBhbHRlcm5hdGl2ZSB2ZXJzaW9uIGlzIGluY2x1ZGVkIGluIGFyY190d2l0
dGVyX2ludGVudHMpLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX2ZvbGxvd19idXR0b24gLyZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFi
bGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90
aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNlciBuYW1lIHRvIGZvbGxv
dzwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHVzZXJuYW1lPC9lbT48L3RkPgoJCQk8
dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3VhZ2U8L3RkPgoJCQk8dGQ+ZW48L3RkPgoJ
CQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5j
b3VudDwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0aGUgZm9sbG93ZXIgY291bnQgaXMg
c2hvd248L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDswJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hldGhl
ciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3JpcHQ8L3RkPgoJCQk8dGQ+
MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0aW1pc2UgdGhlIEphdmFT
Y3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRoYW4gdGhhdCBob3N0ZWQg
b24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQkJPHRkPm9wdGltaXNl
X2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3Rk
PgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3Nw
YW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgZm9sbG93IGJ1dHRv
bjwvdGQ+CgkJCTx0ZD50d2l0dGVyLWZvbGxvdy1idXR0b248L3RkPgoJCTwvdHI+Cgk8L3Rh
YmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3R3ZWV0X3VybCI+
YXJjX3R3aXR0ZXJfdHdlZXRfdXJsPC9oMj4KCgk8cD5SZXR1cm5zIHRoZSA8c3BhbiBjbGFz
cz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgVHdpdHRlciBzdGF0dXMgZm9yIGFuIGFydGlj
bGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdl
ZXRfdXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdlZXRfdXJsJmd0
O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCZndDs8L3A+CgoJPGgz
PlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJ
PHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBs
ZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+CgkJCTx0ZD5UZXh0cGF0dGVy
biBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVudCBhcnRpY2xlPC9lbT48L3Rk
PgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD50
aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2YgdGhlIGxpbms8L3RkPgoJCQk8
dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90
ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9z
cGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIGxpbms8L3RkPgoJ
CQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xh
c3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90aW55dXJsIj5hcmNfdHdpdHRlcl90aW55
dXJsPC9oMj4KCgk8cD5SZXR1cm5zIHRoZSBzaG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMi
PlVSTDwvc3Bhbj4gb2YgdGhlIGFydGljbGUgdXNlZCBmb3IgdGhlIFR3aXR0ZXIgdXBkYXRl
LjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3Rpbnl1
cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0O0xpbmsg
dGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3Rpbnl1cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNs
ZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRk
PmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3Rk
PgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3Nw
YW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8
ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvaDI+CgoJPHA+SW4gb3Jk
ZXIgdG8gcHJldmVudCBleGNlc3NpdmUgcmVwZWF0aXRpdmUgY2FsbHMgdG8gdGhlIFR3aXR0
ZXIgd2Vic2l0ZSBpdCBpcyByZWNvbW1lbmRlZCB0byBjYWNoZSByZXN1bHRzLiBUd2l0dGVy
IGxpbWl0cyB0aGUgbnVtYmVyIG9mIGNhbGxzIHRocm91Z2ggdGhlIDxzcGFuIGNsYXNzPSJj
YXBzIj5BUEk8L3NwYW4+LCBhbmQgY29udGludW91cyBjYWxscyB3aWxsIHJlc3VsdCBpbiBU
d2l0dGVyIGNsb3NpbmcgdG8gZnVydGhlciByZXF1ZXN0cy4gQnkgZGVmYXVsdCwgYXJjX3R3
aXR0ZXIgY2FjaGVzIGZvciAzMCBtaW51dGUgaW50ZXJ2YWxzLjwvcD4KCgk8dGFibGU+CgkJ
PHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJ
PHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5jYWNoaW5nPC90ZD4KCQkJPHRkPiYjODIxNjsxJiM4MjE3OyB0byBjYWNoZSBmZWVk
LCAmIzgyMTY7MCYjODIxNzsgdG8gdHVybiBjYWNoaW5nIG9mZiAobm90IHJlY29tbWVuZGVk
KTwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmNhY2hpbmc9JnF1b3Q7MSZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV9kaXI8L3RkPgoJCQk8dGQ+QWJzb2x1dGUg
cGF0aCB0byB0aGUgY2FjaGUgZGlyZWN0b3J5IChtdXN0IGJlIHdyaXRhYmxlKTwvdGQ+CgkJ
CTx0ZD4gPGVtPmFyY190d2l0dGVyIHByZWZlcmVuY2VzPC9lbT48L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+Y2FjaGVfdGltZTwvdGQ+CgkJCTx0ZD5UaW1lIGluIG1pbnV0ZXMgdGhh
dCB0aGUgY2FjaGUgZmlsZXMgYXJlIHN0b3JlZCBiZWZvcmUgYmVpbmcgcmVmcmVzaGVkPC90
ZD4KCQkJPHRkPjU8L3RkPgoJCQk8dGQ+Y2FjaGVfdGltZT0mcXVvdDszMCZxdW90OzwvdGQ+
CgkJPC90cj4KCTwvdGFibGU+CgoJPHA+VGhlIGFkbWluIHNpZGUgb2YgdGhpcyBwbHVnaW4g
ZW5mb3JjZXMgY2FjaGluZywgYXBhcnQgZnJvbSB3aGVuIGl0IGlzIHBvc3RpbmcgdG8gVHdp
dHRlciAoPGk+ZS5nLjwvaT4gd2hlbiBwb3N0aW5nIG9yIGRlbGV0aW5nIGFuIHVwZGF0ZSku
PC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3ByZWZzIj5QcmVm
ZXJlbmNlczwvaDI+CgoJPHA+WW91IGNhbiBhY2Nlc3MgdGhlIHBsdWdpbnMgY29yZSBwcmVm
ZXJlbmNlcyBmcm9tIGVpdGhlciB0aGUgUHJlZmVyZW5jZXMgb3IgUGx1Z2lucyB0YWJzIGlu
IGFkbWluLiBTZXR1cCB5b3VyIFR3aXR0ZXIgYWNjb3VudCAoeW91IHdpbGwgYmUgYXNrZWQg
dG8gY29ubmVjdCB2aWEgVHdpdHRlciBhbmQgdGhpcyBuZWVkcyBkb2luZyBiZWZvcmUgeW91
IGNhbiB1c2UgdGhlIHBsdWdpbikgYW5kIGNoYW5nZSB0aGUgY2FjaGUgZGlyZWN0b3J5IHVz
aW5nIGFyY190d2l0dGVyJiM4MjE3O3MgcHJlZmVyZW5jZXMuIFdpdGhvdXQgcHJvdmlkaW5n
IHlvdXIgYWNjb3VudCBsb2dpbiBkZXRhaWxzIHRoZSBhZG1pbiBhcmVhIGZlYXR1cmVzIG9m
IHRoaXMgcGx1Z2luIHdpbGwgYmUgaW5hY3RpdmUuPC9wPgoKCTxwPllvdSBjYW4gc2VsZWN0
IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBzaG9ydGVuZXIgbWV0aG9kIHlv
dSB3YW50IHRvIHVzZSB0byBsaW5rIGJhY2sgdG8geW91ciBhcnRpY2xlIG9uIFR3aXR0ZXIu
IFBsZWFzZSBub3RlIHRoYXQgaWYgeW91IHNlbGVjdCBzbWRfc2hvcnRfdXJsIHlvdSB3aWxs
IG5lZWQgdG8gaGF2ZSBpbnN0YWxsZWQgYW5kIGFjdGl2YXRlZCB0aGUgPGEgaHJlZj0iaHR0
cDovL3RleHRwYXR0ZXJuLm9yZy9wbHVnaW5zLzEwOTkvc21kX3Nob3J0X3VybCI+PHNwYW4g
Y2xhc3M9InRhZyI+c21kX3Nob3J0X3VybDwvc3Bhbj4gcGx1Z2luPC9hPiBkZXZlbG9wZWQg
YnkgU3RlZiBEYXdzb24uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9oMj4KCgk8cD5CeSBkZWZhdWx0IGFy
Y190d2l0dGVyIHdpbGwgcG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRlciBpbmNsdWRpbmcgYSBz
aG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gdG8geW91ciBhcnRpY2xl
LiBPbmx5IGxpdmUgYW5kIGFjdGl2ZSBhcnRpY2xlcyB3aWxsIGJlIHNlbnQgdG8gVHdpdHRl
ciwgPGk+aS5lLjwvaT4gYXJ0aWNsZXMgcG9zdGVkIGluIHRoZSBmdXR1cmUgb3IgYXMgc3Rp
Y2t5IGFydGljbGVzIHdpbGwgbm90IGJlIHNlbnQuIElmIHlvdXIgYXJ0aWNsZSBpcyBzdWNj
ZXNzZnVsbHkgc3VibWl0dGVkIHRvIFR3aXR0ZXIgdGhlIHVwZGF0ZSB3aWxsIGFwcGVhciBp
biBwbGFjZSBvZiB0aGUgVHdpdHRlciBvcHRpb24gb24gdGhlIHJpZ2h0LWhhbmQtc2lkZSBv
ZiB0aGUgYXJ0aWNsZSBlZGl0IHNjcmVlbi48L3A+CgoJPHA+VHdlZXRzIGFyZSBzZW50IGlu
IHRoZSBmb2xsb3dpbmcgZm9ybWF0OiA8ZW0+VHdlZXQgcHJlZml4PC9lbT4gPGVtPkFydGlj
bGUgdGl0bGU8L2VtPiA8ZW0+U2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3Nw
YW4+PC9lbT4gPGVtPlR3ZWV0IHN1ZmZpeDwvZW0+LiBZb3UgY2FuIGNoYW5nZSB0aGUgcHJl
Zml4IGFuZCBzdWZmaXggb24gYW4gYXJ0aWNsZS1ieS1hcnRpY2xlIGJhc2lzIGJ5IGNoYW5n
aW5nIHRoZSB0d2VldCBvcHRpb25zIHVuZGVyICYjODIxNjtVcGRhdGUgVHdpdHRlciYjODIx
Nzsgb24gdGhlIGFydGljbGUgZWRpdG9yIHNjcmVlbi4gVGhlIGRlZmF1bHQgPGVtPlR3ZWV0
IHByZWZpeDwvZW0+IGNhbiBiZSBzZXQgdW5kZXIgdGhlIDxzcGFuIGNsYXNzPSJ0YWciPmFy
Y190d2l0dGVyPC9zcGFuPiBwcmVmZXJlbmNlcyBzY3JlZW4gKHRoZSBkZWZhdWx0IG9uIGlu
c3RhbGxhdGlvbiBpcyAmIzgyMjA7SnVzdCBwb3N0ZWQ6JiM4MjIxOykuPC9wPgoKCTxwPlBs
ZWFzZSBub3RlIHRoYXQgb25jZSBhbiBhcnRpY2xlIGhhcyBiZWVuIHR3ZWV0ZWQgdGhlIHR3
ZWV0IGNhbm5vdCBiZSBlZGl0ZWQuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFy
Y190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8L2gyPgoKCTxwPlVuZGVyIHRoZSBF
eHRlbnNpb25zIHRhYiAodGhpcyBjYW4gYmUgY2hhbmdlZCBmcm9tIHRoZSBwbHVnaW4mIzgy
MTc7cyBwcmVmZXJlbmNlIHBhZ2UpIGEgbmV3IFR3aXR0ZXIgdGFiIHNob3VsZCBhcHBlYXIg
b25jZSB5b3UgaGF2ZSBjb25uZWN0ZWQgeW91ciBzaXRlIHRvIHlvdXIgVHdpdHRlciBhY2Nv
dW50LiBGcm9tIGhlcmUgeW91IHdpbGwgYmUgYWJsZSB0byBzdWJtaXQgbmV3IFR3aXR0ZXIg
dXBkYXRlcywgdmlldyBiYXNpYyBhY2NvdW50IHN0YXRpc3RpY3MsIGFuZCBjaGVjayBvdXQg
eW91ciByZWNlbnQgdXBkYXRlcyAoaW5jbHVkaW5nIHRoZSBvcHRpb24gdG8gZGVsZXRlIHlv
dXIgdHdlZXRzKS48L3A+IjtzOjQ6ImNvZGUiO3M6NzczNDk6Imdsb2JhbCAkcHJlZnMsJHR4
cGNmZywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0OwoKJGFyY190d2l0dGVyID0gYXJyYXkoKTsKCiRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSA9ICduS2NYc2x3elpoQmQwa2ZLTWV0blBBJzsKJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0ID0gJ0M2blNQQ0wzZWVIR1RCaEtDZ3dkOW9jbGN1RDBzckI4V1ZrZlhRWUM1NCc7Cgph
ZGRfcHJpdnMoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicsJzEsMicpOwpyZWdpc3Rlcl9j
YWxsYmFjaygnYXJjX3R3aXR0ZXJfaW5zdGFsbCcsJ3BsdWdpbl9saWZlY3ljbGUuYXJjX3R3
aXR0ZXInLCAnaW5zdGFsbGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl91
bmluc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywgJ2RlbGV0ZWQnKTsK
cmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3ByZWZzJywncGx1Z2luX3ByZWZzLmFy
Y190d2l0dGVyJyk7CgovKgogKiBTZXR1cCBpbml0aWFsIHByZWZlcmVuY2VzIGlmIG5vdCBp
biB0aGUgdHhwX3ByZWZzIHRhYmxlLgogKi8KaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0
dGVyX3VzZXInXSkpCiAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXNlcicsICcnLCAnYXJj
X3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3
aXR0ZXJfcHJlZml4J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9wcmVmaXgnLCdKdXN0
IHBvc3RlZDonLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0
KCRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl9zdWZmaXgnLCcnLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1dCcpOwppZiAoIWlz
c2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10pKQogIHNldF9wcmVmKCdhcmNf
dHdpdHRlcl9jYWNoZV9kaXInLCR0eHBjZmdbJ3R4cGF0aCddLiRwcmVmc1sndGVtcGRpcidd
LCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0KCRwcmVmc1sn
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
dHdlZXRfZGVmYXVsdCcsIDEsICdhcmNfdHdpdHRlcicsIDIsICd5ZXNub1JhZGlvJyk7Cmlm
ICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ10pKQogIHNldF9wcmVm
KCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywgJ3Rpbnl1cmwnLCAnYXJjX3R3aXR0ZXInLCAy
LAogICAgJ2FyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0Jyk7CmlmICghaXNzZXQoJHBy
ZWZzWydhcmNfc2hvcnRfdXJsJ10pKQogIHNldF9wcmVmKCdhcmNfc2hvcnRfdXJsJywgMCwg
J2FyY190d2l0dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2Fy
Y19zaG9ydF9zaXRlX3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0X3NpdGVfdXJsJywg
JHByZWZzWydzaXRldXJsJ10sICdhcmNfdHdpdHRlcicsIDIsICd0ZXh0X2lucHV0Jyk7Ci8v
IE1ha2Ugc3VyZSB0aGF0IHRoZSBUd2l0dGVyIHRhYiBoYXMgYmVlbiBkZWZpbmVkCmlmICgh
aXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSkpIHsKICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfdGFiJywgJ2V4dGVuc2lvbnMnLCAnYXJjX3R3aXR0ZXInLCAyLAogICAgJ2FyY190
d2l0dGVyX3RhYl9zZWxlY3QnKTsKICAgICRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10gPSAn
ZXh0ZW5zaW9ucyc7Cn0KCi8vIENoZWNrIGlmIGFyY19zaG9ydF91cmwgaXMgZW5hYmxlZApp
ZiAoKGlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3VybCddKSYmJHByZWZzWydhcmNfc2hvcnRf
dXJsJ10pCnx8IChpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmxfbWV0aG9kJ10pJiYkcHJl
ZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXT09J2FyY190d2l0dGVyJykpIHsKICByZWdp
c3Rlcl9jYWxsYmFjaygnYXJjX3Nob3J0X3VybF9yZWRpcmVjdCcsICd0eHBfZGllJywgNDA0
KTsKfQoKaWYgKEB0eHBpbnRlcmZhY2UgPT0gJ2FkbWluJykgewogICAgcmVnaXN0ZXJfY2Fs
bGJhY2soJ19hcmNfdHdpdHRlcl9hdXRvX2VuYWJsZScsICdwbHVnaW5fbGlmZWN5Y2xlLmFy
Y190d2l0dGVyJywgJ2luc3RhbGxlZCcpOwogICAgaWYgKCFlbXB0eSgkcHJlZnNbJ2FyY190
d2l0dGVyX3VzZXInXSkKICAgICAgICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbiddKQogICAgICAgICYmICFlbXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX2Fj
Y2Vzc1Rva2VuU2VjcmV0J10pICkgewoKICAgICAgICBpZiAoJHByZWZzWydhcmNfdHdpdHRl
cl90YWInXSkgewogICAgICAgICAgICBhZGRfcHJpdnMoJ2FyY19hZG1pbl90d2l0dGVyJywg
JzEsMiwzLDQnKTsKICAgICAgICAgICAgcmVnaXN0ZXJfdGFiKCRwcmVmc1snYXJjX3R3aXR0
ZXJfdGFiJ10sICdhcmNfYWRtaW5fdHdpdHRlcicsICdUd2l0dGVyJyk7CiAgICAgICAgICAg
IHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYWRtaW5fdHdpdHRlcicsICdhcmNfYWRtaW5fdHdp
dHRlcicpOwogICAgICAgIH0KCiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRp
Y2xlX3R3ZWV0JywgJ3BpbmcnKTsKICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2Fy
dGljbGVfdHdlZXQnLCAnYXJ0aWNsZV9zYXZlZCcpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxi
YWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlX3Bvc3RlZCcpOwogICAgICAgIHJl
Z2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5kX3R3aXR0ZXInLCAnYXJ0aWNsZV91aScsICdz
dGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1YmxpYy1zaWRlIGZ1bmN0aW9ucwogICAgPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3aXR0ZXIoJGF0dHMpCnsKICBnbG9iYWwgJHBy
ZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgJ3VzZXInICAgICAgPT4gJHByZWZz
WydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAncGFzc3dvcmQnICA9PiAnJywKICAgICd0aW1l
bGluZScgID0+ICd1c2VyJywKICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAgICAnZmV0Y2gn
ICAgICA9PiAwLAogICAgJ2Z1bGxfdXJscycgPT4gZmFsc2UsCiAgICAncmV0d2VldHMnICA9
PiBmYWxzZSwKICAgICdyZXBsaWVzJyAgID0+IHRydWUsCiAgICAnZGF0ZWZvcm1hdCc9PiAk
cHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgJ2NhY2hpbmcnICAgPT4gJzEnLAog
ICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAg
ICdjYWNoZV90aW1lJz0+ICc1JywKICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgJ2xhYmVs
dGFnJyAgPT4gJycsCiAgICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgJ3dyYXB0YWcnICAg
PT4gJycsCiAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAnY2xhc3NfcG9z
dGVkJyA9PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnCiAgICApLCRhdHRzKSk7CgogICR0d2l0
ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAg
ICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKCiAgaWYgKCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcs
IHJlY29tbWVuZGVkIChkZWZhdWx0KQogICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAg
ICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAkdHdpdC0+Y2FjaGVUaW1lKCRj
YWNoZV90aW1lKTsKICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29t
bWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICR0d2l0LT5zZXRDYWNoaW5nKGZh
bHNlKTsKICB9CgogIHN3aXRjaCAoJHRpbWVsaW5lKSB7CiAgICBjYXNlICdob21lJzogY2Fz
ZSAnZnJpZW5kcyc6CiAgICAgICR0aW1lbGluZSA9ICdob21lX3RpbWVsaW5lJzsgYnJlYWs7
CiAgICBjYXNlICdtZW50aW9ucyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9tZW50
aW9uc190aW1lbGluZSc7IGJyZWFrOwogICAgY2FzZSAndXNlcic6IGRlZmF1bHQ6ICR0aW1l
bGluZSA9ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJzsKICB9CgogIC8vIENoZWNrIHRoYXQg
dGhlIGZldGNoIChUd2l0dGVyJ3MgY291bnQgYXR0cmlidXRlKSBpcyBzZXQgY29ycmVjdGx5
CiAgJGZldGNoID0gKCEkZmV0Y2ggfHwgJGZldGNoPCRsaW1pdCkgPyAkbGltaXQgOiAkZmV0
Y2g7CgogICRvdXQgPSBhcnJheSgpOwogICR0d2VldHMgPSAkdHdpdC0+Z2V0KCR0aW1lbGlu
ZSwgYXJyYXkoCiAgICAgICdzY3JlZW5fbmFtZSc9PiR1c2VyLAogICAgICAnY291bnQnPT4k
ZmV0Y2gsCiAgICAgICdpbmNsdWRlX3J0cyc9PiRyZXR3ZWV0cywKICAgICAgJ2V4Y2x1ZGVf
cmVwbGllcyc9PiEkcmVwbGllcwogICAgKSk7CgogIGlmICgkdHdlZXRzKSB7CiAgICAvLyBB
cHBseSB0aGUgZGlzcGxheSBsaW1pdCB0byB0aGUgcmV0dXJuZWQgdHdlZXRzCiAgICAkdHdl
ZXRzID0gYXJyYXlfc2xpY2UoJHR3ZWV0cywgMCwgJGxpbWl0KTsKICAgIGZvcmVhY2ggKCR0
d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGll
cygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRk
YXRlZm9ybWF0LCR0aW1lKTsKICAgICAgJHR3ZWV0VGV4dCA9ICR0d2VldC0+dGV4dDsKICAg
ICAgaWYgKCRmdWxsX3VybHMgJiYgaXNzZXQoJHR3ZWV0LT5lbnRpdGllcy0+dXJscykpIHsK
ICAgICAgICBmb3JlYWNoICgkdHdlZXQtPmVudGl0aWVzLT51cmxzIGFzICR1cmwpIHsKICAg
ICAgICAgICRsaW5rc1skdXJsLT51cmxdID0gJHVybC0+ZXhwYW5kZWRfdXJsOwogICAgICAg
IH0KICAgICAgICAkdHdlZXRUZXh0ID0gc3RyX3JlcGxhY2UoCiAgICAgICAgICBhcnJheV9r
ZXlzKCRsaW5rcyksCiAgICAgICAgICBhcnJheV92YWx1ZXMoJGxpbmtzKSwKICAgICAgICAg
ICR0d2VldFRleHQKICAgICAgICApOwogICAgICB9CiAgICAgICRvdXRbXSA9IGFyY19Ud2l0
dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0d2VldFRleHQsIEVOVF9RVU9URVMsJ1VU
Ri04JykpCiAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRkYXRlKSwnc3BhbicsJyBj
bGFzcz0iJy4kY2xhc3NfcG9zdGVkLiciJyk7CiAgICB9CiAgfQoKICAgIHJldHVybiBkb0xh
YmVsKCRsYWJlbCwgJGxhYmVsdGFnKS5kb1dyYXAoJG91dCwgJHdyYXB0YWcsICRicmVhaywg
JGNsYXNzKTsKCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3NlYXJjaCgkYXR0cykKewogICAg
Z2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldDsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2Vy
JyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAgICAgICdzZWFyY2gn
ICAgID0+ICcnLAogICAgICAgICdoYXNodGFncycgID0+ICcnLAogICAgICAgICd1c2VyJyAg
ICAgID0+ICcnLAogICAgICAgICdyZXBseScgICAgID0+ICcnLAogICAgICAgICdtZW50aW9u
JyAgID0+ICcnLAogICAgICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAgICAgICAgJ2xhbmcn
ICAgICAgPT4gJycsCiAgICAgICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2Rh
dGVmb3JtYXQnXSwKICAgICAgICAnY2FjaGluZycgICA9PiAnMScsCiAgICAgICAgJ2NhY2hl
X2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAgICAgICAnY2Fj
aGVfdGltZSc9PiAnNScsCiAgICAgICAgJ2xhYmVsJyAgICAgPT4gJycsCiAgICAgICAgJ2xh
YmVsdGFnJyAgPT4gJycsCiAgICAgICAgJ2JyZWFrJyAgICAgPT4gJ2xpJywKICAgICAgICAn
d3JhcHRhZycgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18s
CiAgICAgICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLictcG9zdGVkJywKICAg
ICAgICAnY2xhc3NfdXNlcicgICA9PiBfX0ZVTkNUSU9OX18uJy11c2VyJwogICAgKSwkYXR0
cykpOwoKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29u
c3VtZXJLZXkKICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJl
ZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICwgJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKCiAgICAgICAgaWYgKCRjYWNoaW5nKSB7
ICAvLyB0dXJuIG9uIGNhY2hpbmcsIHJlY29tbWVuZGVkIChkZWZhdWx0KQogICAgICAgICAg
ICAkdHdpdC0+c2V0Q2FjaGluZyh0cnVlKTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlRGly
KCRjYWNoZV9kaXIpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVUaW1lKCRjYWNoZV90aW1l
KTsKICAgICAgICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29tbWVu
ZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICAgICAgICAgJHR3aXQtPnNldENhY2hp
bmcoZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gY29uc3RydWN0IHNlYXJjaCBxdWVy
eQogICAgICAgIGlmICghZW1wdHkoJHNlYXJjaCkpIHsKICAgICAgICAgICAgJHRlcm1zID0g
ZXhwbG9kZSgnLCcsJHNlYXJjaCk7ICR0ZXJtcyA9IGFycmF5X21hcCgndHJpbScsJHRlcm1z
KTsKICAgICAgICAgICAgJHNlYXJjaCA9IGltcGxvZGUoJyAnLCR0ZXJtcyk7CiAgICAgICAg
fQogICAgICAgIGlmICgkaGFzaHRhZ3MpIHsKICAgICAgICAgICAgJGhhc2hlcyA9IGV4cGxv
ZGUoJywnLCRoYXNodGFncyk7ICRoYXNoZXMgPSBhcnJheV9tYXAoJ3RyaW0nLCRoYXNoZXMp
OwogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLicjJy5pbXBsb2Rl
KCcgIycsJGhhc2hlcyk7CiAgICAgICAgfQogICAgICAgIGlmICgkcmVwbHkpIHsKICAgICAg
ICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4ndG86Jy50cmltKCRyZXBseSk7
CiAgICAgICAgfQogICAgICAgIGlmICgkdXNlcikgewogICAgICAgICAgICAkc2VhcmNoLj0g
KCgkc2VhcmNoKT8nICc6JycpLidmcm9tOicudHJpbSgkdXNlcik7CiAgICAgICAgfQogICAg
ICAgIGlmICgkbWVudGlvbikgewogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8n
ICc6JycpLidAJy50cmltKCRtZW50aW9uKTsKICAgICAgICB9CgogICAgICAgIGlmIChlbXB0
eSgkc2VhcmNoKSkgewogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSBlbHNlIHsK
ICAgICAgICAgICAgJHNlYXJjaCA9IHVybGVuY29kZSgkc2VhcmNoKTsKICAgICAgICB9Cgog
ICAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICAgICRyZXN1bHRzID0gJHR3aXQtPmdldCgn
c2VhcmNoL3R3ZWV0cycKICAgICAgICAgICAgLCBhcnJheSgncSc9PiRzZWFyY2gsJ2NvdW50
Jz0+JGxpbWl0LCdsYW5nJz0+JGxhbmcpKTsKCiAgICAgICAgJHR3ZWV0cyA9ICRyZXN1bHRz
LT5zdGF0dXNlczsKICAgICAgICBpZiAoJHR3ZWV0cykgeyBmb3JlYWNoICgkdHdlZXRzIGFz
ICR0d2VldCkgewogICAgICAgICAgICAvLyBwcmVnX21hdGNoKCIvKC4qKSBcKCguKilcKS8i
LCR0d2VldC0+dXNlci0+c2NyZWVuX25hbWUsJG1hdGNoZXMpOwogICAgICAgICAgICAvLyBs
aXN0KCRhdXRob3IsJHVuYW1lLCRuYW1lKSA9ICRtYXRjaGVzOwogICAgICAgICAgICAkdW5h
bWUgPSAkdHdlZXQtPnVzZXItPnNjcmVlbl9uYW1lOwogICAgICAgICAgICAkbmFtZSA9ICR0
d2VldC0+dXNlci0+bmFtZTsKICAgICAgICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVu
dGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICAgICAkZGF0ZSA9IHNhZmVf
c3RyZnRpbWUoJGRhdGVmb3JtYXQsJHRpbWUpOwogICAgICAgICAgICAkdGV4dCA9ICR0d2Vl
dC0+dGV4dDsKICAgICAgICAgICAgJG91dFtdID0gdGFnKGhyZWYoaHRtbGVudGl0aWVzKCR1
bmFtZSksJ2h0dHA6Ly90d2l0dGVyLmNvbS8nIC4gJHR3ZWV0LT51c2VyLT5zY3JlZW5fbmFt
ZSwKICAgICAgICAgICAgICAgICcgdGl0bGU9IicuaHRtbGVudGl0aWVzKCRuYW1lKS4nIicp
Lic6ICcsJ3NwYW4nCiAgICAgICAgICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3Vz
ZXIuJyInKQogICAgICAgICAgICAgICAgLmFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVu
dGl0aWVzKCR0ZXh0LCBFTlRfUVVPVEVTLCdVVEYtOCcpKQogICAgICAgICAgICAgICAgLicg
Jy50YWcoaHRtbGVudGl0aWVzKCRkYXRlKSwnc3BhbicKICAgICAgICAgICAgICAgICAgICAs
JyBjbGFzcz0iJy4kY2xhc3NfcG9zdGVkLiciJyk7CiAgICAgICAgfSByZXR1cm4gZG9MYWJl
bCgkbGFiZWwsICRsYWJlbHRhZykKICAgICAgICAgICAgLmRvV3JhcCgkb3V0LCAkd3JhcHRh
ZywgJGJyZWFrLCAkY2xhc3MpOyB9Cgp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2VldCgk
YXR0cykgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFy
cmF5KAogICAgICAnaWQnICAgICAgICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAg
ICAnaW5jbHVkZV91cmwnICAgPT4gdHJ1ZQogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQp
IHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJv
bQogICAgICAkdHdlZXQgPSAoJGluY2x1ZGVfdXJsKSA/IHNhZmVfcm93KCJ0d2VldCIsICdh
cmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9IikKICAgICAgICA6IHNhZmVfcm93KCJS
RVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVybCksJycpIEFTIHR3ZWV0IgogICAgICAg
ICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlm
ICgkdHdlZXRbJ3R3ZWV0J10pIHsKICAgICAgcmV0dXJuIGFyY19Ud2l0dGVyOjptYWtlTGlu
a3MoCiAgICAgICAgaHRtbGVudGl0aWVzKCR0d2VldFsndHdlZXQnXSwgRU5UX1FVT1RFUywn
VVRGLTgnKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X3VybCgkYXR0
cywgJHRoaW5nPW51bGwpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGUsJHByZWZzOwoKICAg
IGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICA9PiAkdGhpc2FydGljbGVb
J3RoaXNpZCddLAogICAgICAndGl0bGUnICAgPT4gJycsCiAgICAgICdjbGFzcycgICA9PiAn
JwogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3
aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSBzYWZlX3Jv
dygidHdlZXRfaWQiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlk
fSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3R3ZWV0X2lkJ10pIHsKICAgICAgJHVybCA9
ICJodHRwOi8vdHdpdHRlci5jb20vIi4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXS4iL3N0
YXR1cy8iLiR0d2VldFsndHdlZXRfaWQnXTsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsK
ICAgICAgICByZXR1cm4gJHVybDsKICAgICAgfQogICAgICByZXR1cm4gaHJlZihwYXJzZSgk
dGhpbmcpLCAkdXJsLAogICAgICAgICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicg
OiAnJykKICAgICAgICAuKCRjbGFzcyA/ICcgY2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7
CiAgICB9Cn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3Rpbnl1cmwoJGF0dHMsICR0aGluZz1u
dWxsKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJy
YXkoCiAgICAgICdpZCcgICAgICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAn
dGl0bGUnICAgPT4gJycsCiAgICAgICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoK
ICAgIGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVp
bGQgdHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSBzYWZlX3JvdygidGlueXVybCIKICAgICAg
ICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYg
KCR0d2VldFsndGlueXVybCddKSB7CiAgICAgIGlmICgkdGhpbmc9PT1udWxsKSB7CiAgICAg
ICAgcmV0dXJuICR0d2VldFsndGlueXVybCddOwogICAgICB9CgogICAgICByZXR1cm4gaHJl
ZihwYXJzZSgkdGhpbmcpLCAkdHdlZXRbJ3Rpbnl1cmwnXSwKICAgICAgICAoJHRpdGxlID8g
JyB0aXRsZT0iJy4kdGl0bGUuJyInIDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNz
PSInLiRjbGFzcy4nIicgOiAnJykpOwogICAgfQp9CgovKgogKiBQdWJsaWMgdGFnIGZvciBv
dXRwdXR0aW5nIHdpZGdldCBKUwogKi8KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfd2lkZ2V0X2pz
KCRhdHRzKQp7CiAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAnb3B0aW1pc2UnID0+
IGZhbHNlCiAgICApLCRhdHRzKSk7CgogIHJldHVybiBfYXJjX3R3aXR0ZXJfd2lkZ2V0X2pz
KCRvcHRpbWlzZSk7Cn0KCmZ1bmN0aW9uIF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGlt
aXNlPXRydWUpCnsKICBnbG9iYWwgJGFyY190d2l0dGVyOwoKICAvLyBDaGVjayBpZiB3aWRn
ZXQgSlMgaGFzIGFscmVhZHkgYmVlbiBvdXRwdXQKICBpZiAoJGFyY190d2l0dGVyWyd3aWRn
ZXRfanMnXSkgcmV0dXJuOwoKICBpZiAoJG9wdGltaXNlPT1mYWxzZSkgewogICAgcmV0dXJu
ICc8c2NyaXB0IHNyYz0iaHR0cDovL3BsYXRmb3JtLnR3aXR0ZXIuY29tL3dpZGdldHMuanMi
IHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+JzsKICB9CgogICRqcyA9IDw8PEpT
CjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KKGZ1bmN0aW9uKCkgewogIGlmICh3
aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlcikgcmV0dXJuOwogIHZhciBpbnRlbnRSZWdl
eCA9IC90d2l0dGVyXC5jb20oXDpcZHsyLDR9KT9cL2ludGVudFwvKFx3KykvLAogICAgICB3
aW5kb3dPcHRpb25zID0gJ3Njcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsdG9vbGJhcj1u
byxsb2NhdGlvbj15ZXMnLAogICAgICB3aWR0aCA9IDU1MCwKICAgICAgaGVpZ2h0ID0gNDIw
LAogICAgICB3aW5IZWlnaHQgPSBzY3JlZW4uaGVpZ2h0LAogICAgICB3aW5XaWR0aCA9IHNj
cmVlbi53aWR0aDsKCiAgZnVuY3Rpb24gaGFuZGxlSW50ZW50KGUpIHsKICAgIGUgPSBlIHx8
IHdpbmRvdy5ldmVudDsKICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1l
bnQsCiAgICAgICAgbSwgbGVmdCwgdG9wOwoKICAgIHdoaWxlICh0YXJnZXQgJiYgdGFyZ2V0
Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdhJykgewogICAgICB0YXJnZXQgPSB0YXJn
ZXQucGFyZW50Tm9kZTsKICAgIH0KCiAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5ub2RlTmFt
ZS50b0xvd2VyQ2FzZSgpID09PSAnYScgJiYgdGFyZ2V0LmhyZWYpIHsKICAgICAgbSA9IHRh
cmdldC5ocmVmLm1hdGNoKGludGVudFJlZ2V4KTsKICAgICAgaWYgKG0pIHsKICAgICAgICBs
ZWZ0ID0gTWF0aC5yb3VuZCgod2luV2lkdGggLyAyKSAtICh3aWR0aCAvIDIpKTsKICAgICAg
ICB0b3AgPSAwOwoKICAgICAgICBpZiAod2luSGVpZ2h0ID4gaGVpZ2h0KSB7CiAgICAgICAg
ICB0b3AgPSBNYXRoLnJvdW5kKCh3aW5IZWlnaHQgLyAyKSAtIChoZWlnaHQgLyAyKSk7CiAg
ICAgICAgfQoKICAgICAgICB3aW5kb3cub3Blbih0YXJnZXQuaHJlZiwgJ2ludGVudCcsIHdp
bmRvd09wdGlvbnMgKyAnLHdpZHRoPScgKyB3aWR0aCArCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAnLGhlaWdodD0nICsgaGVpZ2h0ICsgJyxsZWZ0PScg
KyBsZWZ0ICsgJyx0b3A9JyArIHRvcCk7CiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNl
OwogICAgICAgIGUucHJldmVudERlZmF1bHQgJiYgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAg
ICB9CiAgICB9CiAgfQoKICBpZiAoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcikgewogICAg
ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVJbnRlbnQsIGZhbHNl
KTsKICB9IGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50KSB7CiAgICBkb2N1bWVudC5h
dHRhY2hFdmVudCgnb25jbGljaycsIGhhbmRsZUludGVudCk7CiAgfQogIHdpbmRvdy5fX3R3
aXR0ZXJJbnRlbnRIYW5kbGVyID0gdHJ1ZTsKfSgpKTsKPC9zY3JpcHQ+CkpTOwogICRhcmNf
dHdpdHRlclsnd2lkZ2V0X2pzJ10gPSB0cnVlOwogIHJldHVybiAkanM7Cn0KCi8vIERlcHJl
Y2F0ZWQgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWcsIHVzZSBhcmNfdHdpdHRlcl90d2VldF9i
dXR0b24gaW5zdGVhZApmdW5jdGlvbiBhcmNfdHdpdHRlcl9yZXR3ZWV0KCRhdHRzLCAkdGhp
bmc9bnVsbCkKewogIHJldHVybiBhcmNfdHdpdHRlcl90d2VldF9idXR0b24oJGF0dHMsICR0
aGluZz1udWxsKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2VldF9idXR0b24oJGF0dHMs
ICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1l
cktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwogICAgZ2xvYmFsICR0aGlzYXJ0
aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAgICAgICAg
PT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sIC8vIHZpYSB1c2VyIGFjY291bnQKICAg
ICAgICAndXJsJyAgICAgICAgID0+ICcnLAogICAgICAgICd0ZXh0JyAgICAgICAgPT4gJycs
CiAgICAgICAgJ2ZvbGxvdzEnICAgICA9PiAnJywKICAgICAgICAnZm9sbG93MicgICAgID0+
ICcnLAogICAgICAgICdsYW5nJyAgICAgICAgPT4gJycsCiAgICAgICAgJ2NvdW50JyAgICAg
ICA9PiAnaG9yaXpvbnRhbCcsCiAgICAgICAgJ2luY2x1ZGVfanMnICA9PiB0cnVlLAogICAg
ICAgICdvcHRpbWlzZV9qcycgPT4gZmFsc2UsCiAgICAgICAgJ3dyYXB0YWcnICAgICA9PiAn
JywKICAgICAgICAnY2xhc3MnICAgICAgID0+ICd0d2l0dGVyLXNoYXJlLWJ1dHRvbicKICAg
ICksJGF0dHMpKTsKCiAgICAkcSA9ICcnOyAvLyBxdWVyeSBzdHJpbmcKCiAgICBpZiAoJGlk
PSR0aGlzYXJ0aWNsZVsndGhpc2lkJ10pIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIg
c3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkcm93ID0gc2FmZV9yb3coIlJFUExB
Q0UodHdlZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMgdHdlZXQsdGlueXVybCIKICAg
ICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CgogICAgICBpZiAo
JHVybD09JycpIHsKICAgICAgICAkdXJsID0gKCR1cmwpID8gJHVybCA6IHBlcm1saW5rdXJs
KCR0aGlzYXJ0aWNsZSk7CiAgICAgICAgJHEgPSAndXJsPScudXJsZW5jb2RlKCR1cmwpOwog
ICAgICB9CiAgICAgIGlmICgkdGV4dD09JycpIHsKICAgICAgICAkdGV4dCA9ICgkcm93Wyd0
d2VldCddKSA/ICRyb3dbJ3R3ZWV0J10gOiAkdGhpc2FydGljbGVbJ3RpdGxlJ107CiAgICAg
IH0KICAgICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4ndGV4dD0nLnVybGVuY29kZSgk
dGV4dCk7CiAgICB9CiAgICBpZiAoJHVzZXIpIHsKICAgICAgJHEgLj0gKCRxID8gJyZhbXA7
JyA6ICcnKS4ndmlhPScudXJsZW5jb2RlKCR1c2VyKTsKICAgIH0KICAgIGlmICgkZm9sbG93
MSYmJGZvbGxvdzIpIHsKICAgICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4ncmVsYXRl
ZD0nLnVybGVuY29kZSgkZm9sbG93MS4nOicuJGZvbGxvdzIpOwogICAgfSBlbHNlaWYgKCRm
b2xsb3cxfHwkZm9sbG93MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidy
ZWxhdGVkPScudXJsZW5jb2RlKCRmb2xsb3cxLiRmb2xsb3cyKTsKICAgIH0KCiAgICBzd2l0
Y2ggKCRsYW5nKSB7CiAgICAgIGNhc2UgJ2ZyJzogYnJlYWs7IGNhc2UgJ2RlJzogYnJlYWs7
IGNhc2UgJ2VzJzogYnJlYWs7IGNhc2UgJ2pwJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAg
ICAgICAgJGxhbmcgPSAnZW4nOwogICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcn
KS4nbGFuZz0nLnVybGVuY29kZSgkbGFuZyk7CgogICAgc3dpdGNoICgkY291bnQpIHsKICAg
ICAgY2FzZSAnbm9uZSc6IGJyZWFrOyBjYXNlICd2ZXJ0aWNhbCc6IGJyZWFrOwogICAgICBk
ZWZhdWx0OgogICAgICAgICRjb3VudCA9ICdob3Jpem9udGFsJzsKICAgIH0KICAgICRxIC49
ICgkcSA/ICcmYW1wOycgOiAnJykuJ2NvdW50PScudXJsZW5jb2RlKCRjb3VudCk7CgogICAg
JHRoaW5nID0gKCR0aGluZz09PW51bGwpID8gJ1R3ZWV0JyA6IHBhcnNlKCR0aGluZyk7Cgog
ICAgJGh0bWwgPSBocmVmKCR0aGluZywnaHR0cDovL3R3aXR0ZXIuY29tL3NoYXJlPycuJHEK
ICAgICAgLCAnIGNsYXNzPSInLiRjbGFzcy4nIicpOwoKICAgICRqcyA9ICgkaW5jbHVkZV9q
cykgPyBfYXJjX3R3aXR0ZXJfd2lkZ2V0X2pzKCRvcHRpbWlzZV9qcz90cnVlOmZhbHNlKSA6
ICcnOwoKICAgIHJldHVybiAkanMuJGh0bWw7Cn0KCi8qCiAqIFR3aXR0ZXIgRm9sbG93IGJ1
dHRvbgogKi8KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbigkYXR0cywgJHRo
aW5nPW51bGwpCnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xl
OwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgICA9PiAk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwgLy8gdmlhIHVzZXIgYWNjb3VudAogICAgICAg
ICdsYW5nJyAgICAgICAgPT4gJycsCiAgICAgICAgJ2NvdW50JyAgICAgICA9PiB0cnVlLAog
ICAgICAgICdpbmNsdWRlX2pzJyAgPT4gdHJ1ZSwKICAgICAgICAnb3B0aW1pc2VfanMnID0+
IGZhbHNlLAogICAgICAgICdjbGFzcycgICAgICAgPT4gJ3R3aXR0ZXItZm9sbG93LWJ1dHRv
bicKICAgICksJGF0dHMpKTsKCiAgICAkYXR0cyA9ICcnOyAvLyBkYXRhIGF0dHJpYnV0ZXMK
CiAgICBzd2l0Y2ggKCRsYW5nKSB7CiAgICAgIGNhc2UgJ2ZyJzogYnJlYWs7IGNhc2UgJ2Rl
JzogYnJlYWs7IGNhc2UgJ2VzJzogYnJlYWs7IGNhc2UgJ2pwJzogYnJlYWs7CiAgICAgIGRl
ZmF1bHQ6CiAgICAgICAgJGxhbmcgPSAnZW4nOwogICAgfQogICAgJGF0dHMgLj0gJyBkYXRh
LWxhbmc9IicudXJsZW5jb2RlKCRsYW5nKS4nIic7CgogICAgJGF0dHMgLj0gJyBkYXRhLXNo
b3ctY291bnQ9IicuKCRjb3VudD8ndHJ1ZSc6J2ZhbHNlJykuJyInOwoKICAgICR0aGluZyA9
ICgkdGhpbmc9PT1udWxsKSA/ICdGb2xsb3cgQCcuJHVzZXIgOiBwYXJzZSgkdGhpbmcpOwoK
ICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0dHA6Ly90d2l0dGVyLmNvbS8nLnVybGVuY29k
ZSgkdXNlcikKICAgICAgLCAnIGNsYXNzPSInLiRjbGFzcy4nIicuJGF0dHMpOwoKICAgICRq
cyA9ICgkaW5jbHVkZV9qcykgPyBfYXJjX3R3aXR0ZXJfd2lkZ2V0X2pzKCRvcHRpbWlzZV9q
cz90cnVlOmZhbHNlKSA6ICcnOwoKICAgIHJldHVybiAkanMuJGh0bWw7Cn0KCi8qCiAgICBB
ZG1pbi1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKLy8gSW5zdGFsbGF0aW9u
IGZ1bmN0aW9uIC0gYnVpbGRzIE15U1FMIHRhYmxlCmZ1bmN0aW9uIGFyY190d2l0dGVyX2lu
c3RhbGwoKQp7CgogICAgLy8gRm9yIGZpcnN0IGluc3RhbGwsIGNyZWF0ZSB0YWJsZSBmb3Ig
dHdlZXRzCiAgICAkc3FsID0gIkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTICIuUEZYLiJh
cmNfdHdpdHRlciAiOwogICAgJHNxbC49ICIoYXJjX3R3aXR0ZXJpZCBJTlRFR0VSIEFVVE9f
SU5DUkVNRU5UIFBSSU1BUlkgS0VZLAogICAgICAgIGFydGljbGVfaWQgSU5URUdFUigxMSks
CiAgICAgICAgdHdlZXRfaWQgVkFSQ0hBUigxMDApLAogICAgICAgIHR3ZWV0IFZBUkNIQVIo
MTQwKSwKICAgICAgICB0aW55dXJsIFZBUkNIQVIoMzApKTsiOwoKICAgIGlmICghc2FmZV9x
dWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gY3JlYXRl
IGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCn0KCi8vIFVuaW5zdGFsbCBmdW5jdGlvbiAt
IGRlbGV0ZXMgTXlTUUwgdGFibGUgYW5kIHJlbGF0ZWQgcHJlZmVyZW5jZXMKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfdW5pbnN0YWxsKCkKewoKICAgICRzcWwgPSAiRFJPUCBUQUJMRSBJRiBF
WElTVFMgIi5QRlguImFyY190d2l0dGVyOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkp
IHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRl
ciB0YWJsZSc7CiAgICB9CgogICAgJHNxbCA9ICJERUxFVEUgRlJPTSAgIi5QRlguInR4cF9w
cmVmcyBXSEVSRSBldmVudD0nYXJjX3R3aXR0ZXInOyI7CiAgICBpZiAoIXNhZmVfcXVlcnko
JHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNf
dHdpdHRlciBwcmVmZXJlbmNlcyc7CiAgICB9Cgp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3Vy
bF9tZXRob2Rfc2VsZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkbWV0aG9kcyA9IGFycmF5KCd0
aW55dXJsJyA9PiAnVGlueXVybCcsCiAgICAgICdpc2dkJyA9PiAnSXMuZ2QnLAogICAgICAn
YXJjX3R3aXR0ZXInID0+ICdUWFAgVHdlZXQnLAogICAgICAnc21kJyA9PiAnc21kX3Nob3J0
X3VybCcpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkbWV0aG9kcywgJHZhbCwg
JycsICcnLCAkbmFtZSk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgkbmFt
ZSwgJHZhbCkKewogICAgJHRhYnMgPSBhcnJheSgnY29udGVudCcgPT4gJ0NvbnRlbnQnLAog
ICAgICAgICdleHRlbnNpb25zJyA9PiAnRXh0ZW5zaW9ucycsCiAgICAgICAgJycgPT4gJ0hp
ZGRlbicpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkdGFicywgJHZhbCwgJycs
ICcnLCAkbmFtZSk7Cn0KLy8gUHJvdmlkZSBpbnRlcmZhY2UgZm9yIHNldHRpbmcgcHJlZmVy
ZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcHJlZnMoJGV2ZW50LCRzdGVwKQp7CgogICAg
Z2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0OwoKICAgICR1c2VyICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRl
cl91c2VyJ107CiAgICAkcHJlZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJl
Zml4J107CiAgICAkc3VmZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4
J107CiAgICAkdHdlZXRfZGVmYXVsdCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVm
YXVsdCddOwogICAgJHVybF9tZXRob2QgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9t
ZXRob2QnXTsKICAgICRzaG9ydF91cmwgICAgID0gJHByZWZzWydhcmNfc2hvcnRfdXJsJ107
CiAgICAkc2hvcnRfc2l0ZV91cmw9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAg
ICAkY2FjaGVfZGlyICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ107CiAg
ICAkdGFiICAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ107CgogICAgc3dp
dGNoICgkc3RlcCkgewogICAgICAgIGNhc2UgJ3ByZWZzX3NhdmUnOiBwYWdldG9wKCdUWFAg
VHdlZXQnLCAnUHJlZmVyZW5jZXMgc2F2ZWQnKTsgYnJlYWs7CiAgICAgICAgY2FzZSAncmVn
aXN0ZXInOiBwYWdldG9wKCdUWFAgVHdlZXQnLCdDb25uZWN0IHRvIFR3aXR0ZXInKTsgYnJl
YWs7CiAgICAgICAgY2FzZSAndmFsaWRhdGUnOgogICAgICAgIGRlZmF1bHQ6IHBhZ2V0b3Ao
J1RYUCBUd2VldCcpOwogICAgfQoKICAgICRodG1sID0gJyc7CgogICAgaWYgKCRzdGVwPT0n
cmVnaXN0ZXInKSB7IC8vIE9BdXRoIHJlZ2lzdHJhdGlvbiBwcm9jZXNzCgogICAgICAgICR0
d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190
d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAgLy8gQnVpbGQgYSBjYWxsYmFjayBV
UkwgZm9yIFR3aXR0ZXIgdG8gcmV0dXJuIHRvIHRoZSBuZXh0IHN0YWdlCiAgICAgICAgJGNh
bGxiYWNrVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVudCwndmFsaWRhdGUnKTsKCiAg
ICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0UmVxdWVzdFRva2VuKCRjYWxsYmFja1VSTCk7
CiAgICAgICAgJHJlcXVlc3RfdG9rZW4gPSAkcmVxdWVzdFsib2F1dGhfdG9rZW4iXTsKICAg
ICAgICAkcmVxdWVzdF90b2tlbl9zZWNyZXQgPSAkcmVxdWVzdFsib2F1dGhfdG9rZW5fc2Vj
cmV0Il07CgogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW4nLCRy
ZXF1ZXN0X3Rva2VuLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNf
dHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQnLCRyZXF1ZXN0X3Rva2VuX3NlY3JldCwgJ2Fy
Y190d2l0dGVyJywyKTsKCiAgICAkaHRtbCA9ICI8ZGl2IGNsYXNzPSd0ZXh0LWNvbHVtbic+
IgogICAgICAuIjxwPiIuaHJlZignU2lnbi1pbiB0byBUd2l0dGVyJywgJHR3aXQtPmdldEF1
dGhvcml6ZVVSTCgkcmVxdWVzdCkpLiIgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rpb25zIHRv
IGFsbG93IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJZiB5b3UgYXJlIGFscmVh
ZHkgc2lnbmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291bnQgd2lsbCBiZSBhc3Nv
Y2lhdGVkIHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0byBzaWduIG91dCBmaXJz
dCBpZiB5b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3VudC48L3A+IgogICAgICAu
IjwvZGl2PiI7CgogICAgfSBlbHNlaWYgKCRzdGVwPT0ndmFsaWRhdGUnKSB7CiAgICAgICAg
JHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAg
ICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0
dGVyX3JlcXVlc3RUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9y
ZXF1ZXN0VG9rZW5TZWNyZXQnXSk7CiAgICAgICAgLy8gQXNrIFR3aXR0ZXIgZm9yIGFuIGFj
Y2VzcyB0b2tlbiAoYW5kIGFuIGFjY2VzcyB0b2tlbiBzZWNyZXQpCiAgICAgICAgJHJlcXVl
c3QgPSAkdHdpdC0+Z2V0QWNjZXNzVG9rZW4oIGdwcygnb2F1dGhfdmVyaWZpZXInKSApOwog
ICAgICAgICRhY2Nlc3NfdG9rZW4gPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW4nXTsKICAgICAg
ICAkYWNjZXNzX3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbl9zZWNyZXQn
XTsKICAgICAgICAkdXNlciA9ICRyZXF1ZXN0WydzY3JlZW5fbmFtZSddOwogICAgICAgIC8v
IFN0b3JlIHRoZSBhY2Nlc3MgdG9rZW4gYW5kIHNlY3JldAogICAgICAgIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl9hY2Nlc3NUb2tlbicsJGFjY2Vzc190b2tlbiwgJ2FyY190d2l0dGVyJywy
KTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnLCRh
Y2Nlc3NfdG9rZW5fc2VjcmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXNlcicsJHVzZXIpOwogICAgICAgICRwcmVm
c1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSA9ICRhY2Nlc3NfdG9rZW47CiAgICAgICAg
JHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddID0gJGFjY2Vzc190b2tl
bl9zZWNyZXQ7CiAgICAgICAgdW5zZXQoJHR3aXQpOwogICAgfQoKICAgIGlmICgkc3RlcD09
InByZWZzX3NhdmUiKSB7CiAgICAgICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRl
cl9wcmVmaXgnKSk7CiAgICAgICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9z
dWZmaXgnKSk7CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQgPSBncHMoJ2FyY190d2l0dGVyX3R3
ZWV0X2RlZmF1bHQnKTsKICAgICAgICAkdXJsX21ldGhvZCA9IGdwcygnYXJjX3R3aXR0ZXJf
dXJsX21ldGhvZCcpOwogICAgICAgICRzaG9ydF91cmwgPSBncHMoJ2FyY19zaG9ydF91cmwn
KTsKICAgICAgICAkc2hvcnRfc2l0ZV91cmwgPSBncHMoJ2FyY19zaG9ydF9zaXRlX3VybCcp
OwogICAgICAgICRjYWNoZV9kaXIgPSBncHMoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicpOwog
ICAgICAgICR0YWIgPSBncHMoJ2FyY190d2l0dGVyX3RhYicpOwogICAgICAgIGlmIChzdHJs
ZW4oJHByZWZpeCk8PTIwKSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9w
cmVmaXgnLCRwcmVmaXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRwcmVmaXgg
PSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgICAgIH0KICAgICAgICBpZiAo
c3RybGVuKCRzdWZmaXgpPD0yMCkgewogICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0
ZXJfc3VmZml4Jywkc3VmZml4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc3Vm
Zml4ID0gJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICAgICB9CiAgICAgICAg
JHR3ZWV0X2RlZmF1bHQgPSAoJHR3ZWV0X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAgJHNo
b3J0X3VybCA9ICgkc2hvcnRfdXJsKSA/IDEgOiAwOwogICAgICAgIGlmICghJHNob3J0X3Np
dGVfdXJsKSAkc2hvcnRfc2l0ZV91cmwgPSAkcHJlZnNbJ3NpdGV1cmwnXTsKICAgICAgICBz
ZXRfcHJlZignYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwog
ICAgICAgIHNldF9wcmVmKCdhcmNfc2hvcnRfdXJsJywkc2hvcnRfdXJsKTsKICAgICAgICBz
ZXRfcHJlZignYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpOwogICAgICAg
IHNldF9wcmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCk7CiAgICAg
ICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAg
ICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAk
c3RlcCE9J3JlZ2lzdGVyJyApIHsKICAgICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3
aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0
dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBh
cmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuJ10KICAgICAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxi
YWNrVVJMKCRldmVudCwncmVnaXN0ZXInKTsKCiAgICAgICAgICAgIC8vIERlZmluZSB0aGUg
ZmllbGRzIHJlYWR5IHRvIGJ1aWxkIHRoZSBmb3JtCiAgICAgICAgICAgICRmaWVsZHMgPSBh
cnJheSgKICAgICAgICAnVHdlZXQgU2V0dGluZ3MnID0+IGFycmF5KAogICAgICAgICAgJ2Fy
Y190d2l0dGVyX3ByZWZpeCcgPT4gYXJyYXkoCiAgICAgICAgICAgICdsYWJlbCcgPT4gJ1R3
ZWV0IHByZWZpeCcsCiAgICAgICAgICAgICd2YWx1ZScgPT4gJHByZWZpeAogICAgICAgICAg
KSwKICAgICAgICAgICdhcmNfdHdpdHRlcl9zdWZmaXgnID0+IGFycmF5KAogICAgICAgICAg
ICAnbGFiZWwnID0+ICdUd2VldCBzdWZmaXgnLAogICAgICAgICAgICAndmFsdWUnID0+ICRz
dWZmaXgKICAgICAgICAgICksCiAgICAgICAgICAnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVs
dCcgPT4gYXJyYXkoCiAgICAgICAgICAgICdsYWJlbCcgPT4gJ1R3ZWV0IGFydGljbGVzIGJ5
IGRlZmF1bHQnLAogICAgICAgICAgICAndHlwZScgPT4gJ3llc25vUmFkaW8nLAogICAgICAg
ICAgICAndmFsdWUnID0+ICR0d2VldF9kZWZhdWx0CiAgICAgICAgICApLAogICAgICAgICAg
J2FyY190d2l0dGVyX3VybF9tZXRob2QnID0+IGFycmF5KAogICAgICAgICAgICAnbGFiZWwn
ID0+ICdVUkwgc2hvcnRuZXInLAogICAgICAgICAgICAndHlwZScgPT4gJ2FyY190d2l0dGVy
X3VybF9tZXRob2Rfc2VsZWN0JywKICAgICAgICAgICAgJ3ZhbHVlJyA9PiAkdXJsX21ldGhv
ZAogICAgICAgICAgKQogICAgICAgICksCiAgICAgICAgJ1RYUCBUd2VldCBzaG9ydCBVUkwn
ID0+IGFycmF5KAogICAgICAgICAgJ2FyY19zaG9ydF91cmwnID0+IGFycmF5KAogICAgICAg
ICAgICAnbGFiZWwnID0+ICdFbmFibGUgVFhQIFR3ZWV0IHNob3J0IFVSTCByZWRpcmVjdCcs
CiAgICAgICAgICAgICd0eXBlJyA9PiAneWVzbm9SYWRpbycsCiAgICAgICAgICAgICd2YWx1
ZScgPT4gJHNob3J0X3VybAogICAgICAgICAgKSwKICAgICAgICAgICdhcmNfc2hvcnRfc2l0
ZV91cmwnID0+IGFycmF5KAogICAgICAgICAgICAnbGFiZWwnID0+ICdUWFAgVHdlZXQgc2hv
cnQgc2l0ZSBVUkwnLAogICAgICAgICAgICAndmFsdWUnID0+ICRzaG9ydF9zaXRlX3VybAog
ICAgICAgICAgKQogICAgICAgICksCiAgICAgICAgJ1R3aXR0ZXIgVGFiJyA9PiBhcnJheSgK
ICAgICAgICAgICdhcmNfdHdpdHRlcl90YWInID0+IGFycmF5KAogICAgICAgICAgICAnbGFi
ZWwnID0+ICdMb2NhdGlvbiBvZiB0YWInLAogICAgICAgICAgICAndHlwZScgPT4gJ2FyY190
d2l0dGVyX3RhYl9zZWxlY3QnLAogICAgICAgICAgICAndmFsdWUnID0+ICR0YWIKICAgICAg
ICAgICkKICAgICAgICApLAogICAgICAgICdDYWNoZScgPT4gYXJyYXkoCiAgICAgICAgICAn
YXJjX3R3aXR0ZXJfY2FjaGVfZGlyJyA9PiBhcnJheSgKICAgICAgICAgICAgJ2xhYmVsJyA9
PiAnQ2FjaGUgZGlyZWN0b3J5JywKICAgICAgICAgICAgJ3ZhbHVlJyA9PiAkY2FjaGVfZGly
CiAgICAgICAgICApCiAgICAgICAgKQogICAgICAgICAgICApOwoKICAgICAgICAgICAgJGZv
cm0gPSAiPGgyPlR3aXR0ZXIgYWNjb3VudCBkZXRhaWxzPC9oMj4iCiAgICAgICAgLiI8cD48
c3BhbiBjbGFzcz0nZWRpdC1sYWJlbCc+VHdpdHRlciB1c2VybmFtZTwvc3Bhbj4iCiAgICAg
ICAgLiI8c3BhbiBjbGFzcz0nZWRpdC12YWx1ZSc+IgogICAgICAgIC4oJHByZWZzWydhcmNf
dHdpdHRlcl91c2VyJ10gPyAkdXNlci4nICgnLmhyZWYoJ1JlLWNvbm5lY3QnLCRyZWdpc3Rl
clVSTCkuJyknIDogJzxlbT51bmtub3duPC9lbT4nLmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRl
cicsJHJlZ2lzdGVyVVJMKSkKICAgICAgICAgICAgICAgIC4iPC9zcGFuPjwvcD4iOwoKICAg
ICAgICAgICAgJGZvcm0gLj0gX2FyY190d2l0dGVyX2Zvcm1fYnVpbGRlcigkZmllbGRzKTsK
CiAgICAgICAgICAgICRmb3JtIC49IHNJbnB1dCgncHJlZnNfc2F2ZScpLm4uZUlucHV0KCdw
bHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInKTsKCiAgICAgICRmb3JtIC49ICc8cD4nLmZJbnB1
dCgnc3VibWl0JywgJ1N1Ym1pdCcsIGdUeHQoJ3NhdmVfYnV0dG9uJyksICdwdWJsaXNoJyku
JzwvcD4nOwoKICAgICAgJGh0bWwgPSAiPGgxIGNsYXNzPSd0eHAtaGVhZGluZyc+VFhQIFR3
ZWV0PC9oMT4iCiAgICAgICAgLiI8cCBjbGFzcz0nbmF2LXRlcnRpYXJ5Jz4iCiAgICAgICAg
LiI8YSBocmVmPScuLz9ldmVudD1hcmNfYWRtaW5fdHdpdHRlcicgY2xhc3M9J25hdmxpbmsn
PlR3aXR0ZXI8L2E+PGEgaHJlZj0nLi8/ZXZlbnQ9cGx1Z2luX3ByZWZzLmFyY190d2l0dGVy
JyBjbGFzcz0nbmF2bGluay1hY3RpdmUnPk9wdGlvbnM8L2E+IgogICAgICAgIC4iPC9wPiI7
CgogICAgICAkaHRtbCAuPSBmb3JtKCI8ZGl2IGNsYXNzPSdwbHVnaW4tY29sdW1uJz4iLiRm
b3JtLiI8L2Rpdj4iLCAiIGNsYXNzPSdlZGl0LWZvcm0nIik7CgogICAgICAgIH0gZWxzZWlm
ICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CgogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSBh
cmNfdHdpdHRlcjo6Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwoKICAgICAgICAg
ICAgJGZvcm0gPSAiPGgyPlR3aXR0ZXIgYWNjb3VudCBkZXRhaWxzPC9oMj4iCiAgICAgICAg
LiI8c3BhbiBjbGFzcz0nZWRpdC1sYWJlbCc+VHdpdHRlciB1c2VybmFtZTwvc3Bhbj4iCiAg
ICAgICAgLiI8c3BhbiBjbGFzcz0nZWRpdC12YWx1ZSc+PGVtPnVua25vd248L2VtPiAmbWRh
c2g7ICIKICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwp
CiAgICAgICAgICAgICAgICAuIjwvc3Bhbj4iOwoKICAgICAgJGh0bWwgPSBmb3JtKCI8ZGl2
IGNsYXNzPSdwbHVnaW4tY29sdW1uJz4iLiRmb3JtLiI8L2Rpdj4iLCAiIGNsYXNzPSdlZGl0
LWZvcm0nIik7CgogICAgICAgIH0KICAgIH0KCiAgICAvLyBTZXQgalF1ZXJ5IGZvciBzd2l0
Y2hpbmcgb24vb2ZmIHJlbGV2YW50IGFyY19zaG9ydF91cmwgZmllbGRzCiAgICAkanMgPSA8
PDxKUwo8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3Jp
cHQiPgokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpewogIHZhciBvbm9mZiA9ICQoJy5h
cmNfc2hvcnRfdXJsJyk7CiAgdmFyIGFyY19zaG9ydF91cmxfb2ZmID0gJCgnI2FyY19zaG9y
dF91cmwtYXJjX3Nob3J0X3VybC0wJyk7CiAgdmFyIHVybCA9ICQoJy5hcmNfc2hvcnRfc2l0
ZV91cmwnKTsKICB2YXIgdXJsX21ldGhvZCA9ICQoJ3NlbGVjdFtuYW1lPSJhcmNfdHdpdHRl
cl91cmxfbWV0aG9kIl0nKTsKCiAgaWYgKGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNr
ZWQnKT09J2NoZWNrZWQnICYmICQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZh
bCgpIT0nYXJjX3R3aXR0ZXInKSB7CiAgICB1cmwuaGlkZSgpOwogIH0KICAkKCdpbnB1dCcs
IG9ub2ZmKS5jaGFuZ2UoZnVuY3Rpb24oKXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0ZWQn
LCB1cmxfbWV0aG9kKS52YWwoKSE9J2FyY190d2l0dGVyJykgewogICAgICBhcmNfc2hvcnRf
dXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PSdjaGVja2VkJyA/IHVybC5oaWRlKCkgOiB1cmwu
c2hvdygpOwogICAgfQogIH0pOwoKICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21l
dGhvZCkudmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgIG9ub2ZmLmhpZGUoKTsgdXJsLnNo
b3coKTsKICB9CiAgdXJsX21ldGhvZC5jaGFuZ2UoZnVuY3Rpb24oKXsKICAgIGlmICgkKCdv
cHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0dGVyJykgewog
ICAgICBvbm9mZi50b2dnbGUoKTsgdXJsLnNob3coKTsKICAgIH0gZWxzZSB7CiAgICAgIG9u
b2ZmLnRvZ2dsZSgpOwogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9
PSdjaGVja2VkJyA/IHVybC5oaWRlKCkgOiB1cmwuc2hvdygpOwogICAgfQogIH0pCn0pOwo8
L3NjcmlwdD4KSlM7CgogICAgZWNobyAkanMuJGh0bWw7Cn0KCmZ1bmN0aW9uIF9hcmNfdHdp
dHRlcl9mb3JtX2J1aWxkZXIoJGZpZWxkcykgewoKICAkZm9ybSA9ICcnOwoKICBmb3JlYWNo
ICgkZmllbGRzIGFzICRmayA9PiAkZnYpIHsKCiAgICAkZm9ybSAuPSAoJGZrKSA/ICI8aDI+
JGZrPC9oMj4iIDogJyc7CgogICAgZm9yZWFjaCAoJGZ2IGFzICRrID0+ICR2KSB7CgogICAg
ICAkdHlwZSA9IGlzc2V0KCR2Wyd0eXBlJ10pID8gJHZbJ3R5cGUnXSA6ICd0ZXh0JzsKCiAg
ICAgICRmb3JtIC49ICI8cCBjbGFzcz0nJGsnPiIKICAgICAgICAuIjxzcGFuIGNsYXNzPSdl
ZGl0LWxhYmVsJz48bGFiZWwgZm9yPSckayc+Ii4kdlsnbGFiZWwnXS4iPC9sYWJlbD48L3Nw
YW4+IjsKCiAgICAgIHN3aXRjaCAoJHR5cGUpICB7CgogICAgICAgIGNhc2UgJ3RleHRhcmVh
JzoKCiAgICAgICAgICAkZm9ybSAuPSB0ZXh0X2FyZWEoJGssICc1MCcsICc1NTAnLCAkdlsn
dmFsdWUnXSwgJGspOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3llc25vUmFk
aW8nOgoKICAgICAgICAgICRmb3JtIC49ICI8c3BhbiBjbGFzcz0nZWRpdC12YWx1ZSc+Ii55
ZXNub1JhZGlvKCRrLCAkdlsndmFsdWUnXSwgJycsICRrKS4iPC9zcGFuPiI7CiAgICAgICAg
ICBicmVhazsKCiAgICAgICAgY2FzZSAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCc6CgogICAg
ICAgICAgJGZvcm0gLj0gIjxzcGFuIGNsYXNzPSdlZGl0LXZhbHVlJz4iLmFyY190d2l0dGVy
X3RhYl9zZWxlY3QoJGssICR2Wyd2YWx1ZSddKS4iPC9zcGFuPiI7CiAgICAgICAgICBicmVh
azsKCiAgICAgICAgY2FzZSAnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QnOgoKICAg
ICAgICAgICRmb3JtIC49ICI8c3BhbiBjbGFzcz0nZWRpdC12YWx1ZSc+Ii5hcmNfdHdpdHRl
cl91cmxfbWV0aG9kX3NlbGVjdCgkaywgJHZbJ3ZhbHVlJ10pLiI8L3NwYW4+IjsKICAgICAg
ICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgoKICAgICAgICAgICRmb3JtIC49ICI8c3Bh
biBjbGFzcz0nZWRpdC12YWx1ZSc+Ii5mSW5wdXQoJ3RleHQnLCRrLCR2Wyd2YWx1ZSddLCcn
LCcnLCcnLCcnLCcnLCRrKS4iPC9zcGFuPiI7CiAgICAgICAgICBicmVhazsKCiAgICAgIH0K
CiAgICAgICRmb3JtIC49ICI8L3A+IjsKICAgIH0KCiAgfQoKICByZXR1cm4gJGZvcm07Cn0K
Ci8vIEFkZCBUd2l0dGVyIHRhYiB0byBUZXh0cGF0dGVybgpmdW5jdGlvbiBhcmNfYWRtaW5f
dHdpdHRlcigkZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRl
cl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR0d2l0
ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAg
ICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKCiAgICAkdHdpdC0+Y2FjaGVEaXIoJHByZWZzWydhcmNfdHdpdHRl
cl9jYWNoZV9kaXInXSk7CgogICAgJGRhdGEgPSAkdHdpdC0+Z2V0KCd1c2Vycy9zaG93Jwog
ICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10pKTsKICAgICR0d2l0dGVyVXNlciA9ICRkYXRhOwogICAgJHR3aXR0ZXJVc2VyVVJMID0g
J2h0dHA6Ly93d3cudHdpdHRlci5jb20vJy4kdHdpdHRlclVzZXItPnNjcmVlbl9uYW1lOwoK
ICAgIGlmICgkc3RlcD09InR3ZWV0IikgeyAvLyBwb3N0IGFuIHVwZGF0ZSB0byBUd2l0dGVy
CgogICAgICAgIC8vIGZldGNoIGFuZCBjbGVhbiBtZXNzYWdlCiAgICAgICAgJG1lc3NhZ2Ug
PSBzdHJpcF90YWdzKGdwcygnbWVzc2FnZScpKTsKICAgICAgICAkY291bnQgPSBzdHJsZW4o
JG1lc3NhZ2UpOwoKICAgICAgICBpZiAoJGNvdW50PD0xNDAgJiYgJGNvdW50PjApIHsgLy8g
cG9zdCB1cGRhdGUKICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNl
cy91cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkbWVzc2FnZSkpOwogICAgICAgIH0gZWxz
ZSB7IC8vIG1lc3NhZ2UgdG9vIGxvbmcsIEphdmFTY3JpcHQgaW50ZXJmYWNlIHNob3VsZCBw
cmV2ZW50IHRoaXMKICAgICAgICAgICAgJHJlc3VsdCA9IGZhbHNlOwogICAgICAgIH0KCiAg
ICAgICAgcGFnZXRvcCgnVHdpdHRlcicsCiAgICAgICAgICAgICgoJHJlc3VsdCE9ZmFsc2Up
PydUd2l0dGVyIHVwZGF0ZWQnOidFcnJvciB1cGRhdGluZyBUd2l0dGVyJykpOwoKICAgIH0g
ZWxzZWlmICgkc3RlcD09ImRlbGV0ZSIpIHsgLy8gZGVsZXRlIGFuIHVwZGF0ZSBmcm9tIFR3
aXR0ZXIKCiAgICAgICAgJGlkID0gc3RyaXBfdGFncyhncHMoJ2lkJykpOwogICAgICAgIGlm
ICgkaWQpIHsKICAgICAgICAgICAgJHR3aXQtPmRlbGV0ZSgnc3RhdHVzZXMvZGVzdHJveS8n
LiRpZCk7CiAgICAgICAgICAgIHNhZmVfZGVsZXRlKCdhcmNfdHdpdHRlcicsInR3ZWV0X2lk
ID0gJGlkIik7CiAgICAgICAgfQoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJywnVHdpdHRl
ciB1cGRhdGVkJyk7CgogICAgfSBlbHNlIHsKCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicp
OwoKICAgIH0KCiAgICAvLyBQcmVwYXJlIEphdmFTY3JpcHQgdG8gY3JlYXRlIFR3aXR0ZXIg
dXBkYXRlIGludGVyZmFjZQoKICAgICRqcyA9ICc8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2Ny
aXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPic7CiAgICAkanMuPSA8PDxKUwogICAgJChk
b2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICAgIHZhciBjb3VudGVyID0gJCgnPHNwYW4+
JywgewogICAgICAgICd0ZXh0JyA6ICcxNDAnLAogICAgICAgICdpZCcgOiAndHdlZXRjb3Vu
dCcKICAgICAgfSk7CiAgICAkKCcubWVzc2FnZScpLmFwcGVuZChjb3VudGVyKTsKICAgICAg
ICAgICAgdmFyIGNvdW50ZXJTdHlsZSA9ICdmb250LXdlaWdodDpib2xkO3BhZGRpbmctbGVm
dDouNWVtO2ZvbnQtc2l6ZToyZW07bGluZS1oZWlnaHQ6MS4yZW07JzsKICAgICAgICAgICAg
JCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2Nj
YzsnKTsKICAgICAgICAgICAgJCgnI21lc3NhZ2UnKS5rZXl1cChmdW5jdGlvbigpIHsKICAg
ICAgICAgICAgICAgIHZhciBjb3VudCA9IDE0MC0kKCcjbWVzc2FnZScpLnZhbCgpLmxlbmd0
aDsKICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuaHRtbChjb3VudCsnJyk7IC8v
IGhhY2sgdG8gZm9yY2Ugb3V0cHV0IG9mIDAKICAgICAgICAgICAgICAgIGlmIChjb3VudDww
KSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLnByb3AoJ2Rpc2Fi
bGVkJywgJ2Rpc2FibGVkJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg
ICAgICAgICAgICQoJ2lucHV0LnB1Ymxpc2gnKS5wcm9wKCdkaXNhYmxlZCcsICcnKTsKICAg
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb3VudDwwKSB7CiAgICAgICAg
ICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHls
ZSsnY29sb3I6I2YwMDsnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQ8MTAp
IHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywg
Y291bnRlclN0eWxlKydjb2xvcjojMDAwOycpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsK
ICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291
bnRlclN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICB9KQogICAgICAgIH0pOwpKUzsKICAgICRqcy49ICI8L3NjcmlwdD4iOwoKICAgICRvdXQg
PSAnJzsKICAgICR0d2VldHMgPSAkdHdpdC0+Z2V0KCdzdGF0dXNlcy91c2VyX3RpbWVsaW5l
JwogICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91
c2VyJ10sJ2NvdW50Jz0+MjUpKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRz
IGFzICR0d2VldCkgewogICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygk
dHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJHBy
ZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwkdGltZSk7CiAgICAgICAgJG91dC49IHRyKHRk
KCRkYXRlLCdzcGFuJykKICAgICAgICAgICAgLnRkKGFyY19Ud2l0dGVyOjptYWtlTGlua3Mo
aHRtbGVudGl0aWVzKCR0d2VldC0+dGV4dAogICAgICAgICAgICAgICAgLCBFTlRfUVVPVEVT
LCdVVEYtOCcpKSkKICAgICAgICAgICAgLnRkKGRMaW5rKCdhcmNfYWRtaW5fdHdpdHRlcics
J2RlbGV0ZScsJ2lkJywkdHdlZXQtPmlkX3N0ciwnJykpCiAgICAgICAgICAgICk7CiAgICB9
CgogICAgJGZpZWxkcyA9IGFycmF5KAogICAgJycgPT4gYXJyYXkoCiAgICAgICdtZXNzYWdl
JyA9PiBhcnJheSgKICAgICAgICAnbGFiZWwnID0+ICdVcGRhdGUgVHdpdHRlcicsCiAgICAg
ICAgJ3R5cGUnID0+ICd0ZXh0YXJlYScsCiAgICAgICAgJ3ZhbHVlJyA9PiAnJwogICAgICAp
CiAgICApCiAgICApOwoKICAgICRwcm9maWxlID0gJzxpbWcgc3JjPSInLiR0d2l0dGVyVXNl
ci0+cHJvZmlsZV9pbWFnZV91cmwuJyIgYWx0PSJUd2l0dGVyIGF2YXRhciIgc3R5bGU9ImZs
b2F0OmxlZnQ7IG1hcmdpbi1yaWdodDogMWVtIiAvPicKICAgIC5ncmFmKGhyZWYoJHR3aXR0
ZXJVc2VyLT5uYW1lLCR0d2l0dGVyVXNlclVSTCksJyBzdHlsZT0iZm9udC1zaXplOjEuMmVt
O2ZvbnQtd2VpZ2h0OmJvbGQ7IicpCiAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+ZnJp
ZW5kc19jb3VudC4nIGZvbGxvd2luZycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93aW5nJykK
ICAgIC4nLCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5mb2xsb3dlcnNfY291bnQuJyBmb2xsb3dl
cnMnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2VycycpCiAgICAuJywgJy5ocmVmKCR0d2l0
dGVyVXNlci0+c3RhdHVzZXNfY291bnQuJyB1cGRhdGVzJywkdHdpdHRlclVzZXJVUkwpKTsK
CiAgICAkZm9ybSA9IF9hcmNfdHdpdHRlcl9mb3JtX2J1aWxkZXIoJGZpZWxkcykKICAgIC5l
SW5wdXQoJ2FyY19hZG1pbl90d2l0dGVyJykKICAgIC5zSW5wdXQoJ3R3ZWV0Jyk7CiAgJGZv
cm0gLj0gJzxwPicuZklucHV0KCdzdWJtaXQnLCAnU3VibWl0JywgZ1R4dCgnVXBkYXRlJyks
ICdwdWJsaXNoJykuJzwvcD4nOwoKICAkaHRtbCA9ICI8aDEgY2xhc3M9J3R4cC1oZWFkaW5n
Jz5UWFAgVHdlZXQ8L2gxPiIKICAgIC4iPHAgY2xhc3M9J25hdi10ZXJ0aWFyeSc+IgogICAg
LiI8YSBocmVmPScuLz9ldmVudD1hcmNfYWRtaW5fdHdpdHRlcicgY2xhc3M9J25hdmxpbmst
YWN0aXZlJz5Ud2l0dGVyPC9hPjxhIGhyZWY9Jy4vP2V2ZW50PXBsdWdpbl9wcmVmcy5hcmNf
dHdpdHRlcicgY2xhc3M9J25hdmxpbmsnPk9wdGlvbnM8L2E+IgogICAgLiI8L3A+IjsKCiAg
ICAkaHRtbCAuPSAiPGRpdiBjbGFzcz0ndGV4dC1jb2x1bW4nPiIuJHByb2ZpbGUuIjwvZGl2
PiIKICAgIC4iPGJyIHN0eWxlPSdjbGVhcjpib3RoJyAvPiIKICAgIC5mb3JtKCI8ZGl2IGNs
YXNzPSdwbHVnaW4tY29sdW1uJz4iLiRmb3JtLiI8L2Rpdj4iLmJyKTsKCiAgICAvLyBBdHRh
Y2ggcmVjZW50IFR3aXR0ZXIgdXBkYXRlcwoKICAgICRodG1sLj0gIjxkaXYgY2xhc3M9J3R4
cC1saXN0dGFibGVzJz4iCiAgICAuc3RhcnRUYWJsZSgnYXJjX3R3aXR0ZXJfdGltZWxpbmUn
LCcnLCd0eHAtbGlzdCcpLiRvdXQuZW5kVGFibGUoKQogICAgLiI8L2Rpdj4iOwoKICAgIC8v
IE91dHB1dCBKYXZhU2NyaXB0IGFuZCBIVE1MCgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8v
IEFkZCBUd2l0dGVyIG9wdGlvbnMgdG8gYXJ0aWNsZSBhcnRpY2xlIHNjcmVlbgpmdW5jdGlv
biBhcmNfYXBwZW5kX3R3aXR0ZXIoJGV2ZW50LCAkc3RlcCwgJGRhdGEsICRyczEpCnsKICAg
IGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlciwgJGFwcF9tb2RlOwoKICAgICRwcmVmaXgg
PSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgJHByZWZpeCA9ICgkcHJl
Zml4KSA/ICRwcmVmaXggOiAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgJHN1
ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAkc3VmZml4ID0g
KCRzdWZmaXgpID8gJHN1ZmZpeCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J107Cgog
ICAgaWYgKCRyczFbJ0lEJ10pIHsKICAgICAgICAkc3FsID0gIlNFTEVDVCB0d2VldF9pZCx0
d2VldCBGUk9NICIuUEZYLiJhcmNfdHdpdHRlciBXSEVSRSBhcnRpY2xlX2lkPSIuJHJzMVsn
SUQnXS4iOyI7CiAgICAgICAgJHJzMiA9IHNhZmVfcXVlcnkoJHNxbCk7ICRyczIgPSBuZXh0
Um93KCRyczIpOwogICAgfSBlbHNlIHsgLy8gbmV3IGFydGljbGUKICAgICAgICAkcnMyID0g
Jyc7CiAgICB9CgogICAgaWYgKCRhcHBfbW9kZSA9PSAnYXN5bmMnKQogICAgewogICAgIHNl
bmRfc2NyaXB0X3Jlc3BvbnNlKCckKCIjYXJjX3R3aXR0ZXIiKS5yZW1vdmUoKTsnKTsKICAg
IH0KCiAgICBpZiAoJHJzMVsnSUQnXSAmJiAkcnMyWyd0d2VldF9pZCddKSB7CiAgICAgICAg
JGNvbnRlbnQgPSB0YWcoYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcygkcnMyWyd0d2VldCddKSwn
cCcpOwogICAgICAgIHJldHVybiAkZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1R3aXR0ZXIg
dXBkYXRlJywgJ2FyY190d2l0dGVyJyk7CiAgICB9IGVsc2UgewogICAgICAgICR2YXIgPSBn
cHMoJ2FyY190d2VldF90aGlzJyk7CiAgICAgICAgJHZhciA9ICgkcnMxWydJRCddJiYhJHZh
cikgPyAwIDogJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAgICAgICAg
JGNvbnRlbnQgID0gdGFnKHllc25vUmFkaW8oJ2FyY190d2VldF90aGlzJywgJHZhciwgJycs
ICdhcmNfdHdlZXRfdGhpcycpLCdwJyk7CiAgICAgICAgJGNvbnRlbnQgLj0gdGFnKGhyZWYo
J09wdGlvbnMnLCcjYXJjX3R3aXR0ZXJfb3B0aW9ucycsICcgb25jbGljaz0iJChcJyNhcmNf
dHdpdHRlcl9vcHRpb25zXCcpLnRvZ2dsZSgpOyByZXR1cm4gZmFsc2U7IicpLCdwJywnIHN0
eWxlPSJtYXJnaW4tdG9wOjVweDsiJyk7CiAgICAgICAgJGNvbnRlbnQgLj0gdGFnKHRhZyh0
YWcoJ1R3ZWV0IHByZWZpeCcsJ2xhYmVsJywgJyBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCIn
KQogICAgICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJl
Zml4LCdlZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKSwncCcpCiAg
ICAgICAgICAgIC50YWcodGFnKCdUd2VldCBzdWZmaXggKGVnICNoYXNodGFncyknLCdsYWJl
bCcsICcgZm9yPSJhcmNfdHdpdHRlcl9zdWZmaXgiJykKICAgICAgICAgICAgLmZJbnB1dCgn
dGV4dCcsJ2FyY190d2l0dGVyX3N1ZmZpeCcsJHN1ZmZpeCwnZWRpdCcsJycsJycsJzIyJywn
JywnYXJjX3R3aXR0ZXJfc3VmZml4JyksJ3AnKQogICAgICAgICAgICAsJ2RpdicsJyBpZD0i
YXJjX3R3aXR0ZXJfb3B0aW9ucyIgY2xhc3M9InRvZ2dsZSIgc3R5bGU9ImRpc3BsYXk6bm9u
ZSInKTsKICAgICAgICBpZiAoaXNzZXQoJGFyY190d2l0dGVyWydlcnJvciddKSkgewogICAg
ICAgICAgICAkY29udGVudCAuPSAnPHA+Jy4kYXJjX3R3aXR0ZXJbJ2Vycm9yJ10uJzwvcD4n
OwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGRhdGEuZmllbGRzZXQoJGNvbnRlbnQsICdV
cGRhdGUgVHdpdHRlcicsICdhcmNfdHdpdHRlcicpOwogICAgfQoKfQoKLy8gVXBkYXRlIFR3
aXR0ZXIgd2l0aCBwb3N0ZWQgYXJ0aWNsZQpmdW5jdGlvbiBhcmNfYXJ0aWNsZV90d2VldCgk
ZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlciwgJGFyY190
d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQ7CgogICAgJGFydGljbGVfaWQgPSBlbXB0eSgkR0xPQkFMU1snSUQnXSkgPyBncHMoJ0lE
JykgOiAkR0xPQkFMU1snSUQnXTsKICAgIGlmICghZW1wdHkoJGFydGljbGVfaWQpKSB7Cgog
ICAgICAgIGluY2x1ZGVfb25jZSB0eHBhdGguJy9wdWJsaXNoL3RhZ2hhbmRsZXJzLnBocCc7
CgogICAgICAgICRhcnRpY2xlID0gc2FmZV9yb3coIklELCBUaXRsZSwgU2VjdGlvbiwgUG9z
dGVkIiwgJ3RleHRwYXR0ZXJuJywKICAgICAgICAgICAgIklEPXskYXJ0aWNsZV9pZH0gQU5E
IFN0YXR1cz00IEFORCBub3coKT49UG9zdGVkIik7CgogICAgICAgIGlmICgkYXJ0aWNsZSAm
JiBncHMoJ2FyY190d2VldF90aGlzJykpIHsgLy8gdHdlZXQgYXJ0aWNsZQoKICAgICAgICAg
ICAgLy8gTmVlZCB0byBtYW51YWxseSB1cGRhdGUgdGhlICdVUkwgb25seSB0aXRsZScgYmVm
b3JlIGJ1aWxkaW5nIHRoZQogICAgICAgICAgICAvLyBVUkwKICAgICAgICAgICAgJGFydGlj
bGVbJ3VybF90aXRsZSddID0gZ3BzKCd1cmxfdGl0bGUnKTsKICAgICAgICAgICAgLy8gTWFr
ZSBzaG9ydCBVUkwKICAgICAgICAgICAgJHVybCA9IHBlcm1saW5rdXJsKCRhcnRpY2xlKTsK
ICAgICAgICAgICAgJHNob3J0X3VybCA9IGFyY19zaG9ydGVuX3VybCgkdXJsLCRwcmVmc1sn
YXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddLAogICAgICAgICAgICAgICAgYXJyYXkoJ2lkJz0+
JGFydGljbGVfaWQpKTsKCiAgICAgICAgICAgIGlmICghJHNob3J0X3VybCkgeyAvLyBGYWls
ZWQgdG8gb2J0YWluIGEgc2hvcnRlbmVkIFVSTCwgZG8gbm90IHR3ZWV0IQogICAgICAgICAg
ICAgICAgJGFyY190d2l0dGVyWydlcnJvciddID0gJ1VuYWJsZSB0byBvYnRhaW4gYSBzaG9y
dCBVUkwgZm9yIHRoaXMgYXJ0aWNsZS4nOwoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxz
ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQ29uc3RydWN0IFR3aXR0ZXIgdXBk
YXRlCiAgICAgICAgICAgICRwcmVmaXggID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZp
eCcpKTsKICAgICAgICAgICAgJHByZV9sZW4gPSBzdHJsZW4oJHByZWZpeCk7CiAgICAgICAg
ICAgICRwcmVmaXggID0gKCRwcmVmaXggJiYgJHByZV9sZW48PTIwKSA/ICRwcmVmaXguJyAn
IDogJyc7CiAgICAgICAgICAgICRzdWZmaXggID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1
ZmZpeCcpKTsKICAgICAgICAgICAgJHN1Zl9sZW4gPSBzdHJsZW4oJHN1ZmZpeCk7CiAgICAg
ICAgICAgICRzdWZmaXggID0gKCRzdWZmaXggJiYgJHN1Zl9sZW48PTQwKSA/ICcgJy4kc3Vm
Zml4IDogJyc7CiAgICAgICAgICAgICR1cmxfbGVuID0gc3RybGVuKCRzaG9ydF91cmwpKzE7
IC8vIGNvdW50IFVSTCBsZW5ndGggKyAxIGZvciBwcmVmaXhlZCBzcGFjZQogICAgICAgICAg
ICBpZiAoJHByZWZpeCkgJHByZV9sZW4gKz0gMTsKICAgICAgICAgICAgaWYgKCRzdWZmaXgp
ICRzdWZfbGVuICs9IDE7CiAgICAgICAgICAgIGlmICgoc3RybGVuKCRhcnRpY2xlWydUaXRs
ZSddKSskdXJsX2xlbiskcHJlX2xlbiskc3VmX2xlbik+MTQwKSB7CiAgICAgICAgICAgICAg
ICAkYXJ0aWNsZVsnVGl0bGUnXSA9IHN1YnN0cigkYXJ0aWNsZVsnVGl0bGUnXSwwLDEzNS0k
dXJsX2xlbi0kcHJlX2xlbi0kc3VmX2xlbikuJy4uLic7CiAgICAgICAgICAgIH0KICAgICAg
ICAgICAgJHR3ZWV0ID0gJHByZWZpeC4kYXJ0aWNsZVsnVGl0bGUnXS4iICIuJHNob3J0X3Vy
bC4kc3VmZml4OwoKICAgICAgICAgICAgLy8gVXBkYXRlIFR3aXR0ZXIKICAgICAgICAgICAg
JHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAg
ICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3
aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CiAgICAgICAgICAgICRyZXN1bHQgPSAkdHdp
dC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRlJywgYXJyYXkoJ3N0YXR1cycgPT4gJHR3ZWV0KSk7
CgogICAgICAgICAgICAkdHdlZXRfaWQgPSAoaXNfb2JqZWN0KCRyZXN1bHQpKSA/ICRyZXN1
bHQtPmlkX3N0ciA6IDA7CgogICAgICAgICAgICBpZiAoJHR3ZWV0X2lkKSB7CgogICAgICAg
ICAgICAgICAgJHR3ZWV0ID0gYWRkc2xhc2hlcygkdHdlZXQpOwoKICAgICAgICAgICAgICAg
IC8vIHVwZGF0ZSBhcmNfdHdpdHRlciB0YWJsZSB3aXRoIHR3ZWV0CiAgICAgICAgICAgICAg
ICAkc3FsID0gIklOU0VSVCBJTlRPICIuUEZYLiJhcmNfdHdpdHRlciAoYXJ0aWNsZV9pZCx0
d2VldF9pZCx0d2VldCx0aW55dXJsKSAiOwogICAgICAgICAgICAgICAgJHNxbC49ICJWQUxV
RVMoJGFydGljbGVfaWQsJHR3ZWV0X2lkLFwiJHR3ZWV0XCIsJyRzaG9ydF91cmwnKTsiOwog
ICAgICAgICAgICAgICAgc2FmZV9xdWVyeSgkc3FsKTsKCiAgICAgICAgICAgICAgICByZXR1
cm4gdHJ1ZTsKCiAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgJGFyY190
d2l0dGVyWydlcnJvciddID0gJ1R3aXR0ZXIgcmVzcG9uc2U6ICcKICAgICAgICAgICAgICAg
ICAgICAuJHR3aXQtPmh0dHBfY29kZTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsK
CiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7Cgp9
CgovKgogKiBTaG9ydGVuIFVSTHMgdXNpbmcgdmFyaW91cyBtZXRob2RzCiAqLwoKZnVuY3Rp
b24gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsICRtZXRob2Q9JycsICRhdHRzPWFycmF5KCkpCnsK
ICBnbG9iYWwgJHByZWZzOwoKICAkY2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9wdCgk
Y2gsIENVUkxPUFRfSEVBREVSLCAwKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVU
VVJOVFJBTlNGRVIsIHRydWUpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VU
LCAxMCk7CgogIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnc21kJzogLy8gY3JlYXRl
IGEgc2hvcnRlbmVkIFVSTCB1c2luZyBTTUQgU2hvcnQgVVJMCiAgICAgIHJldHVybiAoJGF0
dHNbJ2lkJ10pID8gaHUuJGF0dHNbJ2lkJ10gOiBmYWxzZTsgYnJlYWs7CiAgICBjYXNlICdh
cmNfdHdpdHRlcic6IC8vIG5hdGl2ZSBVUkwgc2hvcnRlbmluZwoKICAgICAgcmV0dXJuICgk
YXR0c1snaWQnXSkgPyBQUk9UT0NPTC4kcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddLicv
Jy4kYXR0c1snaWQnXSA6IGZhbHNlOwogICAgICBicmVhazsKCiAgICBjYXNlICdpc2dkJzoK
CiAgICAgICR1ID0gJ2h0dHA6Ly9pcy5nZC9hcGkucGhwP2xvbmd1cmw9Jy51cmxlbmNvZGUo
JHVybCk7CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKCiAgICAg
ICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vycm9y
JyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAgIH0g
ZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRvIGdl
dCBhIGlzLmdkIFVSTCBmb3IgJwogICAgICAgICAgICAuJHVybCxFX1VTRVJfV0FSTklORyk7
CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAndGlueXVybCc6IGRlZmF1bHQ6IC8v
IGNyZWF0ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcgVGlueVVSTAoKICAgICAgJHUgPSAnaHR0
cDovL3Rpbnl1cmwuY29tL2FwaS1jcmVhdGUucGhwP3VybD0nLnVybGVuY29kZSgkdXJsKTsK
ICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHUpOwogICAgICAkdGlueXVy
bCA9IGN1cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRp
bnl1cmwhPScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2Ugewog
ICAgICAgIHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBUaW55
VVJMIGZvciAnLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CgogIH0KCiAgcmV0dXJu
IGZhbHNlOyAvLyBmYWlsCgp9CgovKgogKiBTaG9ydGVuZWQgVVJMIHJlZGlyZWN0IGJhc2Vk
IG9uIHNtZF9zaG9ydF91cmwKICovCmZ1bmN0aW9uIGFyY19zaG9ydF91cmxfcmVkaXJlY3Qo
JGV2ZW50LCAkc3RlcCkgewogIGdsb2JhbCAkcHJlZnM7CgogICRoYXZlX2lkID0gMDsKCiAg
Ly8gQ2hlY2sgaWYgdGhlcmUgaXMgYW4gYXZhaWxhYmxlIHNob3J0IHNpdGUgdXJsIGFuZCBp
ZiBpdCBpcyBiZWluZyB1c2VkIGluCiAgLy8gdGhpcyBpbnN0YW5jZQogICRzaG9ydF9zaXRl
X3VybCA9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAgaWYgKCRzaG9ydF9zaXRl
X3VybCkgewogICAgJHNob3J0X3NpdGVfdXJsID0gUFJPVE9DT0wuJHNob3J0X3NpdGVfdXJs
LicvJzsKICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoJHNob3J0X3NpdGVfdXJsKTsKICAg
ICRyZSA9ICcjXicuJHVybF9wYXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZl
X2lkID0gcHJlZ19tYXRjaCgkcmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAg
fQoKICAvLyBGYWxsIGJhY2sgdG8gc3RhbmRhcmQgc2l0ZSB1cmwgKHNtZF9zaG9ydF91cmwg
YmVoYXZpb3VyKQogIGlmICgkaGF2ZV9pZCkgewogICAgJHVybF9wYXJ0cyA9IHBhcnNlX3Vy
bChodSk7CiAgICAkcmUgPSAnI14nLiR1cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiopIyc7
CiAgICAkaGF2ZV9pZCA9IHByZWdfbWF0Y2goJHJlLCAkX1NFUlZFUlsnUkVRVUVTVF9VUkkn
XSwgJG0pOwogIH0KCiAgLy8gRG8gdGhlIHJlZGlyZWN0IGlmIHdlJ3ZlIGdvdCBhbiBhcnRp
Y2xlIGlkCiAgaWYgKCRoYXZlX2lkKSB7CiAgICAkaWQgPSAkbVsxXTsKICAgICRwZXJtbGlu
ayA9IHBlcm1saW5rdXJsX2lkKCRpZCk7CgogICAgaWYgKCRwZXJtbGluaykgewogICAgICBv
Yl9lbmRfY2xlYW4oKTsKCiAgICAgIC8vIFN0dXBpZCwgb3ZlciB0aGUgdG9wIGhlYWRlciBz
ZXR0aW5nIGZvciBJRQogICAgICBoZWFkZXIoIlN0YXR1czogMzAxIik7CiAgICAgIGhlYWRl
cigiSFRUUC8xLjAgMzAxIE1vdmVkIFBlcm1hbmVudGx5Iik7CiAgICAgIGhlYWRlcigiTG9j
YXRpb246ICIuJHBlcm1saW5rLCBUUlVFLCAzMDEpOwoKICAgICAgLy8gSW4gY2FzZSB0aGUg
aGVhZGVyKCkgbWV0aG9kIGZhaWxzLCBmYWxsIGJhY2sgb24gYSBjbGFzc2ljIHJlZGlyZWN0
CiAgICAgIGVjaG8gJzxodG1sPjxoZWFkPjxNRVRBIEhUVFAtRVFVSVY9IlJlZnJlc2giIENP
TlRFTlQ9IjA7VVJMPScKICAgICAgICAuJHBlcm1saW5rLiciPjwvaGVhZD48Ym9keT48L2Jv
ZHk+PC9odG1sPic7CiAgICAgIGRpZSgpOwogICAgfQogIH0KCn0KCi8vIEF1dG8gZW5hYmxl
IHBsdWdpbiBvbiBpbnN0YWxsIChvcmlnaW5hbCBpZGVhIGJ5IE1pY2hhZWwgTWFuZnJlKQpm
dW5jdGlvbiBfYXJjX3R3aXR0ZXJfYXV0b19lbmFibGUoJGV2ZW50LCAkc3RlcCwgJHByZWZp
eD0nYXJjX3R3aXR0ZXInKQp7CiAgJHBsdWdpbiA9IHN1YnN0cigkZXZlbnQsIHN0cmxlbign
cGx1Z2luX2xpZmVjeWNsZS4nKSk7CiAgaWYgKHN0cm5jbXAoJHBsdWdpbiwgJHByZWZpeCwg
c3RybGVuKCRwcmVmaXgpKSA9PSAwKQogIHsKICAgIHNhZmVfdXBkYXRlKCd0eHBfcGx1Z2lu
JywgInN0YXR1cyA9IDEiLCAibmFtZSA9ICciIC4gZG9TbGFzaCgkcGx1Z2luKSAuICInIik7
CiAgfQp9CgovKgogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoqLwoKY2xhc3MgYXJjX3R3
aXR0ZXIgZXh0ZW5kcyBUd2l0dGVyT0F1dGggewogICAgLy8gQ2FjaGluZyB2YXJpYWJsZXMK
ICAgIHByaXZhdGUgJF9jYWNoZSA9IHRydWU7CiAgICBwcml2YXRlICRfY2FjaGVfZGlyID0g
Jy4vdG1wJzsKICAgIHByaXZhdGUgJF9jYWNoZV90aW1lID0gMTgwMDsgLy8gMzAgbWludXRl
IGNhY2hlCgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1
bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTAogICAgICAgICwgJG9hdXRoX3Rva2Vu
X3NlY3JldCA9IE5VTEwpCiAgICB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkY29u
c3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4KICAgICAgICAgICAg
LCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsKICAgICAgICAkdGhpcy0+Zm9ybWF0ID0gJ2pzb24n
OwogICAgICAgICR0aGlzLT50aW1lb3V0ID0gMTU7CiAgICAgICAgJHRoaXMtPmNvbm5lY3R0
aW1lb3V0ID0gMTU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhbGxiYWNrVVJMKCRl
dmVudCwkc3RlcCkKICAgIHsKICAgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvXD8uKi8n
LCAnJyxQUk9UT0NPTC4kX1NFUlZFUlsnU0VSVkVSX05BTUUnXS4kX1NFUlZFUlsnUkVRVUVT
VF9VUkknXSkKICAgICAgICAgIC4nP2V2ZW50PScuJGV2ZW50LicmYW1wO3N0ZXA9Jy4kc3Rl
cDsKICAgIH0KCiAgICAvLyBjcmVhdGUgVHdpdHRlciBhbmQgZXh0ZXJuYWwgbGlua3MgaW4g
dGV4dAogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlTGlua3MoJHRleHQpCiAgICB7
CiAgICAgICAgJHVybCA9ICcvXGIoaHR0cHxodHRwc3xmdHApOlwvXC8oW0EtWjAtOV1bQS1a
MC05Xy1dKig/OlwuW0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/KFxkKyk/XC8/KFtcL1x3K1wu
XSspXGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9
JyQwJyByZWw9J2V4dGVybmFsJz4kMDwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcv
XGIoXnxccyl3d3cuKFthLXpfQS1aMC05XSspKChcLlthLXpdKykrKVxiL2knOwogICAgICAg
ICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMn
IHJlbD0nZXh0ZXJuYWwnPnd3dy4kMiQzPC9hPiIsICR0ZXh0KTsKICAgICAgICAkdGV4dCA9
IHByZWdfcmVwbGFjZSgiLyhefFxzKS4/QChbYS16X0EtWjAtOV0rKS8iLAogICAgICAgICAg
ICAiJDFAPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIuY29tLyQyJyByZWw9J2V4dGVybmFsJz4k
MjwvYT4iLCR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKShc
IyhbYS16X0EtWjAtOTpfLV0rKSkvIiwKICAgICAgICAgICAgIiQxPGEgaHJlZj0naHR0cDov
L3R3aXR0ZXIuY29tL3NlYXJjaD9xPSUyMyQzJyByZWw9J2V4dGVybmFsJz4kMjwvYT4iLCR0
ZXh0KTsKICAgICAgICByZXR1cm4gJHRleHQ7CiAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBn
ZXQoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGFwaV91cmwgPSBt
ZDUoJHVybC51cmxlbmNvZGUoc2VyaWFsaXplKCRwYXJhbXMpKSk7CiAgICAgICAgJGRhdGEg
PSAnJzsKCiAgICAgICAgaWYgKCR0aGlzLT5fY2FjaGUpIHsgLy8gY2hlY2sgZm9yIGNhY2hl
ZCBqc29uCgogICAgICAgICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBp
X3VybCk7CgogICAgICAgIH0KICAgICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7CiAgICAgICAg
ICAgICRkYXRhID0gcGFyZW50OjpnZXQoJHVybCwgJHBhcmFtcyk7IC8vIGRhdGEgYWxyZWFk
eSBqc29uX2RlY29kZSdkCiAgICAgICAgICAgIGlmICgkdGhpcy0+aHR0cF9jb2RlPT09MjAw
ICYmICRlbmNvZGVkX2RhdGE9anNvbl9lbmNvZGUoJGRhdGEpKSB7IC8vIHNhdmUgY2FjaGUK
ICAgICAgICAgICAgICAgICRmaWxlID0gJHRoaXMtPl9jYWNoZV9kaXIuJy8nLiRhcGlfdXJs
OwogICAgICAgICAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJGVuY29kZWRfZGF0
YSxMT0NLX0VYKTsKICAgICAgICAgICAgICAgIHJldHVybiAkZGF0YTsKICAgICAgICAgICAg
fSBlbHNlIHsgLy8gZmFpbGVkIHRvIHJldHJpZXZlIGRhdGEgZnJvbSBUd2l0dGVyCgogICAg
ICAgICAgICAgICAgaWYgKCR0aGlzLT5fY2FjaGUpIHsgLy8gYXR0ZW1wdCB0byBmb3JjZSBj
YWNoZWQganNvbiByZXR1cm4KCiAgICAgICAgICAgICAgICAgICAgJGRhdGEgPSAkdGhpcy0+
X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwsdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaWYg
KCRkYXRhKSByZXR1cm4ganNvbl9kZWNvZGUoJGRhdGEpOwoKICAgICAgICAgICAgICAgIH0K
CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9CiAgICAgICAg
fSBlbHNlIHsgLy8gcmV0dXJuIGNhY2hlZCBqc29uCiAgICAgICAgICAgIHJldHVybiBqc29u
X2RlY29kZSgkZGF0YSk7CiAgICAgICAgfQogICAgfSAvL2VuZCBnZXQoKQoKICAgIGZ1bmN0
aW9uIHBvc3QoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEg
PSBwYXJlbnQ6OnBvc3QoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gJGRhdGE7CiAg
ICB9CgogICAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAg
ewogICAgICAgICRkYXRhID0gcGFyZW50OjpkZWxldGUoJHVybCwkcGFyYW1zKTsKICAgICAg
ICByZXR1cm4gJGRhdGE7CiAgICB9CgogICAgLy8gQ2FjaGUgbWV0aG9kcwoKICAgIHB1Ymxp
YyBmdW5jdGlvbiBzZXRDYWNoaW5nKCRjYWNoZT10cnVlKQogICAgewogICAgICAgICR0aGlz
LT5fY2FjaGUgPSAoJGNhY2hlKSA/IHRydWUgOiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1
ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVEaXIoJGxvYykKICAgIHsKICAg
ICAgICAkdGhpcy0+X2NhY2hlX2RpciA9ICRsb2M7CiAgICAgICAgcmV0dXJuIHRydWU7CiAg
ICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhY2hlVGltZSgkbWlucykKICAgIHsKICAgICAg
ICAkdGhpcy0+X2NhY2hlX3RpbWUgPSAkbWlucyo2MDsgLy8gY29udmVydCBtaW51dGVzIGlu
dG8gc2Vjb25kcwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUgZnVu
Y3Rpb24gX3JldHJpZXZlQ2FjaGUoJHVybCwkb3ZlcmlkZV90aW1lb3V0PWZhbHNlKQogICAg
ewogICAgICAgICRmaWxlID0gJHRoaXMtPl9jYWNoZV9kaXIuJy8nLiR1cmw7CiAgICAgICAg
aWYgKGZpbGVfZXhpc3RzKCRmaWxlKSkgewoKICAgICAgICAgICAgJGRpZmYgPSB0aW1lKCkg
LSBmaWxlbXRpbWUoJGZpbGUpOwogICAgICAgICAgICBpZiAoJG92ZXJpZGVfdGltZW91dCB8
fCAkZGlmZiA8ICR0aGlzLT5fY2FjaGVfdGltZSkgewogICAgICAgICAgICAgICAgcmV0dXJu
IGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg
ICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2Ug
ewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9CgovKgogKiBB
YnJhaGFtIFdpbGxpYW1zIChhYnJhaGFtQGFicmFoLmFtKSBodHRwOi8vYWJyYWguYW0KICoK
ICogVGhlIGZpcnN0IFBIUCBMaWJyYXJ5IHRvIHN1cHBvcnQgT0F1dGggZm9yIFR3aXR0ZXIn
cyBSRVNUIEFQSS4KICovCgovKioKICogVHdpdHRlciBPQXV0aCBjbGFzcwogKi8KY2xhc3Mg
VHdpdHRlck9BdXRoIHsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQIHN0YXR1cyBjb2Rl
IHJldHVybmVkLiAqLwogIHB1YmxpYyAkaHR0cF9jb2RlOwogIC8qIENvbnRhaW5zIHRoZSBs
YXN0IEFQSSBjYWxsLiAqLwogIHB1YmxpYyAkdXJsOwogIC8qIFNldCB1cCB0aGUgQVBJIHJv
b3QgVVJMLiAqLwogIHB1YmxpYyAkaG9zdCA9ICJodHRwczovL2FwaS50d2l0dGVyLmNvbS8x
LjEvIjsKICAvKiBTZXQgdGltZW91dCBkZWZhdWx0LiAqLwogIHB1YmxpYyAkdGltZW91dCA9
IDMwOwogIC8qIFNldCBjb25uZWN0IHRpbWVvdXQuICovCiAgcHVibGljICRjb25uZWN0dGlt
ZW91dCA9IDMwOwogIC8qIFZlcmlmeSBTU0wgQ2VydC4gKi8KICBwdWJsaWMgJHNzbF92ZXJp
ZnlwZWVyID0gRkFMU0U7CiAgLyogUmVzcG9ucyBmb3JtYXQuICovCiAgcHVibGljICRmb3Jt
YXQgPSAnanNvbic7CiAgLyogRGVjb2RlIHJldHVybmVkIGpzb24gZGF0YS4gKi8KICBwdWJs
aWMgJGRlY29kZV9qc29uID0gVFJVRTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQIGhl
YWRlcnMgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2luZm87CiAgLyogU2V0IHRoZSB1
c2VyYWduZXQuICovCiAgcHVibGljICR1c2VyYWdlbnQgPSAnVHdpdHRlck9BdXRoIHYwLjIu
MC1iZXRhMic7CiAgLyogSW1tZWRpYXRlbHkgcmV0cnkgdGhlIEFQSSBjYWxsIGlmIHRoZSBy
ZXNwb25zZSB3YXMgbm90IHN1Y2Nlc3NmdWwuICovCiAgLy9wdWJsaWMgJHJldHJ5ID0gVFJV
RTsKCiAgLyoqCiAgICogU2V0IEFQSSBVUkxTCiAgICovCiAgZnVuY3Rpb24gYWNjZXNzVG9r
ZW5VUkwoKSAgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL2FjY2Vz
c190b2tlbic7IH0KICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVUkwoKSB7IHJldHVybiAnaHR0
cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvYXV0aGVudGljYXRlJzsgfQogIGZ1bmN0aW9u
IGF1dGhvcml6ZVVSTCgpICAgIHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9v
YXV0aC9hdXRob3JpemUnOyB9CiAgZnVuY3Rpb24gcmVxdWVzdFRva2VuVVJMKCkgeyByZXR1
cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL3JlcXVlc3RfdG9rZW4nOyB9Cgog
IC8qKgogICAqIERlYnVnIGhlbHBlcnMKICAgKi8KICBmdW5jdGlvbiBsYXN0U3RhdHVzQ29k
ZSgpIHsgcmV0dXJuICR0aGlzLT5odHRwX3N0YXR1czsgfQogIGZ1bmN0aW9uIGxhc3RBUElD
YWxsKCkgeyByZXR1cm4gJHRoaXMtPmxhc3RfYXBpX2NhbGw7IH0KCiAgLyoqCiAgICogY29u
c3RydWN0IFR3aXR0ZXJPQXV0aCBvYmplY3QKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVj
dCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxM
LCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkgewogICAgJHRoaXMtPnNoYTFfbWV0aG9k
ID0gbmV3IE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSgpOwogICAgJHRoaXMtPmNv
bnN1bWVyID0gbmV3IE9BdXRoQ29uc3VtZXIoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3Nl
Y3JldCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF90b2tlbikgJiYgIWVtcHR5KCRvYXV0aF90
b2tlbl9zZWNyZXQpKSB7CiAgICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVy
KCRvYXV0aF90b2tlbiwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICB9IGVsc2UgewogICAg
ICAkdGhpcy0+dG9rZW4gPSBOVUxMOwogICAgfQogIH0KCgogIC8qKgogICAqIEdldCBhIHJl
cXVlc3RfdG9rZW4gZnJvbSBUd2l0dGVyCiAgICoKICAgKiBAcmV0dXJucyBhIGtleS92YWx1
ZSBhcnJheSBjb250YWluaW5nIG9hdXRoX3Rva2VuIGFuZCBvYXV0aF90b2tlbl9zZWNyZXQK
ICAgKi8KICBmdW5jdGlvbiBnZXRSZXF1ZXN0VG9rZW4oJG9hdXRoX2NhbGxiYWNrKSB7CiAg
ICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1snb2F1dGhfY2FsbGJh
Y2snXSA9ICRvYXV0aF9jYWxsYmFjazsKICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVx
dWVzdCgkdGhpcy0+cmVxdWVzdFRva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7CiAg
ICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAg
JHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbidd
LCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAg
fQoKICAvKioKICAgKiBHZXQgdGhlIGF1dGhvcml6ZSBVUkwKICAgKgogICAqIEByZXR1cm5z
IGEgc3RyaW5nCiAgICovCiAgZnVuY3Rpb24gZ2V0QXV0aG9yaXplVVJMKCR0b2tlbiwgJHNp
Z25faW5fd2l0aF90d2l0dGVyID0gVFJVRSkgewogICAgaWYgKGlzX2FycmF5KCR0b2tlbikp
IHsKICAgICAgJHRva2VuID0gJHRva2VuWydvYXV0aF90b2tlbiddOwogICAgfQogICAgaWYg
KGVtcHR5KCRzaWduX2luX3dpdGhfdHdpdHRlcikpIHsKICAgICAgcmV0dXJuICR0aGlzLT5h
dXRob3JpemVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfSBlbHNlIHsK
ICAgICAgIHJldHVybiAkdGhpcy0+YXV0aGVudGljYXRlVVJMKCkgLiAiP29hdXRoX3Rva2Vu
PXskdG9rZW59IjsKICAgIH0KICB9CgogIC8qKgogICAqIEV4Y2hhbmdlIHJlcXVlc3QgdG9r
ZW4gYW5kIHNlY3JldCBmb3IgYW4gYWNjZXNzIHRva2VuIGFuZAogICAqIHNlY3JldCwgdG8g
c2lnbiBBUEkgY2FsbHMuCiAgICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4i
ID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9r
ZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAg
ICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9u
YW1lIiA9PiAiYWJyYWhhbSIpCiAgICovCiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oJG9h
dXRoX3ZlcmlmaWVyKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1l
dGVyc1snb2F1dGhfdmVyaWZpZXInXSA9ICRvYXV0aF92ZXJpZmllcjsKICAgICRyZXF1ZXN0
ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ0dFVCcs
ICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVy
cygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9r
ZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAg
cmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIE9uZSB0aW1lIGV4Y2hhbmdlIG9mIHVz
ZXJuYW1lIGFuZCBwYXNzd29yZCBmb3IgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQuCiAgICoK
ICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2Vu
IiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFj
Y2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5
MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIsCiAg
ICogICAgICAgICAgICAgICAgInhfYXV0aF9leHBpcmVzIiA9PiAiMCIpCiAgICovCiAgZnVu
Y3Rpb24gZ2V0WEF1dGhUb2tlbigkdXNlcm5hbWUsICRwYXNzd29yZCkgewogICAgJHBhcmFt
ZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF91c2VybmFtZSddID0g
JHVzZXJuYW1lOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9wYXNzd29yZCddID0gJHBhc3N3
b3JkOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9tb2RlJ10gPSAnY2xpZW50X2F1dGgnOwog
ICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVS
TCgpLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFy
c2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhD
b25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2Vj
cmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdFVCB3cmFwcGVy
IGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbWV0
ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgk
dXJsLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdq
c29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2Rl
KCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAg
ICogUE9TVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gcG9z
dCgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlz
LT5vQXV0aFJlcXVlc3QoJHVybCwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRo
aXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICBy
ZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9u
c2U7CiAgfQoKICAvKioKICAgKiBERUxFVEUgd3JhcHBlciBmb3Igb0F1dGhSZXFldXN0Lgog
ICAqLwogIGZ1bmN0aW9uIGRlbGV0ZSgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsK
ICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0RFTEVURScsICRw
YXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMt
PmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwog
ICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEZvcm1hdCBhbmQg
c2lnbiBhbiBPQXV0aCAvIEFQSSByZXF1ZXN0CiAgICovCiAgZnVuY3Rpb24gb0F1dGhSZXF1
ZXN0KCR1cmwsICRtZXRob2QsICRwYXJhbWV0ZXJzKSB7CiAgICBpZiAoc3RycnBvcygkdXJs
LCAnaHR0cHM6Ly8nKSAhPT0gMCAmJiBzdHJycG9zKCR1cmwsICdodHRwOi8vJykgIT09IDAp
IHsKICAgICAgJHVybCA9ICJ7JHRoaXMtPmhvc3R9eyR1cmx9LnskdGhpcy0+Zm9ybWF0fSI7
CiAgICB9CiAgICAkcmVxdWVzdCA9IE9BdXRoUmVxdWVzdDo6ZnJvbV9jb25zdW1lcl9hbmRf
dG9rZW4oJHRoaXMtPmNvbnN1bWVyLCAkdGhpcy0+dG9rZW4sICRtZXRob2QsICR1cmwsICRw
YXJhbWV0ZXJzKTsKICAgICRyZXF1ZXN0LT5zaWduX3JlcXVlc3QoJHRoaXMtPnNoYTFfbWV0
aG9kLCAkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbik7CiAgICBzd2l0Y2ggKCRtZXRo
b2QpIHsKICAgIGNhc2UgJ0dFVCc6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVz
dC0+dG9fdXJsKCksICdHRVQnKTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAkdGhpcy0+
aHR0cCgkcmVxdWVzdC0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwgJG1ldGhvZCwgJHJl
cXVlc3QtPnRvX3Bvc3RkYXRhKCkpOwogICAgfQogIH0KCiAgLyoqCiAgICogTWFrZSBhbiBI
VFRQIHJlcXVlc3QKICAgKgogICAqIEByZXR1cm4gQVBJIHJlc3VsdHMKICAgKi8KICBmdW5j
dGlvbiBodHRwKCR1cmwsICRtZXRob2QsICRwb3N0ZmllbGRzID0gTlVMTCkgewogICAgJHRo
aXMtPmh0dHBfaW5mbyA9IGFycmF5KCk7CiAgICAkY2kgPSBjdXJsX2luaXQoKTsKICAgIC8q
IEN1cmwgc2V0dGluZ3MgKi8KICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VU0VSQUdF
TlQsICR0aGlzLT51c2VyYWdlbnQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NP
Tk5FQ1RUSU1FT1VULCAkdGhpcy0+Y29ubmVjdHRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQo
JGNpLCBDVVJMT1BUX1RJTUVPVVQsICR0aGlzLT50aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0
KCRjaSwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgVFJVRSk7CiAgICBjdXJsX3NldG9wdCgk
Y2ksIENVUkxPUFRfSFRUUEhFQURFUiwgYXJyYXkoJ0V4cGVjdDonKSk7CiAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsICR0aGlzLT5zc2xfdmVyaWZ5cGVl
cik7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVSRlVOQ1RJT04sIGFycmF5
KCR0aGlzLCAnZ2V0SGVhZGVyJykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hF
QURFUiwgRkFMU0UpOwoKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgICBjYXNlICdQT1NU
JzoKICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVCwgVFJVRSk7CiAgICAg
ICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsKICAgICAgICAgIGN1cmxfc2V0b3B0KCRj
aSwgQ1VSTE9QVF9QT1NURklFTERTLCAkcG9zdGZpZWxkcyk7CiAgICAgICAgfQogICAgICAg
IGJyZWFrOwogICAgICBjYXNlICdERUxFVEUnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwg
Q1VSTE9QVF9DVVNUT01SRVFVRVNULCAnREVMRVRFJyk7CiAgICAgICAgaWYgKCFlbXB0eSgk
cG9zdGZpZWxkcykpIHsKICAgICAgICAgICR1cmwgPSAieyR1cmx9P3skcG9zdGZpZWxkc30i
OwogICAgICAgIH0KICAgIH0KCiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVJMLCAk
dXJsKTsKICAgICRyZXNwb25zZSA9IGN1cmxfZXhlYygkY2kpOwogICAgJHRoaXMtPmh0dHBf
Y29kZSA9IGN1cmxfZ2V0aW5mbygkY2ksIENVUkxJTkZPX0hUVFBfQ09ERSk7CiAgICAkdGhp
cy0+aHR0cF9pbmZvID0gYXJyYXlfbWVyZ2UoJHRoaXMtPmh0dHBfaW5mbywgY3VybF9nZXRp
bmZvKCRjaSkpOwogICAgJHRoaXMtPnVybCA9ICR1cmw7CiAgICBjdXJsX2Nsb3NlICgkY2kp
OwogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVy
IGluZm8gdG8gc3RvcmUuCiAgICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKCRjaCwgJGhlYWRl
cikgewogICAgJGkgPSBzdHJwb3MoJGhlYWRlciwgJzonKTsKICAgIGlmICghZW1wdHkoJGkp
KSB7CiAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgnLScsICdfJywgc3RydG9sb3dlcihzdWJz
dHIoJGhlYWRlciwgMCwgJGkpKSk7CiAgICAgICR2YWx1ZSA9IHRyaW0oc3Vic3RyKCRoZWFk
ZXIsICRpICsgMikpOwogICAgICAkdGhpcy0+aHR0cF9oZWFkZXJbJGtleV0gPSAkdmFsdWU7
CiAgICB9CiAgICByZXR1cm4gc3RybGVuKCRoZWFkZXIpOwogIH0KfQovKiBHZW5lcmljIGV4
Y2VwdGlvbiBjbGFzcwogKi8KaWYgKCFjbGFzc19leGlzdHMoJ09BdXRoRXhjZXB0aW9uJykp
IHsKICBjbGFzcyBPQXV0aEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CiAgICAvLyBw
YXNzCiAgfQp9CgpjbGFzcyBPQXV0aENvbnN1bWVyIHsKICBwdWJsaWMgJGtleTsKICBwdWJs
aWMgJHNlY3JldDsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNh
bGxiYWNrX3VybD1OVUxMKSB7CiAgICAkdGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5z
ZWNyZXQgPSAkc2VjcmV0OwogICAgJHRoaXMtPmNhbGxiYWNrX3VybCA9ICRjYWxsYmFja191
cmw7CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICJPQXV0aENv
bnN1bWVyW2tleT0kdGhpcy0+a2V5LHNlY3JldD0kdGhpcy0+c2VjcmV0XSI7CiAgfQp9Cgpj
bGFzcyBPQXV0aFRva2VuIHsKICAvLyBhY2Nlc3MgdG9rZW5zIGFuZCByZXF1ZXN0IHRva2Vu
cwogIHB1YmxpYyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoKICAvKioKICAgKiBrZXkgPSB0
aGUgdG9rZW4KICAgKiBzZWNyZXQgPSB0aGUgdG9rZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rp
b24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7
CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICB9CgogIC8qKgogICAqIGdlbmVyYXRl
cyB0aGUgYmFzaWMgc3RyaW5nIHNlcmlhbGl6YXRpb24gb2YgYSB0b2tlbiB0aGF0IGEgc2Vy
dmVyCiAgICogd291bGQgcmVzcG9uZCB0byByZXF1ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9r
ZW4gY2FsbHMgd2l0aAogICAqLwogIGZ1bmN0aW9uIHRvX3N0cmluZygpIHsKICAgIHJldHVy
biAib2F1dGhfdG9rZW49IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZj
Mzk4NigkdGhpcy0+a2V5KSAuCiAgICAgICAgICAgIiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAu
CiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0
KTsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRv
X3N0cmluZygpOwogIH0KfQoKLyoqCiAqIEEgY2xhc3MgZm9yIGltcGxlbWVudGluZyBhIFNp
Z25hdHVyZSBNZXRob2QKICogU2VlIHNlY3Rpb24gOSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBp
biB0aGUgc3BlYwogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2Qgewog
IC8qKgogICAqIE5lZWRzIHRvIHJldHVybiB0aGUgbmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1l
dGhvZCAoaWUgSE1BQy1TSEExKQogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJh
Y3QgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCk7CgogIC8qKgogICAqIEJ1aWxkIHVwIHRo
ZSBzaWduYXR1cmUKICAgKiBOT1RFOiBUaGUgb3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVT
VCBOT1QgYmUgdXJsZW5jb2RlZC4KICAgKiB0aGUgZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBP
QXV0aFJlcXVlc3Qgd2hlbiB0aGUgZmluYWwKICAgKiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQK
ICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29u
c3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHJl
dHVybiBzdHJpbmcKICAgKi8KICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2ln
bmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogIC8qKgogICAqIFZlcmlm
aWVzIHRoYXQgYSBnaXZlbiBzaWduYXR1cmUgaXMgY29ycmVjdAogICAqIEBwYXJhbSBPQXV0
aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIK
ICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9rZW4KICAgKiBAcGFyYW0gc3RyaW5nICRzaWdu
YXR1cmUKICAgKiBAcmV0dXJuIGJvb2wKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tf
c2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewog
ICAgJGJ1aWx0ID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVy
LCAkdG9rZW4pOwogICAgcmV0dXJuICRidWlsdCA9PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoq
CiAqIFRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBITUFDLVNIQTEg
c2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVkIGluIFtSRkMyMTA0XQogKiB3aGVyZSB0
aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5nIGlzIHRoZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRo
ZSBjb25jYXRlbmF0ZWQgdmFsdWVzIChlYWNoIGZpcnN0CiAqIGVuY29kZWQgcGVyIFBhcmFt
ZXRlciBFbmNvZGluZykgb2YgdGhlIENvbnN1bWVyIFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0
LCBzZXBhcmF0ZWQgYnkgYW4gJyYnCiAqIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkgZXZl
biBpZiBlbXB0eS4KICogICAtIENoYXB0ZXIgOS4yICgiSE1BQy1TSEExIikKICovCmNsYXNz
IE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJl
TWV0aG9kIHsKICBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiSE1BQy1TSEEx
IjsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRj
b25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3Np
Z25hdHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJh
c2Vfc3RyaW5nOwoKICAgICRrZXlfcGFydHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5z
ZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAg
ICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRz
KTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtleV9wYXJ0cyk7CgogICAgcmV0dXJuIGJh
c2U2NF9lbmNvZGUoaGFzaF9obWFjKCdzaGExJywgJGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVl
KSk7CiAgfQp9CgovKioKICogVGhlIFBMQUlOVEVYVCBtZXRob2QgZG9lcyBub3QgcHJvdmlk
ZSBhbnkgc2VjdXJpdHkgcHJvdGVjdGlvbiBhbmQgU0hPVUxEIG9ubHkgYmUgdXNlZAogKiBv
dmVyIGEgc2VjdXJlIGNoYW5uZWwgc3VjaCBhcyBIVFRQUy4gSXQgZG9lcyBub3QgdXNlIHRo
ZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcuCiAqICAgLSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVY
VCIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBP
QXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewog
ICAgcmV0dXJuICJQTEFJTlRFWFQiOwogIH0KCiAgLyoqCiAgICogb2F1dGhfc2lnbmF0dXJl
IGlzIHNldCB0byB0aGUgY29uY2F0ZW5hdGVkIGVuY29kZWQgdmFsdWVzIG9mIHRoZSBDb25z
dW1lciBTZWNyZXQgYW5kCiAgICogVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicg
Y2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KSwgZXZlbiBpZiBlaXRoZXIgc2VjcmV0IGlzCiAg
ICogZW1wdHkuIFRoZSByZXN1bHQgTVVTVCBiZSBlbmNvZGVkIGFnYWluLgogICAqICAgLSBD
aGFwdGVyIDkuNC4xICgiR2VuZXJhdGluZyBTaWduYXR1cmVzIikKICAgKgogICAqIFBsZWFz
ZSBub3RlIHRoYXQgdGhlIHNlY29uZCBlbmNvZGluZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhl
IFNpZ25hdHVyZU1ldGhvZCwgYXMKICAgKiBPQXV0aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQog
ICAqLwogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25z
dW1lciwgJHRva2VuKSB7CiAgICAka2V5X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1l
ci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7
CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9w
YXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlfcGFydHMpOwogICAgJHJlcXVl
c3QtPmJhc2Vfc3RyaW5nID0gJGtleTsKCiAgICByZXR1cm4gJGtleTsKICB9Cn0KCi8qKgog
KiBUaGUgUlNBLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEt
djFfNSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQgaW4KICogW1JGQzM0NDddIHNl
Y3Rpb24gOC4yIChtb3JlIHNpbXBseSBrbm93biBhcyBQS0NTIzEpLCB1c2luZyBTSEEtMSBh
cyB0aGUgaGFzaCBmdW5jdGlvbiBmb3IKICogRU1TQS1QS0NTMS12MV81LiBJdCBpcyBhc3N1
bWVkIHRoYXQgdGhlIENvbnN1bWVyIGhhcyBwcm92aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkg
aW4gYQogKiB2ZXJpZmllZCB3YXkgdG8gdGhlIFNlcnZpY2UgUHJvdmlkZXIsIGluIGEgbWFu
bmVyIHdoaWNoIGlzIGJleW9uZCB0aGUgc2NvcGUgb2YgdGhpcwogKiBzcGVjaWZpY2F0aW9u
LgogKiAgIC0gQ2hhcHRlciA5LjMgKCJSU0EtU0hBMSIpCiAqLwphYnN0cmFjdCBjbGFzcyBP
QXV0aFNpZ25hdHVyZU1ldGhvZF9SU0FfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0
aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlJTQS1T
SEExIjsKICB9CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAg
b2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBh
IHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIp
IGZldGNoIHZpYSBodHRwIHVzaW5nIGEgdXJsIHByb3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIK
ICAvLyAoMykgc29tZSBzb3J0IG9mIHNwZWNpZmljIGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9u
IHJlcXVlc3QKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyBy
ZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3Qg
ZnVuY3Rpb24gZmV0Y2hfcHVibGljX2NlcnQoJiRyZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhl
IFNQIHRvIGltcGxlbWVudCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBh
cmU6CiAgLy8gKDEpIGRvIGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBr
ZXllZCBvZmYgb2YgY29uc3VtZXIKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVy
biBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0
ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHJpdmF0ZV9jZXJ0KCYkcmVxdWVzdCk7Cgog
IHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwg
JHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9i
YXNlX3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5n
OwoKICAgIC8vIEZldGNoIHRoZSBwcml2YXRlIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1
ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9wcml2YXRlX2NlcnQoJHJlcXVlc3QpOwoK
ICAgIC8vIFB1bGwgdGhlIHByaXZhdGUga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAg
ICAkcHJpdmF0ZWtleWlkID0gb3BlbnNzbF9nZXRfcHJpdmF0ZWtleSgkY2VydCk7CgogICAg
Ly8gU2lnbiB1c2luZyB0aGUga2V5CiAgICAkb2sgPSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3Ry
aW5nLCAkc2lnbmF0dXJlLCAkcHJpdmF0ZWtleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBr
ZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHByaXZhdGVrZXlpZCk7CgogICAg
cmV0dXJuIGJhc2U2NF9lbmNvZGUoJHNpZ25hdHVyZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25h
dHVyZSkgewogICAgJGRlY29kZWRfc2lnID0gYmFzZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsK
CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmlu
ZygpOwoKICAgIC8vIEZldGNoIHRoZSBwdWJsaWMga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJl
cXVlc3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsK
CiAgICAvLyBQdWxsIHRoZSBwdWJsaWMga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAg
ICAkcHVibGlja2V5aWQgPSBvcGVuc3NsX2dldF9wdWJsaWNrZXkoJGNlcnQpOwoKICAgIC8v
IENoZWNrIHRoZSBjb21wdXRlZCBzaWduYXR1cmUgYWdhaW5zdCB0aGUgb25lIHBhc3NlZCBp
biB0aGUgcXVlcnkKICAgICRvayA9IG9wZW5zc2xfdmVyaWZ5KCRiYXNlX3N0cmluZywgJGRl
Y29kZWRfc2lnLCAkcHVibGlja2V5aWQpOwoKICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNv
dXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHVibGlja2V5aWQpOwoKICAgIHJldHVybiAk
b2sgPT0gMTsKICB9Cn0KCmNsYXNzIE9BdXRoUmVxdWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1l
dGVyczsKICBwcml2YXRlICRodHRwX21ldGhvZDsKICBwcml2YXRlICRodHRwX3VybDsKICAv
LyBmb3IgZGVidWcgcHVycG9zZXMKICBwdWJsaWMgJGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBz
dGF0aWMgJHZlcnNpb24gPSAnMS4wJzsKICBwdWJsaWMgc3RhdGljICRQT1NUX0lOUFVUID0g
J3BocDovL2lucHV0JzsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAk
aHR0cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFy
YW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCBPQXV0
aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMocGFyc2VfdXJsKCRodHRwX3VybCwgUEhQX1VSTF9R
VUVSWSkpLCAkcGFyYW1ldGVycyk7CiAgICAkdGhpcy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0
ZXJzOwogICAgJHRoaXMtPmh0dHBfbWV0aG9kID0gJGh0dHBfbWV0aG9kOwogICAgJHRoaXMt
Pmh0dHBfdXJsID0gJGh0dHBfdXJsOwogIH0KCgogIC8qKgogICAqIGF0dGVtcHQgdG8gYnVp
bGQgdXAgYSByZXF1ZXN0IGZyb20gd2hhdCB3YXMgcGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAg
Ki8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9
TlVMTCwgJGh0dHBfdXJsPU5VTEwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUg
PSAoIWlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSB8fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAi
b24iKQogICAgICAgICAgICAgID8gJ2h0dHAnCiAgICAgICAgICAgICAgOiAnaHR0cHMnOwog
ICAgQCRodHRwX3VybCBvciAkaHR0cF91cmwgPSAkc2NoZW1lIC4KICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJzovLycgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ10gLgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAnOicgLgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAkX1NFUlZFUlsnU0VSVkVSX1BPUlQnXSAuCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOwogICAgQCRodHRwX21ldGhvZCBvciAk
aHR0cF9tZXRob2QgPSAkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3
ZXJlbid0IGhhbmRlZCBhbnkgcGFyYW1ldGVycywgc28gbGV0J3MgZmluZCB0aGUgb25lcyBy
ZWxldmFudCB0bwogICAgLy8gdGhpcyByZXF1ZXN0LgogICAgLy8gSWYgeW91IHJ1biBYTUwt
UlBDIG9yIHNpbWlsYXIgeW91IHNob3VsZCB1c2UgdGhpcyB0byBwcm92aWRlIHlvdXIgb3du
CiAgICAvLyBwYXJzZWQgcGFyYW1ldGVyLWxpc3QKICAgIGlmICghJHBhcmFtZXRlcnMpIHsK
ICAgICAgLy8gRmluZCByZXF1ZXN0IGhlYWRlcnMKICAgICAgJHJlcXVlc3RfaGVhZGVycyA9
IE9BdXRoVXRpbDo6Z2V0X2hlYWRlcnMoKTsKCiAgICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1z
dHJpbmcgdG8gZmluZCBHRVQgcGFyYW1ldGVycwogICAgICAkcGFyYW1ldGVycyA9IE9BdXRo
VXRpbDo6cGFyc2VfcGFyYW1ldGVycygkX1NFUlZFUlsnUVVFUllfU1RSSU5HJ10pOwoKICAg
ICAgLy8gSXQncyBhIFBPU1QgcmVxdWVzdCBvZiB0aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwg
c28gcGFyc2UgUE9TVAogICAgICAvLyBwYXJhbWV0ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJp
ZGluZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVAogICAgICBpZiAoJGh0dHBfbWV0aG9kID09
ICJQT1NUIgogICAgICAgICAgJiYgQHN0cnN0cigkcmVxdWVzdF9oZWFkZXJzWyJDb250ZW50
LVR5cGUiXSwKICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0t
dXJsZW5jb2RlZCIpCiAgICAgICAgICApIHsKICAgICAgICAkcG9zdF9kYXRhID0gT0F1dGhV
dGlsOjpwYXJzZV9wYXJhbWV0ZXJzKAogICAgICAgICAgZmlsZV9nZXRfY29udGVudHMoc2Vs
Zjo6JFBPU1RfSU5QVVQpCiAgICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5
X21lcmdlKCRwYXJhbWV0ZXJzLCAkcG9zdF9kYXRhKTsKICAgICAgfQoKICAgICAgLy8gV2Ug
aGF2ZSBhIEF1dGhvcml6YXRpb24taGVhZGVyIHdpdGggT0F1dGggZGF0YS4gUGFyc2UgdGhl
IGhlYWRlcgogICAgICAvLyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0
ZXMgZnJvbSBHRVQgb3IgUE9TVAogICAgICBpZiAoQHN1YnN0cigkcmVxdWVzdF9oZWFkZXJz
WydBdXRob3JpemF0aW9uJ10sIDAsIDYpID09ICJPQXV0aCAiKSB7CiAgICAgICAgJGhlYWRl
cl9wYXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpzcGxpdF9oZWFkZXIoCiAgICAgICAgICAkcmVx
dWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10KICAgICAgICApOwogICAgICAgICRwYXJh
bWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRlcnMsICRoZWFkZXJfcGFyYW1ldGVycyk7
CiAgICAgIH0KCiAgICB9CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0
aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIHByZXR0eSBt
dWNoIGEgaGVscGVyIGZ1bmN0aW9uIHRvIHNldCB1cCB0aGUgcmVxdWVzdAogICAqLwogIHB1
YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVy
LCAkdG9rZW4sICRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7
CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJGRlZmF1
bHRzID0gYXJyYXkoIm9hdXRoX3ZlcnNpb24iID0+IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24s
CiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhfbm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6
Z2VuZXJhdGVfbm9uY2UoKSwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF90aW1lc3Rh
bXAiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfdGltZXN0YW1wKCksCiAgICAgICAgICAg
ICAgICAgICAgICAib2F1dGhfY29uc3VtZXJfa2V5IiA9PiAkY29uc3VtZXItPmtleSk7CiAg
ICBpZiAoJHRva2VuKQogICAgICAkZGVmYXVsdHNbJ29hdXRoX3Rva2VuJ10gPSAkdG9rZW4t
PmtleTsKCiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRkZWZhdWx0cywgJHBhcmFt
ZXRlcnMpOwoKICAgIHJldHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0
dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFt
ZXRlcigkbmFtZSwgJHZhbHVlLCAkYWxsb3dfZHVwbGljYXRlcyA9IHRydWUpIHsKICAgIGlm
ICgkYWxsb3dfZHVwbGljYXRlcyAmJiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0p
KSB7CiAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSBhZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0
aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICBpZiAoaXNfc2NhbGFyKCR0aGlz
LT5wYXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBk
dXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykKICAgICAgICAvLyBpbnRv
IGFuIGFycmF5IHNvIHdlIGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+
cGFyYW1ldGVyc1skbmFtZV0gPSBhcnJheSgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwog
ICAgICB9CgogICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV1bXSA9ICR2YWx1ZTsKICAg
IH0gZWxzZSB7CiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAg
IH0KICB9CgogIHB1YmxpYyBmdW5jdGlvbiBnZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICBy
ZXR1cm4gaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0
ZXJzWyRuYW1lXSA6IG51bGw7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRl
cnMoKSB7CiAgICByZXR1cm4gJHRoaXMtPnBhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVu
Y3Rpb24gdW5zZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICB1bnNldCgkdGhpcy0+cGFyYW1l
dGVyc1skbmFtZV0pOwogIH0KCiAgLyoqCiAgICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycywg
c29ydGVkIGFuZCBjb25jYXRlbmF0ZWQgaW50byBhIG5vcm1hbGl6ZWQgc3RyaW5nLgogICAq
IEByZXR1cm4gc3RyaW5nCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYWJsZV9w
YXJhbWV0ZXJzKCkgewogICAgLy8gR3JhYiBhbGwgcGFyYW1ldGVycwogICAgJHBhcmFtcyA9
ICR0aGlzLT5wYXJhbWV0ZXJzOwoKICAgIC8vIFJlbW92ZSBvYXV0aF9zaWduYXR1cmUgaWYg
cHJlc2VudAogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoIlRoZSBvYXV0aF9zaWduYXR1cmUg
cGFyYW1ldGVyIE1VU1QgYmUgZXhjbHVkZWQuIikKICAgIGlmIChpc3NldCgkcGFyYW1zWydv
YXV0aF9zaWduYXR1cmUnXSkpIHsKICAgICAgdW5zZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0
dXJlJ10pOwogICAgfQoKICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnko
JHBhcmFtcyk7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0
aGlzIHJlcXVlc3QKICAgKgogICAqIFRoZSBiYXNlIHN0cmluZyBkZWZpbmVkIGFzIHRoZSBt
ZXRob2QsIHRoZSB1cmwKICAgKiBhbmQgdGhlIHBhcmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBl
YWNoIHVybGVuY29kZWQKICAgKiBhbmQgdGhlIGNvbmNhdGVkIHdpdGggJi4KICAgKi8KICBw
dWJsaWMgZnVuY3Rpb24gZ2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpIHsKICAgICRwYXJ0
cyA9IGFycmF5KAogICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwK
ICAgICAgJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCksCiAgICAgICR0aGlzLT5n
ZXRfc2lnbmFibGVfcGFyYW1ldGVycygpCiAgICApOwoKICAgICRwYXJ0cyA9IE9BdXRoVXRp
bDo6dXJsZW5jb2RlX3JmYzM5ODYoJHBhcnRzKTsKCiAgICByZXR1cm4gaW1wbG9kZSgnJics
ICRwYXJ0cyk7CiAgfQoKICAvKioKICAgKiBqdXN0IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0
aG9kCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9k
KCkgewogICAgcmV0dXJuIHN0cnRvdXBwZXIoJHRoaXMtPmh0dHBfbWV0aG9kKTsKICB9Cgog
IC8qKgogICAqIHBhcnNlcyB0aGUgdXJsIGFuZCByZWJ1aWxkcyBpdCB0byBiZQogICAqIHNj
aGVtZTovL2hvc3QvcGF0aAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXpl
ZF9odHRwX3VybCgpIHsKICAgICRwYXJ0cyA9IHBhcnNlX3VybCgkdGhpcy0+aHR0cF91cmwp
OwoKICAgICRwb3J0ID0gQCRwYXJ0c1sncG9ydCddOwogICAgJHNjaGVtZSA9ICRwYXJ0c1sn
c2NoZW1lJ107CiAgICAkaG9zdCA9ICRwYXJ0c1snaG9zdCddOwogICAgJHBhdGggPSBAJHBh
cnRzWydwYXRoJ107CgogICAgJHBvcnQgb3IgJHBvcnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMn
KSA/ICc0NDMnIDogJzgwJzsKCiAgICBpZiAoKCRzY2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9y
dCAhPSAnNDQzJykKICAgICAgICB8fCAoJHNjaGVtZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0g
JzgwJykpIHsKICAgICAgJGhvc3QgPSAiJGhvc3Q6JHBvcnQiOwogICAgfQogICAgcmV0dXJu
ICIkc2NoZW1lOi8vJGhvc3QkcGF0aCI7CiAgfQoKICAvKioKICAgKiBidWlsZHMgYSB1cmwg
dXNhYmxlIGZvciBhIEdFVCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3Vy
bCgpIHsKICAgICRwb3N0X2RhdGEgPSAkdGhpcy0+dG9fcG9zdGRhdGEoKTsKICAgICRvdXQg
PSAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKTsKICAgIGlmICgkcG9zdF9kYXRh
KSB7CiAgICAgICRvdXQgLj0gJz8nLiRwb3N0X2RhdGE7CiAgICB9CiAgICByZXR1cm4gJG91
dDsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUgZGF0YSBvbmUgd291bGQgc2VuZCBpbiBh
IFBPU1QgcmVxdWVzdAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsK
ICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRl
cnMpOwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIK
ICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9faGVhZGVyKCRyZWFsbT1udWxsKSB7CiAgICAk
Zmlyc3QgPSB0cnVlOwogIGlmKCRyZWFsbSkgewogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRp
b246IE9BdXRoIHJlYWxtPSInIC4gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcmVh
bG0pIC4gJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0gZWxzZQogICAgICAkb3V0
ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoJzsKCiAgICAkdG90YWwgPSBhcnJheSgpOwogICAg
Zm9yZWFjaCAoJHRoaXMtPnBhcmFtZXRlcnMgYXMgJGsgPT4gJHYpIHsKICAgICAgaWYgKHN1
YnN0cigkaywgMCwgNSkgIT0gIm9hdXRoIikgY29udGludWU7CiAgICAgIGlmIChpc19hcnJh
eSgkdikpIHsKICAgICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qg
c3VwcG9ydGVkIGluIGhlYWRlcnMnKTsKICAgICAgfQogICAgICAkb3V0IC49ICgkZmlyc3Qp
ID8gJyAnIDogJywnOwogICAgICAkb3V0IC49IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5
ODYoJGspIC4KICAgICAgICAgICAgICAnPSInIC4KICAgICAgICAgICAgICBPQXV0aFV0aWw6
OnVybGVuY29kZV9yZmMzOTg2KCR2KSAuCiAgICAgICAgICAgICAgJyInOwogICAgICAkZmly
c3QgPSBmYWxzZTsKICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgcHVibGljIGZ1bmN0
aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3VybCgpOwogIH0KCgog
IHB1YmxpYyBmdW5jdGlvbiBzaWduX3JlcXVlc3QoJHNpZ25hdHVyZV9tZXRob2QsICRjb25z
dW1lciwgJHRva2VuKSB7CiAgICAkdGhpcy0+c2V0X3BhcmFtZXRlcigKICAgICAgIm9hdXRo
X3NpZ25hdHVyZV9tZXRob2QiLAogICAgICAkc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUo
KSwKICAgICAgZmFsc2UKICAgICk7CiAgICAkc2lnbmF0dXJlID0gJHRoaXMtPmJ1aWxkX3Np
Z25hdHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgJHRo
aXMtPnNldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZSIsICRzaWduYXR1cmUsIGZhbHNl
KTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9t
ZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkc2lnbmF0dXJlID0gJHNpZ25hdHVy
ZV9tZXRob2QtPmJ1aWxkX3NpZ25hdHVyZSgkdGhpcywgJGNvbnN1bWVyLCAkdG9rZW4pOwog
ICAgcmV0dXJuICRzaWduYXR1cmU7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBj
dXJyZW50IHRpbWVzdGFtcAogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVy
YXRlX3RpbWVzdGFtcCgpIHsKICAgIHJldHVybiB0aW1lKCk7CiAgfQoKICAvKioKICAgKiB1
dGlsIGZ1bmN0aW9uOiBjdXJyZW50IG5vbmNlCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVu
Y3Rpb24gZ2VuZXJhdGVfbm9uY2UoKSB7CiAgICAkbXQgPSBtaWNyb3RpbWUoKTsKICAgICRy
YW5kID0gbXRfcmFuZCgpOwoKICAgIHJldHVybiBtZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVz
IGxvb2sgbmljZXIgdGhhbiBudW1iZXJzCiAgfQp9CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAg
cHJvdGVjdGVkICR0aW1lc3RhbXBfdGhyZXNob2xkID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBm
aXZlIG1pbnV0ZXMKICBwcm90ZWN0ZWQgJHZlcnNpb24gPSAnMS4wJzsgICAgICAgICAgICAg
Ly8gaGkgYmxhaW5lCiAgcHJvdGVjdGVkICRzaWduYXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7
CgogIHByb3RlY3RlZCAkZGF0YV9zdG9yZTsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRh
dGFfc3RvcmUpIHsKICAgICR0aGlzLT5kYXRhX3N0b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoK
ICBwdWJsaWMgZnVuY3Rpb24gYWRkX3NpZ25hdHVyZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRo
b2QpIHsKICAgICR0aGlzLT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+
Z2V0X25hbWUoKV0gPQogICAgICAkc2lnbmF0dXJlX21ldGhvZDsKICB9CgogIC8vIGhpZ2gg
bGV2ZWwgZnVuY3Rpb25zCgogIC8qKgogICAqIHByb2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJl
cXVlc3QKICAgKiByZXR1cm5zIHRoZSByZXF1ZXN0IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8K
ICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfcmVxdWVzdF90b2tlbigmJHJlcXVlc3QpIHsKICAg
ICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMt
PmdldF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8gbm8gdG9rZW4gcmVxdWlyZWQgZm9y
IHRoZSBpbml0aWFsIHRva2VuIHJlcXVlc3QKICAgICR0b2tlbiA9IE5VTEw7CgogICAgJHRo
aXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAg
IC8vIFJldiBBIGNoYW5nZQogICAgJGNhbGxiYWNrID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0
ZXIoJ29hdXRoX2NhbGxiYWNrJyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3Rv
cmUtPm5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrKTsKCiAgICByZXR1
cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHByb2Nlc3MgYW4gYWNjZXNzX3Rva2Vu
IHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSBhY2Nlc3MgdG9rZW4gb24gc3VjY2VzcwogICAq
LwogIHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9hY2Nlc3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAg
ICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlz
LT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQg
cmVxdWVzdCB0b2tlbgogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwg
JGNvbnN1bWVyLCAicmVxdWVzdCIpOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJl
cXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2
ZXJpZmllciA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF92ZXJpZmllcicpOwog
ICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0
b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIpOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwog
IH0KCiAgLyoqCiAgICogdmVyaWZ5IGFuIGFwaSBjYWxsLCBjaGVja3MgYWxsIHRoZSBwYXJh
bWV0ZXJzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVz
dCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKICAgICRjb25zdW1lciA9
ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwogICAgJHRva2VuID0gJHRoaXMtPmdl
dF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAiYWNjZXNzIik7CiAgICAkdGhpcy0+Y2hl
Y2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4g
YXJyYXkoJGNvbnN1bWVyLCAkdG9rZW4pOwogIH0KCiAgLy8gSW50ZXJuYWxzIGZyb20gaGVy
ZQogIC8qKgogICAqIHZlcnNpb24gMQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Zl
cnNpb24oJiRyZXF1ZXN0KSB7CiAgICAkdmVyc2lvbiA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1l
dGVyKCJvYXV0aF92ZXJzaW9uIik7CiAgICBpZiAoISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNl
cnZpY2UgUHJvdmlkZXJzIE1VU1QgYXNzdW1lIHRoZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJl
IDEuMCBpZiB0aGlzIHBhcmFtZXRlciBpcyBub3QgcHJlc2VudC4KICAgICAgLy8gQ2hhcHRl
ciA3LjAgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKQogICAgICAkdmVyc2lv
biA9ICcxLjAnOwogICAgfQogICAgaWYgKCR2ZXJzaW9uICE9PSAkdGhpcy0+dmVyc2lvbikg
ewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIk9BdXRoIHZlcnNpb24gJyR2ZXJz
aW9uJyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CiAgICByZXR1cm4gJHZlcnNpb247CiAgfQoK
ICAvKioKICAgKiBmaWd1cmUgb3V0IHRoZSBzaWduYXR1cmUgd2l0aCBzb21lIGRlZmF1bHRz
CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX21ldGhvZCgmJHJlcXVl
c3QpIHsKICAgICRzaWduYXR1cmVfbWV0aG9kID0KICAgICAgICBAJHJlcXVlc3QtPmdldF9w
YXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiKTsKCiAgICBpZiAoISRzaWduYXR1
cmVfbWV0aG9kKSB7CiAgICAgIC8vIEFjY29yZGluZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3Np
bmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKSB0aGUgc2lnbmF0dXJlLW1ldGhvZAogICAgICAv
LyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQsIGFuZCB3ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRv
IFBMQUlOVEVYVAogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVy
ZSBtZXRob2QgcGFyYW1ldGVyLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwogICAg
fQoKICAgIGlmICghaW5fYXJyYXkoJHNpZ25hdHVyZV9tZXRob2QsCiAgICAgICAgICAgICAg
ICAgIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkpIHsKICAgICAgdGhy
b3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICJTaWduYXR1cmUgbWV0aG9kICckc2ln
bmF0dXJlX21ldGhvZCcgbm90IHN1cHBvcnRlZCAiIC4KICAgICAgICAidHJ5IG9uZSBvZiB0
aGUgZm9sbG93aW5nOiAiIC4KICAgICAgICBpbXBsb2RlKCIsICIsIGFycmF5X2tleXMoJHRo
aXMtPnNpZ25hdHVyZV9tZXRob2RzKSkKICAgICAgKTsKICAgIH0KICAgIHJldHVybiAkdGhp
cy0+c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRob2RdOwogIH0KCiAgLyoqCiAg
ICogdHJ5IHRvIGZpbmQgdGhlIGNvbnN1bWVyIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdz
IGNvbnN1bWVyIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYk
cmVxdWVzdCkgewogICAgJGNvbnN1bWVyX2tleSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRl
cigib2F1dGhfY29uc3VtZXJfa2V5Iik7CiAgICBpZiAoISRjb25zdW1lcl9rZXkpIHsKICAg
ICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIGtleSIpOwog
ICAgfQoKICAgICRjb25zdW1lciA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfY29uc3Vt
ZXIoJGNvbnN1bWVyX2tleSk7CiAgICBpZiAoISRjb25zdW1lcikgewogICAgICB0aHJvdyBu
ZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29uc3VtZXIiKTsKICAgIH0KCiAgICByZXR1
cm4gJGNvbnN1bWVyOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZv
ciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIHRva2VuIGtleQogICAqLwogIHByaXZhdGUgZnVu
Y3Rpb24gZ2V0X3Rva2VuKCYkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNj
ZXNzIikgewogICAgJHRva2VuX2ZpZWxkID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdv
YXV0aF90b2tlbicpOwogICAgJHRva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90
b2tlbigKICAgICAgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuX2ZpZWxkCiAgICAp
OwogICAgaWYgKCEkdG9rZW4pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJ
bnZhbGlkICR0b2tlbl90eXBlIHRva2VuOiAkdG9rZW5fZmllbGQiKTsKICAgIH0KICAgIHJl
dHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBhbGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNo
ZWNrIHRoZSBzaWduYXR1cmUgb24gYSByZXF1ZXN0CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBz
aWduYXR1cmUgbWV0aG9kIGFwcHJvcHJpYXRlbHkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9u
IGNoZWNrX3NpZ25hdHVyZSgmJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAv
LyB0aGlzIHNob3VsZCBwcm9iYWJseSBiZSBpbiBhIGRpZmZlcmVudCBtZXRob2QKICAgICR0
aW1lc3RhbXAgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcp
OwogICAgJG5vbmNlID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9ub25jZScp
OwoKICAgICR0aGlzLT5jaGVja190aW1lc3RhbXAoJHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+
Y2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCk7Cgog
ICAgJHNpZ25hdHVyZV9tZXRob2QgPSAkdGhpcy0+Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJl
cXVlc3QpOwoKICAgICRzaWduYXR1cmUgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1
dGhfc2lnbmF0dXJlJyk7CiAgICAkdmFsaWRfc2lnID0gJHNpZ25hdHVyZV9tZXRob2QtPmNo
ZWNrX3NpZ25hdHVyZSgKICAgICAgJHJlcXVlc3QsCiAgICAgICRjb25zdW1lciwKICAgICAg
JHRva2VuLAogICAgICAkc2lnbmF0dXJlCiAgICApOwoKICAgIGlmICghJHZhbGlkX3NpZykg
ewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgc2lnbmF0dXJlIik7
CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3
IGVub3VnaAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfdGltZXN0YW1wKCR0aW1l
c3RhbXApIHsKICAgIGlmKCAhICR0aW1lc3RhbXAgKQogICAgICB0aHJvdyBuZXcgT0F1dGhF
eGNlcHRpb24oCiAgICAgICAgJ01pc3NpbmcgdGltZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBh
cmFtZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1l
c3RhbXAgaXMgcmVjZW50aXNoCiAgICAkbm93ID0gdGltZSgpOwogICAgaWYgKGFicygkbm93
IC0gJHRpbWVzdGFtcCkgPiAkdGhpcy0+dGltZXN0YW1wX3RocmVzaG9sZCkgewogICAgICB0
aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5
b3VycyAkdGltZXN0YW1wLCBvdXJzICRub3ciCiAgICAgICk7CiAgICB9CiAgfQoKICAvKioK
ICAgKiBjaGVjayB0aGF0IHRoZSBub25jZSBpcyBub3QgcmVwZWF0ZWQKICAgKi8KICBwcml2
YXRlIGZ1bmN0aW9uIGNoZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0
aW1lc3RhbXApIHsKICAgIGlmKCAhICRub25jZSApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4
Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyBub25jZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0
ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNl
IGlzIHVuaXF1ZWlzaAogICAgJGZvdW5kID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9u
b25jZSgKICAgICAgJGNvbnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRub25jZSwKICAg
ICAgJHRpbWVzdGFtcAogICAgKTsKICAgIGlmICgkZm91bmQpIHsKICAgICAgdGhyb3cgbmV3
IE9BdXRoRXhjZXB0aW9uKCJOb25jZSBhbHJlYWR5IHVzZWQ6ICRub25jZSIpOwogICAgfQog
IH0KCn0KCmNsYXNzIE9BdXRoRGF0YVN0b3JlIHsKICBmdW5jdGlvbiBsb29rdXBfY29uc3Vt
ZXIoJGNvbnN1bWVyX2tleSkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlv
biBsb29rdXBfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuKSB7CiAgICAv
LyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIGxvb2t1cF9ub25jZSgkY29uc3VtZXIs
ICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9
CgogIGZ1bmN0aW9uIG5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrID0g
bnVsbCkgewogICAgLy8gcmV0dXJuIGEgbmV3IHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29u
c3VtZXIKICB9CgogIGZ1bmN0aW9uIG5ld19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3Vt
ZXIsICR2ZXJpZmllciA9IG51bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyBhY2Nlc3MgdG9r
ZW4gYXR0YWNoZWQgdG8gdGhpcyBjb25zdW1lcgogICAgLy8gZm9yIHRoZSB1c2VyIGFzc29j
aWF0ZWQgd2l0aCB0aGlzIHRva2VuIGlmIHRoZSByZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBh
dXRob3JpemVkCiAgICAvLyBzaG91bGQgYWxzbyBpbnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRv
a2VuCiAgfQoKfQoKY2xhc3MgT0F1dGhVdGlsIHsKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9u
IHVybGVuY29kZV9yZmMzOTg2KCRpbnB1dCkgewogIGlmIChpc19hcnJheSgkaW5wdXQpKSB7
CiAgICByZXR1cm4gYXJyYXlfbWFwKGFycmF5KCdPQXV0aFV0aWwnLCAndXJsZW5jb2RlX3Jm
YzM5ODYnKSwgJGlucHV0KTsKICB9IGVsc2UgaWYgKGlzX3NjYWxhcigkaW5wdXQpKSB7CiAg
ICByZXR1cm4gc3RyX3JlcGxhY2UoCiAgICAgICcrJywKICAgICAgJyAnLAogICAgICBzdHJf
cmVwbGFjZSgnJTdFJywgJ34nLCByYXd1cmxlbmNvZGUoJGlucHV0KSkKICAgICk7CiAgfSBl
bHNlIHsKICAgIHJldHVybiAnJzsKICB9Cn0KCgogIC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9u
IGlzbid0IHRha2luZyBpbnRvIGNvbnNpZGVyYXRpb24gdGhlIGFib3ZlCiAgLy8gbW9kaWZp
Y2F0aW9ucyB0byB0aGUgZW5jb2RpbmcgcHJvY2Vzcy4gSG93ZXZlciwgdGhpcyBtZXRob2Qg
ZG9lc24ndAogIC8vIHNlZW0gdG8gYmUgdXNlZCBhbnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFz
IGlzLgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gdXJsZGVjb2RlX3JmYzM5ODYoJHN0cmlu
ZykgewogICAgcmV0dXJuIHVybGRlY29kZSgkc3RyaW5nKTsKICB9CgogIC8vIFV0aWxpdHkg
ZnVuY3Rpb24gZm9yIHR1cm5pbmcgdGhlIEF1dGhvcml6YXRpb246IGhlYWRlciBpbnRvCiAg
Ly8gcGFyYW1ldGVycywgaGFzIHRvIGRvIHNvbWUgdW5lc2NhcGluZwogIC8vIENhbiBmaWx0
ZXIgb3V0IGFueSBub24tb2F1dGggcGFyYW1ldGVycyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVo
YXZpb3VyKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gc3BsaXRfaGVhZGVyKCRoZWFkZXIs
ICRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMgPSB0cnVlKSB7CiAgICAkcGF0dGVybiA9
ICcvKChbLV9hLXpdKik9KCIoW14iXSopInwoW14sXSopKSw/KS8nOwogICAgJG9mZnNldCA9
IDA7CiAgICAkcGFyYW1zID0gYXJyYXkoKTsKICAgIHdoaWxlIChwcmVnX21hdGNoKCRwYXR0
ZXJuLCAkaGVhZGVyLCAkbWF0Y2hlcywgUFJFR19PRkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkg
PiAwKSB7CiAgICAgICRtYXRjaCA9ICRtYXRjaGVzWzBdOwogICAgICAkaGVhZGVyX25hbWUg
PSAkbWF0Y2hlc1syXVswXTsKICAgICAgJGhlYWRlcl9jb250ZW50ID0gKGlzc2V0KCRtYXRj
aGVzWzVdKSkgPyAkbWF0Y2hlc1s1XVswXSA6ICRtYXRjaGVzWzRdWzBdOwogICAgICBpZiAo
cHJlZ19tYXRjaCgnL15vYXV0aF8vJywgJGhlYWRlcl9uYW1lKSB8fCAhJG9ubHlfYWxsb3df
b2F1dGhfcGFyYW1ldGVycykgewogICAgICAgICRwYXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9B
dXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJGhlYWRlcl9jb250ZW50KTsKICAgICAgfQog
ICAgICAkb2Zmc2V0ID0gJG1hdGNoWzFdICsgc3RybGVuKCRtYXRjaFswXSk7CiAgICB9Cgog
ICAgaWYgKGlzc2V0KCRwYXJhbXNbJ3JlYWxtJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNb
J3JlYWxtJ10pOwogICAgfQoKICAgIHJldHVybiAkcGFyYW1zOwogIH0KCiAgLy8gaGVscGVy
IHRvIHRyeSB0byBzb3J0IG91dCBoZWFkZXJzIGZvciBwZW9wbGUgd2hvIGFyZW4ndCBydW5u
aW5nIGFwYWNoZQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAg
ICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdhcGFjaGVfcmVxdWVzdF9oZWFkZXJzJykpIHsKICAg
ICAgLy8gd2UgbmVlZCB0aGlzIHRvIGdldCB0aGUgYWN0dWFsIEF1dGhvcml6YXRpb246IGhl
YWRlcgogICAgICAvLyBiZWNhdXNlIGFwYWNoZSB0ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNu
J3QgZXhpc3QKICAgICAgJGhlYWRlcnMgPSBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzKCk7Cgog
ICAgICAvLyBzYW5pdGl6ZSB0aGUgb3V0cHV0IG9mIGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMg
YmVjYXVzZQogICAgICAvLyB3ZSBhbHdheXMgd2FudCB0aGUga2V5cyB0byBiZSBDYXNlZC1M
aWtlLVRoaXMgYW5kIGFyaCgpCiAgICAgIC8vIHJldHVybnMgdGhlIGhlYWRlcnMgaW4gdGhl
IHNhbWUgY2FzZSBhcyB0aGV5IGFyZSBpbiB0aGUKICAgICAgLy8gcmVxdWVzdAogICAgICAk
b3V0ID0gYXJyYXkoKTsKICAgICAgZm9yZWFjaCggJGhlYWRlcnMgQVMgJGtleSA9PiAkdmFs
dWUgKSB7CiAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAg
ICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBs
YWNlKCItIiwgIiAiLCAka2V5KSkpCiAgICAgICAgICApOwogICAgICAgICRvdXRbJGtleV0g
PSAkdmFsdWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBk
b24ndCBoYXZlIGFwYWNoZSBhbmQgYXJlIGp1c3QgZ29pbmcgdG8gaGF2ZSB0byBob3BlCiAg
ICAgIC8vIHRoYXQgJF9TRVJWRVIgYWN0dWFsbHkgY29udGFpbnMgd2hhdCB3ZSBuZWVkCiAg
ICAgICRvdXQgPSBhcnJheSgpOwogICAgICBpZiggaXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRf
VFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09O
VEVOVF9UWVBFJ107CiAgICAgIGlmKCBpc3NldCgkX0VOVlsnQ09OVEVOVF9UWVBFJ10pICkK
ICAgICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9ICRfRU5WWydDT05URU5UX1RZUEUnXTsK
CiAgICAgIGZvcmVhY2ggKCRfU0VSVkVSIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAg
aWYgKHN1YnN0cigka2V5LCAwLCA1KSA9PSAiSFRUUF8iKSB7CiAgICAgICAgICAvLyB0aGlz
IGlzIGNoYW9zLCBiYXNpY2FsbHkgaXQgaXMganVzdCB0aGVyZSB0byBjYXBpdGFsaXplIHRo
ZSBmaXJzdAogICAgICAgICAgLy8gbGV0dGVyIG9mIGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3Qg
YW4gaW5pdGlhbCBIVFRQIGFuZCBzdHJpcCBIVFRQCiAgICAgICAgICAvLyBjb2RlIGZyb20g
cHJ6ZW1lawogICAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIs
CiAgICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9y
ZXBsYWNlKCJfIiwgIiAiLCBzdWJzdHIoJGtleSwgNSkpKSkKICAgICAgICAgICk7CiAgICAg
ICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAg
cmV0dXJuICRvdXQ7CiAgfQoKICAvLyBUaGlzIGZ1bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlr
ZSBhPWImYT1jJmQ9ZSBhbmQgcmV0dXJucyB0aGUgcGFyc2VkCiAgLy8gcGFyYW1ldGVycyBs
aWtlIHRoaXMKICAvLyBhcnJheSgnYScgPT4gYXJyYXkoJ2InLCdjJyksICdkJyA9PiAnZScp
CiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBwYXJzZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7
CiAgICBpZiAoIWlzc2V0KCRpbnB1dCkgfHwgISRpbnB1dCkgcmV0dXJuIGFycmF5KCk7Cgog
ICAgJHBhaXJzID0gZXhwbG9kZSgnJicsICRpbnB1dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0
ZXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYWlycyBhcyAkcGFpcikgewogICAgICAk
c3BsaXQgPSBleHBsb2RlKCc9JywgJHBhaXIsIDIpOwogICAgICAkcGFyYW1ldGVyID0gT0F1
dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMF0pOwogICAgICAkdmFsdWUgPSBp
c3NldCgkc3BsaXRbMV0pID8gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRb
MV0pIDogJyc7CgogICAgICBpZiAoaXNzZXQoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0
ZXJdKSkgewogICAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIo
cykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICAgIC8vIG9mIHBh
cmFtZXRlcnMgd2l0aCB0aGlzIG5hbWUKCiAgICAgICAgaWYgKGlzX3NjYWxhcigkcGFyc2Vk
X3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBm
aXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykgaW50byBhbiBh
cnJheQogICAgICAgICAgLy8gc28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAg
ICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJh
bWV0ZXJzWyRwYXJhbWV0ZXJdKTsKICAgICAgICB9CgogICAgICAgICRwYXJzZWRfcGFyYW1l
dGVyc1skcGFyYW1ldGVyXVtdID0gJHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgICRw
YXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9ICR2YWx1ZTsKICAgICAgfQogICAgfQog
ICAgcmV0dXJuICRwYXJzZWRfcGFyYW1ldGVyczsKICB9CgogIHB1YmxpYyBzdGF0aWMgZnVu
Y3Rpb24gYnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1zKSB7CiAgICBpZiAoISRwYXJhbXMpIHJl
dHVybiAnJzsKCiAgICAvLyBVcmxlbmNvZGUgYm90aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRr
ZXlzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV9rZXlzKCRwYXJhbXMp
KTsKICAgICR2YWx1ZXMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X3Zh
bHVlcygkcGFyYW1zKSk7CiAgICAkcGFyYW1zID0gYXJyYXlfY29tYmluZSgka2V5cywgJHZh
bHVlcyk7CgogICAgLy8gUGFyYW1ldGVycyBhcmUgc29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxl
eGljb2dyYXBoaWNhbCBieXRlIHZhbHVlIG9yZGVyaW5nLgogICAgLy8gUmVmOiBTcGVjOiA5
LjEuMSAoMSkKICAgIHVrc29ydCgkcGFyYW1zLCAnc3RyY21wJyk7CgogICAgJHBhaXJzID0g
YXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYXJhbXMgYXMgJHBhcmFtZXRlciA9PiAkdmFsdWUp
IHsKICAgICAgaWYgKGlzX2FycmF5KCR2YWx1ZSkpIHsKICAgICAgICAvLyBJZiB0d28gb3Ig
bW9yZSBwYXJhbWV0ZXJzIHNoYXJlIHRoZSBzYW1lIG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBi
eSB0aGVpciB2YWx1ZQogICAgICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICAgICAg
bmF0c29ydCgkdmFsdWUpOwogICAgICAgIGZvcmVhY2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRl
X3ZhbHVlKSB7CiAgICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVw
bGljYXRlX3ZhbHVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFpcnNb
XSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIC8vIEZv
ciBlYWNoIHBhcmFtZXRlciwgdGhlIG5hbWUgaXMgc2VwYXJhdGVkIGZyb20gdGhlIGNvcnJl
c3BvbmRpbmcgdmFsdWUgYnkgYW4gJz0nIGNoYXJhY3RlciAoQVNDSUkgY29kZSA2MSkKICAg
IC8vIEVhY2ggbmFtZS12YWx1ZSBwYWlyIGlzIHNlcGFyYXRlZCBieSBhbiAnJicgY2hhcmFj
dGVyIChBU0NJSSBjb2RlIDM4KQogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFpcnMpOwog
IH0KfSI7czozOiJtZDUiO3M6MzI6IjI5NjA2MjFhMWRkMGZhYWZkNzg3Y2U3YTk5YzE5MzFk
Ijt9
